<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Keraunos PCIe Tile - High-Level Design &mdash; Keraunos PCIe Tile 2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
        <script>
mermaid.initialize({
    startOnLoad: true,
    theme: 'default',
    themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#000',
        primaryBorderColor: '#1976d2',
        lineColor: '#1976d2',
        secondaryColor: '#fff4e1',
        tertiaryColor: '#e8f5e9'
    },
    flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis',
        padding: 15
    },
    sequence: {
        useMaxWidth: true,
        diagramMarginX: 50,
        diagramMarginY: 10,
        actorMargin: 50,
        boxMargin: 10,
        boxTextMargin: 5,
        noteMargin: 10,
        messageMargin: 35
    },
    gantt: {
        useMaxWidth: true,
        barHeight: 20,
        barGap: 4,
        topPadding: 50,
        leftPadding: 75,
        gridLineStartPadding: 35
    },
    class: {
        useMaxWidth: true
    },
    state: {
        useMaxWidth: true
    }
});
</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Keraunos PCIE Tile SystemC/TLM2.0 Design Document" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html" />
    <link rel="prev" title="Keraunos System Architecture" href="Keraunos_System_Architecture.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Keraunos PCIe Tile
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Keraunos_System_Architecture.html">Keraunos System Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-integration-in-keraunos-e100-chiplet-ecosystem">PCIe Tile Integration in Keraunos-E100 Chiplet Ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#executive-summary">Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#system-overview">1. System Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#grendel-chiplet-ecosystem">1.1 Grendel Chiplet Ecosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#keraunos-e100-role">1.2 Keraunos-E100 Role</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#keraunos-e100-chiplet-architecture">2. Keraunos-E100 Chiplet Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#high-level-block-diagram">2.1 High-Level Block Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#key-subsystems">2.2 Key Subsystems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#chiplet-harness">2.2.1 Chiplet Harness</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-subsystem">2.2.2 PCIe Subsystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#hsio-high-speed-i-o-tiles">2.2.3 HSIO (High-Speed I/O) Tiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#noc-infrastructure">2.2.4 NOC Infrastructure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-position-in-the-system">3. PCIe Tile Position in the System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-overview">3.1 PCIe Tile Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#architectural-position">3.2 Architectural Position</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#key-interfaces">3.3 Key Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#model-integration-hostrceppcie-tile-connection-diagram">3.4 Model Integration: Host–RC–EP–PCIe Tile Connection Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#vdk-integration-pcie-tile-and-synopsys-pcie-controller-in-the-virtualizer">3.5 VDK Integration: PCIe Tile and Synopsys PCIe Controller in the Virtualizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#vdk-workspace-layout-vsws-tt">3.5.1 VDK Workspace Layout (vsws_TT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#alignment-with-keraunos-where-the-pcie-tile-fits">3.5.2 Alignment with Keraunos: Where the PCIe Tile Fits</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#interface-level-connection-diagram-vdk">3.5.3 Interface-Level Connection Diagram (VDK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#signal-and-interface-level-mapping-ep-pcie-tile">3.5.4 Signal- and Interface-Level Mapping (EP ↔ PCIe Tile)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#connection-diagram-for-easy-integration">3.5.5 Connection Diagram for Easy Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#designware-pcie-ep-and-rc-interfaces-connect-to-tile-system-vs-stub">3.5.6 DesignWare PCIe EP and RC Interfaces: Connect to Tile / System vs Stub</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#connectivity-architecture">4. Connectivity Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#inbound-data-path-host-chip">4.1 Inbound Data Path (Host → Chip)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#outbound-data-path-chip-host">4.2 Outbound Data Path (Chip → Host)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#configuration-path-smn-pcie-tile-registers">4.3 Configuration Path (SMN → PCIe Tile Registers)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#msi-interrupt-path-chip-host">4.4 MSI Interrupt Path (Chip → Host)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#data-flow-paths">5. Data Flow Paths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#end-to-end-data-flow-example-host-dma-to-quasar">5.1 End-to-End Data Flow Example: Host DMA to Quasar</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#multi-hop-data-flow-quasar-pcie-host-pcie-quasar">5.2 Multi-Hop Data Flow: Quasar → PCIe → Host → PCIe → Quasar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#address-space-integration">6. Address Space Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#system-address-map">6.1 System Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-bar-base-address-register-mapping">6.2 PCIe BAR (Base Address Register) Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#address-translation-stages">6.3 Address Translation Stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#system-use-cases">7. System Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-1-model-initialization">7.1 Use Case 1: Model Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-2-inference-execution">7.2 Use Case 2: Inference Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-3-package-to-package-communication">7.3 Use Case 3: Package-to-Package Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-4-system-management">7.4 Use Case 4: System Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#appendices">8. Appendices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#acronyms-and-abbreviations">8.1 Acronyms and Abbreviations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#reference-documents">8.2 Reference Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#revision-history">8.3 Revision History</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Keraunos PCIe Tile - High-Level Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-terms">1.3 Key Terms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-overview">2. Architecture Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#top-level-architecture">2.1 Top-Level Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-principles">2.2 Design Principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-connection-diagrams">2.3 System Connection Diagrams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#smn-subsystem-connection">2.3.1 SMN Subsystem Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#noc-subsystem-connection">2.3.2 NOC Subsystem Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#designware-pcie-controller-connection">2.3.3 Designware PCIe Controller Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-control-connection">2.3.4 System Control Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tlm-socket-connections-64-bit-blocking-transport">TLM Socket Connections (64-bit, blocking transport)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clock-connections">Clock Connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reset-connections">Reset Connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cii-interface-connections-configuration-intercept">CII Interface Connections (Configuration Intercept)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interrupt-forwarding-pcie-controller-tile-system">Interrupt Forwarding (PCIe Controller → Tile → System)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cii-interrupt-output">CII Interrupt Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#status-outputs">Status Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#isolation-control">Isolation Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="#msi-input-special-case">MSI Input (Special Case)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integration-checklist">Integration Checklist</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#theory-of-operation">3. Theory of Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operational-modes">3.1 Operational Modes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#normal-operation-mode">Normal Operation Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#isolation-mode">Isolation Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypass-mode">Bypass Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reset-modes">Reset Modes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initialization-and-boot-sequence">3.2 Initialization and Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inbound-data-flow-pcie-to-noc">3.3 Inbound Data Flow (PCIe to NOC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outbound-data-flow-noc-to-pcie">3.4 Outbound Data Flow (NOC to PCIe)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-access-flow">3.5 Configuration Access Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-interrupt-generation-flow">3.6 MSI Interrupt Generation Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cii-tracking-and-configuration-update">3.7 CII Tracking and Configuration Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="#isolation-and-recovery">3.8 Isolation and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-handling">3.9 Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operating-mode-summary">3.10 Operating Mode Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#detailed-block-diagram">4. Detailed Block Diagram</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#complete-system-architecture">3.1 Complete System Architecture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-flow-paths">5. Data Flow Paths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inbound-data-flow-pcie-noc">4.1 Inbound Data Flow (PCIe → NOC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outbound-data-flow-noc-pcie">4.2 Outbound Data Flow (NOC → PCIe)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-access-flow-smn-config">4.3 Configuration Access Flow (SMN → Config)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-generation-flow">4.4 MSI Generation Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cii-interrupt-flow">4.5 CII Interrupt Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-descriptions">6. Module Descriptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#noc-pcie-switch">5.1 NOC-PCIE Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#translation-lookaside-buffers">5.2 Translation Lookaside Buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-relay-unit">5.3 MSI Relay Unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-information-interface-sii">5.4 System Information Interface (SII)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#address-map">7. Address Map</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inbound-address-routing">6.1 Inbound Address Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-address-map">6.2 Configuration Address Map</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clock-and-reset-strategy">8. Clock and Reset Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reset-hierarchy">7.1 Reset Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reset-effects">7.2 Reset Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#isolation-sequence">7.3 Isolation Sequence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interface-specifications">9. Interface Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#external-tlm-sockets">8.1 External TLM Sockets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-and-status-signals">8.2 Control and Status Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#known-limitations-and-findings">10. Known Limitations and Findings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#architecture-limitations">9.1 Architecture Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documented-findings">9.2 Documented Findings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#test-coverage-summary">11. Test Coverage Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#test-suite-overview">10.1 Test Suite Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coverage-metrics">10.2 Coverage Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">12. References</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#related-documentation">11.1 Related Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source-code-organization">11.2 Source Code Organization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html">Keraunos PCIE Tile SystemC/TLM2.0 Design Document</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#sphinx-setup-instructions">Sphinx Setup Instructions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#install-required-extensions">1. Install Required Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configure-conf-py">2. Configure <code class="docutils literal notranslate"><span class="pre">conf.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-html-documentation">3. Build HTML Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#alternative-use-make">4. Alternative: Use make</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#key-implementation-features">⭐ Key Implementation Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#references">1.3 References</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-version">1.4 Implementation Version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-architecture-overview-new">1.5 Refactored Architecture Overview ⭐ NEW</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#why-refactoring-was-necessary">1.5.1 Why Refactoring Was Necessary</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-architecture-pattern">1.5.2 Refactored Architecture Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#original-design-socket-based">Original Design (Socket-Based):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-design-function-based">Refactored Design (Function-Based):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#function-callback-communication-pattern">1.5.3 Function Callback Communication Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#callback-type-definition">Callback Type Definition:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#setting-up-callbacks-wire-components">Setting Up Callbacks (Wire Components):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#benefits-of-function-callbacks">Benefits of Function Callbacks:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smart-pointer-memory-management">1.5.4 Smart Pointer Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-memory-integration">1.5.5 SCML2 Memory Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#temporal-decoupling-support">1.5.6 Temporal Decoupling Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modern-c-best-practices-applied">1.5.7 Modern C++ Best Practices Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#file-organization">1.5.8 File Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-communication-pattern">1.5.9 Component Communication Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#null-safety-pattern">1.5.10 Null Safety Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-characteristics">1.5.11 Performance Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#code-example-complete-transaction-path">1.5.12 Code Example - Complete Transaction Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#system-overview">2. System Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#keraunos-pcie-tile-context">2.1 Keraunos PCIE Tile Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modeled-components">2.2 Modeled Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-objectives">2.3 Design Objectives</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture">3. Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overall-structure">3.1 Overall Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-hierarchy">3.2 Component Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#data-flow">3.3 Data Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-traffic-flow">Inbound Traffic Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-traffic-flow">Outbound Traffic Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-flow">MSI Flow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-design">4. Component Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-common-structures">4.1 TLB Common Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbentry-structure">4.1.1 TlbEntry Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-tlb-design">4.2 Inbound TLB Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overview-and-use-cases">4.2.1 Overview and Use Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbsysin0-system-management-inbound-tlb">4.2.2 TLBSysIn0 - System Management Inbound TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappin0-application-inbound-tlb-bar0-1">4.2.3 TLBAppIn0 - Application Inbound TLB (BAR0/1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappin1-application-inbound-tlb-bar4-5">4.2.4 TLBAppIn1 - Application Inbound TLB (BAR4/5)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-tlb-translation-flow">4.2.5 Inbound TLB Translation Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-examples">4.2.6 Address Translation Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axuser-field-format">4.2.7 AxUSER Field Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-and-initialization">4.2.8 Configuration and Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#error-handling">4.2.9 Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-with-system">4.2.10 Integration with System</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-tlb-design">4.3 Outbound TLB Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id1">4.3.1 Overview and Use Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbsysout0-system-management-outbound-tlb">4.3.2 TLBSysOut0 - System Management Outbound TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappout0-application-outbound-tlb-high-address">4.3.3 TLBAppOut0 - Application Outbound TLB (High Address)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappout1-application-outbound-tlb-dbi-access">4.3.4 TLBAppOut1 - Application Outbound TLB (DBI Access)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-tlb-translation-flow">4.3.5 Outbound TLB Translation Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id2">4.3.6 Address Translation Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id3">4.3.7 Configuration and Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id4">4.3.8 Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id5">4.3.9 Integration with System</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-relay-unit-design">4.4 MSI Relay Unit Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overview">4.4.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id6">4.4.2 Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-x-table-entry">4.4.3 MSI-X Table Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pending-bit-array-pba">4.4.4 Pending Bit Array (PBA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-thrower-logic">4.4.5 MSI Thrower Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#register-map">4.4.6 Register Map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#intra-tile-fabric-switch-design">4.5 Intra-Tile Fabric Switch Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-pcie-switch">4.5.1 NOC-PCIE Switch</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-io-switch">4.5.2 NOC-IO Switch</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smn-io-switch">4.5.3 SMN-IO Switch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#system-information-interface-sii-block">4.6 System Information Interface (SII) Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id7">4.6.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture-and-operation">4.6.2 Architecture and Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#cii-tracking-implementation">4.6.3 CII Tracking Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id8">4.6.4 Register Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-domain-crossing">4.6.5 Clock Domain Crossing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interrupt-generation-and-routing">4.6.6 Interrupt Generation and Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface-specification">4.6.7 Interface Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-details">4.6.8 Implementation Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-register-block">4.7 Configuration Register Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id9">4.7.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#status-registers">4.7.2 Status Registers</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#isolation-behavior">4.7.3 Isolation Behavior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-reset-control-module">4.8 Clock &amp; Reset Control Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id10">4.8.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-domains">4.8.2 Clock Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#reset-sequence">4.8.3 Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface">4.8.4 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pll-cgm-clock-generation-module">4.9 PLL/CGM (Clock Generation Module)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id11">4.9.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pll-lock">4.9.2 PLL Lock</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id12">4.9.3 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pcie-phy-model">4.10 PCIE PHY Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id13">4.10.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#features">4.10.2 Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id14">4.10.3 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#external-interface-modules">4.11 External Interface Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-n-interface">4.11.1 NOC-N Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smn-n-interface">4.11.2 SMN-N Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#top-level-keraunos-pcie-tile-module">4.12 Top-Level Keraunos PCIE Tile Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id15">4.12.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#external-interfaces">4.12.2 External Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#internal-connections">4.12.3 Internal Connections</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface-specifications">5. Interface Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlm2-0-interfaces">5.1 TLM2.0 Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-target-socket-inbound-tlbs">5.1.1 AXI4 Target Socket (Inbound TLBs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-initiator-socket-all-tlbs">5.1.2 AXI4 Initiator Socket (All TLBs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#apb-target-socket-configuration">5.1.3 APB Target Socket (Configuration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-lite-initiator-socket-msi-relay">5.1.4 AXI4-Lite Initiator Socket (MSI Relay)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#systemc-signals">5.2 SystemC Signals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#control-signals">5.2.1 Control Signals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-interfaces">5.3 Address Translation Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-lookup-methods">5.3.1 TLB Lookup Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-methods">5.3.2 Configuration Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id16">6. Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-algorithms">6.1 Address Translation Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-translation-tlbsysin0">6.1.1 Inbound Translation (TLBSysIn0)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-translation-tlbappout0">6.1.2 Outbound Translation (TLBAppOut0)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id17">6.2 Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#invalid-tlb-entry">6.2.1 Invalid TLB Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#out-of-range-index">6.2.2 Out-of-Range Index</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-relay-unit-state-machine">6.3 MSI Relay Unit State Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#threading-model">6.4 Threading Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-modeling">6.5 Memory Modeling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modeling-approach">7. Modeling Approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#abstraction-level">7.1 Abstraction Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-usage">7.2 SCML2 Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#socket-type-selection-rationale">7.2.1 Socket Type Selection Rationale</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlm2-0-compliance">7.3 TLM2.0 Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-patterns">7.4 Design Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-considerations">8. Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#simulation-performance">8.1 Simulation Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#optimization-opportunities">8.2 Optimization Opportunities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scalability">8.3 Scalability</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#dependencies-and-requirements">9. Dependencies and Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#software-dependencies">9.1 Software Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#hardware-dependencies">9.2 Hardware Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-requirements">9.3 Integration Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#detailed-implementation-architecture">9. Detailed Implementation Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#class-hierarchy-and-relationships">9.1 Class Hierarchy and Relationships</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#top-level-module-only-sc-module">Top-Level Module (Only sc_module):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#internal-component-pattern">Internal Component Pattern:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#communication-architecture">9.2 Communication Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#transaction-flow-pattern">Transaction Flow Pattern:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-management-architecture">9.3 Memory Management Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smart-pointer-ownership-tree">Smart Pointer Ownership Tree:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#callback-wiring-implementation">9.4 Callback Wiring Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#complete-wiring-example">Complete Wiring Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-memory-usage-pattern">9.5 SCML2 Memory Usage Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-storage-implementation">Configuration Storage Implementation:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-lifecycle">9.6 Component Lifecycle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#initialization-sequence">Initialization Sequence:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#transaction-processing-flow">9.7 Transaction Processing Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-pcie-transaction-example">Inbound PCIe Transaction Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#routing-decision-implementation">9.8 Routing Decision Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-pcie-switch-routing-logic">NOC-PCIE Switch Routing Logic:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-path-and-bme-bus-master-enable">Outbound Path and BME (Bus Master Enable):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-translation-implementation">9.9 TLB Translation Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#translation-algorithm-page-mask-correction">Translation Algorithm (page-mask correction):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#error-handling-strategy">9.10 Error Handling Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#layered-error-response">Layered Error Response:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-register-implementation">9.11 Configuration Register Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#register-access-pattern">Register Access Pattern:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-guide">10. Implementation Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#building-the-design">10.1 Building the Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#prerequisites">Prerequisites:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-commands">Build Commands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-output">Build Output:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#running-tests">10.2 Running Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#unit-tests-auto-generated">Unit Tests (Auto-Generated):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-coverage">Test Coverage:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-new-components">10.3 Adding New Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pattern-for-c-class-components">Pattern for C++ Class Components:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#debugging-and-troubleshooting">10.4 Debugging and Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#common-issues-and-solutions">Common Issues and Solutions:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#debug-tools">Debug Tools:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-tuning">10.5 Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#temporal-decoupling-configuration">Temporal Decoupling Configuration:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-timing-annotations">Adding Timing Annotations:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-development-guide">10.6 Test Development Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-new-test-cases">Adding New Test Cases:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-management">10.7 Configuration Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-configuration-example">TLB Configuration Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-with-vdk-platform">10.8 Integration with VDK Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#module-instantiation-in-platform">Module Instantiation in Platform:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-management-best-practices">10.9 Memory Management Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#raii-pattern-already-applied">RAII Pattern (Already Applied):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#coding-standards-applied">10.10 Coding Standards Applied</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modern-c-17-features-used">Modern C++17 Features Used:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-infrastructure">11. Test Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-framework-overview">11.1 Test Framework Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-categories-33-tests">11.2 Test Categories (33 Tests)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-execution-results">11.3 Test Execution Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-api-examples">11.4 Test API Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#coverage-goals">11.5 Coverage Goals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#migration-from-original-design">12. Migration from Original Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#for-developers-familiar-with-original">12.1 For Developers Familiar with Original</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#api-migration-guide">12.2 API Migration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#backward-compatibility-notes">12.3 Backward Compatibility Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#known-limitations-and-future-work">13. Known Limitations and Future Work</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#current-limitations">13.1 Current Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#future-enhancements">13.2 Future Enhancements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#lessons-learned-and-best-practices">14. Lessons Learned and Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture-decisions">14.1 Architecture Decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-patterns-applied">14.2 Design Patterns Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#recommendations-for-similar-projects">14.3 Recommendations for Similar Projects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-a-implemented-components-summary">Appendix A: Implemented Components Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-1-complete-component-list">A.1 Complete Component List</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-2-component-statistics">A.2 Component Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-3-scml-compliance">A.3 SCML Compliance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-b-address-map-summary">Appendix B: Address Map Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-1-tlb-configuration-space">B.1 TLB Configuration Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-2-msi-relay-unit-address-map">B.2 MSI Relay Unit Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-3-sii-block-address-map">B.3 SII Block Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-4-config-register-block-address-map">B.4 Config Register Block Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-5-smn-io-switch-address-map">B.5 SMN-IO Switch Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-6-noc-io-switch-address-map">B.6 NOC-IO Switch Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-7-noc-pcie-switch-routing-map">B.7 NOC-PCIE Switch Routing Map</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-c-acronyms-and-abbreviations">Appendix C: Acronyms and Abbreviations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html">Keraunos PCIE Tile SystemC/TLM2.0 Testplan</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-objectives">1.3 Test Objectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlb-translation-and-sys-in-out-reference">1.4 TLB Translation and Sys In/Out (Reference)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#references">1.5 References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-traceability-matrix">1.5 Test Traceability Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-environment">2. Test Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#testbench-structure">2.1 Testbench Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-components">2.2 Test Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-tools">2.3 Test Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-strategy">3. Test Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-levels">3.1 Test Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-methodology">3.2 Test Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-phases">3.3 Test Phases</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#inbound-tlb-test-cases">4. Inbound TLB Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbsysin0-test-cases">4.1 TLBSysIn0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-001-basic-address-translation">TC_INBOUND_SYS_001: Basic Address Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-002-invalid-entry-detection">TC_INBOUND_SYS_002: Invalid Entry Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-003-index-calculation">TC_INBOUND_SYS_003: Index Calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-004-page-boundary-crossing">TC_INBOUND_SYS_004: Page Boundary Crossing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-005-axuser-field-mapping">TC_INBOUND_SYS_005: AxUSER Field Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-006-system-ready-bypass">TC_INBOUND_SYS_006: System Ready Bypass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappin0-test-cases">4.2 TLBAppIn0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-001-bar0-1-translation">TC_INBOUND_APP0_001: BAR0/1 Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-002-multiple-instance-support">TC_INBOUND_APP0_002: Multiple Instance Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-003-16mb-page-size">TC_INBOUND_APP0_003: 16MB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-004-non-cacheable-and-qosid">TC_INBOUND_APP0_004: Non-Cacheable and QoSID</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappin1-test-cases">4.3 TLBAppIn1 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-001-bar4-5-translation">TC_INBOUND_APP1_001: BAR4/5 Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-002-8gb-page-size">TC_INBOUND_APP1_002: 8GB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-003-dram-mapping">TC_INBOUND_APP1_003: DRAM Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#outbound-tlb-test-cases">5. Outbound TLB Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbsysout0-test-cases">5.1 TLBSysOut0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-001-dbi-access-translation">TC_OUTBOUND_SYS_001: DBI Access Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-002-64kb-page-size">TC_OUTBOUND_SYS_002: 64KB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-003-all-16-entries">TC_OUTBOUND_SYS_003: All 16 Entries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappout0-test-cases">5.2 TLBAppOut0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-001-high-address-translation-256tb">TC_OUTBOUND_APP0_001: High Address Translation (&gt;=256TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-002-address-range-check">TC_OUTBOUND_APP0_002: Address Range Check</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-003-16tb-page-size">TC_OUTBOUND_APP0_003: 16TB Page Size</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappout1-test-cases">5.3 TLBAppOut1 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app1-001-low-address-translation-256tb">TC_OUTBOUND_APP1_001: Low Address Translation (&lt;256TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app1-002-dbi-access-from-application">TC_OUTBOUND_APP1_002: DBI Access from Application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-relay-unit-test-cases">6. MSI Relay Unit Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#register-access-tests">6.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-001-msi-receiver-write">TC_MSI_RELAY_001: MSI Receiver Write</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-002-msi-x-table-configuration">TC_MSI_RELAY_002: MSI-X Table Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-003-outstanding-count">TC_MSI_RELAY_003: Outstanding Count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-generation-tests">6.2 MSI Generation Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-004-basic-msi-generation">TC_MSI_RELAY_004: Basic MSI Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-005-msi-x-enable-control">TC_MSI_RELAY_005: MSI-X Enable Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-006-global-mask-control">TC_MSI_RELAY_006: Global Mask Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-007-vector-mask-control">TC_MSI_RELAY_007: Vector Mask Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-008-invalid-entry-handling">TC_MSI_RELAY_008: Invalid Entry Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-009-multiple-pending-interrupts">TC_MSI_RELAY_009: Multiple Pending Interrupts</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-010-setip-signal">TC_MSI_RELAY_010: SetIP Signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-011-all-16-vectors">TC_MSI_RELAY_011: All 16 Vectors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#integration-test-cases">7. Integration Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlb-msi-relay-integration">7.1 TLB + MSI Relay Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-001-msi-x-table-access-via-tlb">TC_INTEGRATION_001: MSI-X Table Access via TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-002-msi-generation-through-fabric">TC_INTEGRATION_002: MSI Generation Through Fabric</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#multiple-tlb-integration">7.2 Multiple TLB Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-003-concurrent-tlb-operations">TC_INTEGRATION_003: Concurrent TLB Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-004-outbound-inbound-round-trip">TC_INTEGRATION_004: Outbound + Inbound Round Trip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#switch-test-cases">8. Switch Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-pcie-switch-test-cases">8.1 NOC-PCIE Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-001-address-routing-based-on-axaddr-63-60">TC_SWITCH_NOC_PCIE_001: Address Routing Based on AxADDR[63:60]</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-002-status-register-special-routing">TC_SWITCH_NOC_PCIE_002: Status Register Special Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-003-isolation-support">TC_SWITCH_NOC_PCIE_003: Isolation Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-004-inbound-enable-control">TC_SWITCH_NOC_PCIE_004: Inbound Enable Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-005-bypass-path-routing">TC_SWITCH_NOC_PCIE_005: Bypass Path Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-006-address-conversion-64-bit-to-52-bit">TC_SWITCH_NOC_PCIE_006: Address Conversion (64-bit to 52-bit)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-io-switch-test-cases">8.2 NOC-IO Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-001-local-resource-routing">TC_SWITCH_NOC_IO_001: Local Resource Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-002-external-noc-routing">TC_SWITCH_NOC_IO_002: External NOC Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-003-high-address-routing-axaddr-51-48">TC_SWITCH_NOC_IO_003: High Address Routing (AxADDR[51:48])</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-004-timeout-detection">TC_SWITCH_NOC_IO_004: Timeout Detection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#bus-master-enable-bme-test-cases">8.3 Bus Master Enable (BME) Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-bme-001-ep-mode-bme-0-memory-tlp-blocked">TC_BME_001: EP Mode, BME=0 — Memory TLP Blocked</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-bme-002-ep-mode-bme-0-dbi-tlp-allowed">TC_BME_002: EP Mode, BME=0 — DBI TLP Allowed</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-bme-003-ep-mode-bme-0-config-tlp-allowed">TC_BME_003: EP Mode, BME=0 — Config TLP Allowed</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-bme-004-ep-mode-bme-1-all-traffic-allowed">TC_BME_004: EP Mode, BME=1 — All Traffic Allowed</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-bme-005-rp-mode-all-traffic-allowed-regardless-of-bme">TC_BME_005: RP Mode — All Traffic Allowed Regardless of BME</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#smn-io-switch-test-cases">8.4 SMN-IO Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-001-address-based-routing">TC_SWITCH_SMN_IO_001: Address-Based Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-002-serdes-routing">TC_SWITCH_SMN_IO_002: SerDes Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-003-external-smn-routing">TC_SWITCH_SMN_IO_003: External SMN Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-004-timeout-detection">TC_SWITCH_SMN_IO_004: Timeout Detection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#sii-block-test-cases">9. SII Block Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id1">9.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-001-configuration-register-access">TC_SII_001: Configuration Register Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-002-cii-tracking">TC_SII_002: CII Tracking</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-003-bus-device-number-assignment">TC_SII_003: Bus/Device Number Assignment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#config-register-block-test-cases">10. Config Register Block Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id2">10.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-001-tlb-configuration-space-access">TC_CONFIG_REG_001: TLB Configuration Space Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-002-system-ready-register">TC_CONFIG_REG_002: System Ready Register</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-003-pcie-enable-registers">TC_CONFIG_REG_003: PCIE Enable Registers</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-004-isolation-behavior">TC_CONFIG_REG_004: Isolation Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-reset-test-cases">11. Clock &amp; Reset Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-generation-tests">11.1 Clock Generation Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-001-reference-clock-generation">TC_CLOCK_RESET_001: Reference Clock Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-002-pcie-clock-generation">TC_CLOCK_RESET_002: PCIE Clock Generation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reset-sequence-tests">11.2 Reset Sequence Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-003-cold-reset-sequence">TC_CLOCK_RESET_003: Cold Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-004-warm-reset-sequence">TC_CLOCK_RESET_004: Warm Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-005-isolation-behavior">TC_CLOCK_RESET_005: Isolation Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pll-cgm-test-cases">12. PLL/CGM Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pll-lock-tests">12.1 PLL Lock Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-pll-cgm-001-pll-lock-sequence">TC_PLL_CGM_001: PLL Lock Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-pll-cgm-002-pll-configuration">TC_PLL_CGM_002: PLL Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pcie-phy-test-cases">13. PCIE PHY Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phy-configuration-tests">13.1 PHY Configuration Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-001-apb-configuration-access">TC_PHY_001: APB Configuration Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-002-ahb-firmware-download">TC_PHY_002: AHB Firmware Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-003-lane-reversal-support">TC_PHY_003: Lane Reversal Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#external-interface-test-cases">14. External Interface Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-n-interface-tests">14.1 NOC-N Interface Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-external-noc-001-transaction-forwarding">TC_EXTERNAL_NOC_001: Transaction Forwarding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#smn-n-interface-tests">14.2 SMN-N Interface Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-external-smn-001-transaction-forwarding">TC_EXTERNAL_SMN_001: Transaction Forwarding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#top-level-integration-test-cases">15. Top-Level Integration Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#full-tile-integration">15.1 Full Tile Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-001-complete-reset-sequence">TC_TOP_LEVEL_001: Complete Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-002-end-to-end-transaction-flow">TC_TOP_LEVEL_002: End-to-End Transaction Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-003-msi-end-to-end-flow">TC_TOP_LEVEL_003: MSI End-to-End Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-004-isolation-sequence">TC_TOP_LEVEL_004: Isolation Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-005-multiple-clock-domain-operation">TC_TOP_LEVEL_005: Multiple Clock Domain Operation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#end-to-end-test-cases">16. End-to-End Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#inbound-data-paths-pcie-noc-smn">16.1 Inbound Data Paths (PCIe → NOC/SMN)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-001-pcie-read-tlb-app0-noc-n">TC_E2E_INBOUND_001: PCIe Read → TLB App0 → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-002-pcie-write-tlb-app1-noc-n">TC_E2E_INBOUND_002: PCIe Write → TLB App1 → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-003-pcie-tlb-sys-smn-n">TC_E2E_INBOUND_003: PCIe → TLB Sys → SMN-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-004-pcie-bypass-app-path">TC_E2E_INBOUND_004: PCIe Bypass App Path</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-005-pcie-bypass-sys-path">TC_E2E_INBOUND_005: PCIe Bypass Sys Path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#outbound-data-paths-noc-smn-pcie">16.2 Outbound Data Paths (NOC/SMN → PCIe)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-001-noc-n-tlb-app-out0-pcie">TC_E2E_OUTBOUND_001: NOC-N → TLB App Out0 → PCIe</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-002-smn-n-tlb-sys-out0-pcie">TC_E2E_OUTBOUND_002: SMN-N → TLB Sys Out0 → PCIe</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-003-noc-n-tlb-app-out1-pcie-dbi">TC_E2E_OUTBOUND_003: NOC-N → TLB App Out1 → PCIe DBI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#configuration-paths-smn-tlb-sii-msi-config">16.3 Configuration Paths (SMN → TLB/SII/MSI Config)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-001-smn-n-tlb-config">TC_E2E_CONFIG_001: SMN-N → TLB Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-002-smn-n-sii-config">TC_E2E_CONFIG_002: SMN-N → SII Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-003-smn-n-msi-relay-config">TC_E2E_CONFIG_003: SMN-N → MSI Relay Config</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-interrupt-flows">16.4 MSI Interrupt Flows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msi-001-msi-generation-noc-n">TC_E2E_MSI_001: MSI Generation → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msi-002-downstream-msi-input-processing">TC_E2E_MSI_002: Downstream MSI Input → Processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#status-register-access">16.5 Status Register Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-status-001-status-register-read-route-0xe">TC_E2E_STATUS_001: Status Register Read (Route 0xE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-status-002-status-register-disabled-access">TC_E2E_STATUS_002: Status Register Disabled Access</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#isolation-and-error-handling">16.6 Isolation and Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-isolation-001-global-isolation">TC_E2E_ISOLATION_001: Global Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-isolation-002-config-access-during-isolation">TC_E2E_ISOLATION_002: Config Access During Isolation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#multi-path-concurrent-traffic">16.7 Multi-Path Concurrent Traffic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-concurrent-001-simultaneous-inbound-outbound">TC_E2E_CONCURRENT_001: Simultaneous Inbound + Outbound</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-concurrent-002-multiple-tlb-simultaneous-access">TC_E2E_CONCURRENT_002: Multiple TLB Simultaneous Access</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reset-and-initialization-sequences">16.8 Reset and Initialization Sequences</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-reset-001-cold-reset-sequence">TC_E2E_RESET_001: Cold Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-reset-002-warm-reset-sequence">TC_E2E_RESET_002: Warm Reset Sequence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#complete-transaction-flows">16.9 Complete Transaction Flows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-001-pcie-memory-read-noc-memory-response">TC_E2E_FLOW_001: PCIe Memory Read → NOC → Memory → Response</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-002-pcie-memory-write-noc-memory-completion">TC_E2E_FLOW_002: PCIe Memory Write → NOC → Memory → Completion</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-003-noc-memory-read-pcie-controller">TC_E2E_FLOW_003: NOC Memory Read → PCIe Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-004-smn-config-write-pcie-dbi">TC_E2E_FLOW_004: SMN Config Write → PCIe DBI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#error-injection-and-recovery">16.10 Error Injection and Recovery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-001-invalid-tlb-entry">TC_E2E_ERROR_001: Invalid TLB Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-002-timeout-handling">TC_E2E_ERROR_002: Timeout Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-003-address-decode-error">TC_E2E_ERROR_003: Address Decode Error</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-x-end-to-end-flow">16.11 MSI-X End-to-End Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msix-001-complete-msi-x-interrupt-flow">TC_E2E_MSIX_001: Complete MSI-X Interrupt Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msix-002-multiple-vector-interrupts">TC_E2E_MSIX_002: Multiple Vector Interrupts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-domain-crossing">16.12 Clock Domain Crossing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-cdc-001-axi-clock-pcie-clock">TC_E2E_CDC_001: AXI Clock → PCIe Clock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#performance-and-stress-tests">16.13 Performance and Stress Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-perf-001-maximum-throughput-test">TC_E2E_PERF_001: Maximum Throughput Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-stress-001-address-space-sweep">TC_E2E_STRESS_001: Address Space Sweep</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-stress-002-tlb-entry-exhaustion">TC_E2E_STRESS_002: TLB Entry Exhaustion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#power-management">16.14 Power Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-power-001-isolation-mode-entry-exit">TC_E2E_POWER_001: Isolation Mode Entry/Exit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#system-integration-scenarios">16.15 System Integration Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-001-boot-sequence">TC_E2E_SYSTEM_001: Boot Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-002-shutdown-sequence">TC_E2E_SYSTEM_002: Shutdown Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-003-error-recovery-scenario">TC_E2E_SYSTEM_003: Error Recovery Scenario</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#refactored-architecture-validation">16.16 Refactored Architecture Validation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-refactor-001-function-callback-chain">TC_E2E_REFACTOR_001: Function Callback Chain</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-refactor-002-no-internal-sockets-remain">TC_E2E_REFACTOR_002: No Internal Sockets Remain</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#coverage-goals">17. Coverage Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id3">16. Coverage Goals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#functional-coverage">16.1 Functional Coverage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlb-coverage">TLB Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-relay-coverage">MSI Relay Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#switch-coverage">Switch Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#sii-coverage">SII Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#config-register-coverage">Config Register Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-reset-coverage">Clock/Reset Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phy-coverage">PHY Coverage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#code-coverage">16.2 Code Coverage</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#specification-coverage">16.3 Specification Coverage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-infrastructure">17. Test Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#testbench-components">9.1 Testbench Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#stimulus-generator">Stimulus Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#monitor">Monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reference-model">Reference Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-utilities">9.2 Test Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-configuration">9.3 Test Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-testing">18. Regression Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-suite">10.1 Regression Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-criteria">10.2 Regression Criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#continuous-integration">10.3 Continuous Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-a-unit-integration-test-case-summary-sections-4-15">Appendix A: Unit/Integration Test Case Summary (Sections 4-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-a-2-end-to-end-test-case-summary-section-16-implemented-in-keranous-pcie-tiletest-cc">Appendix A.2: End-to-End Test Case Summary (Section 16) — Implemented in <code class="docutils literal notranslate"><span class="pre">Keranous_pcie_tileTest.cc</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-b-test-execution-plan">Appendix B: Test Execution Plan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-1-unit-tests-weeks-1-3">Phase 1: Unit Tests (Weeks 1-3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-2-functional-tests-weeks-4-5">Phase 2: Functional Tests (Weeks 4-5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-3-integration-tests-weeks-6-7">Phase 3: Integration Tests (Weeks 6-7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-4-system-tests-week-8">Phase 4: System Tests (Week 8)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-5-regression-week-9">Phase 5: Regression (Week 9)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ENABLE_GATING_DESIGN.html">Enable Gating Feature - Design Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#register-interface">Register Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#implementation">Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#signal-propagation">Signal Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#test-coverage">Test Coverage</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Keraunos PCIe Tile</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Keraunos PCIe Tile - High-Level Design</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Keraunos_PCIe_Tile_HLD.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="keraunos-pcie-tile-high-level-design">
<h1>Keraunos PCIe Tile - High-Level Design<a class="headerlink" href="#keraunos-pcie-tile-high-level-design" title="Permalink to this heading"></a></h1>
<p><strong>Version:</strong> 2.0<br />
<strong>Date:</strong> February 10, 2026<br />
<strong>Status:</strong> Updated - DUT initiator socket architecture</p>
<hr class="docutils" />
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<section id="purpose">
<h3>1.1 Purpose<a class="headerlink" href="#purpose" title="Permalink to this heading"></a></h3>
<p>This document describes the high-level architecture of the Keraunos PCIe Tile, a SystemC/TLM2.0 model that provides PCIe connectivity between Network-on-Chip (NOC), System Management Network (SMN), and PCIe controller interfaces.</p>
</section>
<section id="scope">
<h3>1.2 Scope<a class="headerlink" href="#scope" title="Permalink to this heading"></a></h3>
<p>The Keraunos PCIe Tile integrates:</p>
<ul class="simple">
<li><p><strong>3 fabric switches</strong> for routing traffic between NOC, SMN, and PCIe domains</p></li>
<li><p><strong>8 Translation Lookaside Buffers (TLBs)</strong> for address translation (5 inbound, 3 outbound)</p></li>
<li><p><strong>MSI-X relay unit</strong> for interrupt handling</p></li>
<li><p><strong>System Information Interface (SII)</strong> for PCIe configuration tracking</p></li>
<li><p><strong>Configuration register block</strong> for tile-level control</p></li>
<li><p><strong>Clock and reset control</strong> infrastructure</p></li>
</ul>
</section>
<section id="key-terms">
<h3>1.3 Key Terms<a class="headerlink" href="#key-terms" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>CII</strong></p></td>
<td><p>Configuration Intercept Interface - PCIe config space write detection</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DECERR</strong></p></td>
<td><p>Decode Error - TLM address error response</p></td>
</tr>
<tr class="row-even"><td><p><strong>MSI-X</strong></p></td>
<td><p>Message Signaled Interrupts - Extended</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NOC</strong></p></td>
<td><p>Network-on-Chip</p></td>
</tr>
<tr class="row-even"><td><p><strong>PBA</strong></p></td>
<td><p>Pending Bit Array (for MSI-X)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>SII</strong></p></td>
<td><p>System Information Interface</p></td>
</tr>
<tr class="row-even"><td><p><strong>SMN</strong></p></td>
<td><p>System Management Network</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TLB</strong></p></td>
<td><p>Translation Lookaside Buffer</p></td>
</tr>
<tr class="row-even"><td><p><strong>TLM</strong></p></td>
<td><p>Transaction Level Modeling</p></td>
</tr>
<tr class="row-odd"><td><p><strong>BME</strong></p></td>
<td><p>Bus Master Enable (PCIe Command Register bit 2); gates memory TLPs in EP mode when clear</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="architecture-overview">
<h2>2. Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permalink to this heading"></a></h2>
<section id="top-level-architecture">
<h3>2.1 Top-Level Architecture<a class="headerlink" href="#top-level-architecture" title="Permalink to this heading"></a></h3>
<p>The Keraunos PCIe Tile acts as a bridge between three major interconnect domains:</p>
<div class="mermaid">
            graph TB
    subgraph &quot;External Interfaces&quot;
        NOC[NOC Network&lt;br/&gt;Target/Initiator]
        SMN[SMN Network&lt;br/&gt;Target/Initiator]
        PCIE[PCIe Controller&lt;br/&gt;Target/Initiator]
    end
    
    subgraph &quot;Keraunos PCIe Tile&quot;
        subgraph &quot;Data Path&quot;
            NOCP[NOC-PCIE&lt;br/&gt;Switch]
            NOCI[NOC-IO&lt;br/&gt;Switch]
            SMNI[SMN-IO&lt;br/&gt;Switch]
            TLBI[Inbound TLBs&lt;br/&gt;5 instances]
            TLBO[Outbound TLBs&lt;br/&gt;3 instances]
            MSI[MSI Relay&lt;br/&gt;Unit]
        end
        
        subgraph &quot;Control Path&quot;
            CFG[Config&lt;br/&gt;Registers]
            SII[SII Block&lt;br/&gt;CII Tracking]
            CLK[Clock/Reset&lt;br/&gt;Control]
        end
    end
    
    NOC --&gt;|Data Traffic| NOCI
    NOCI --&gt; TLBO --&gt; NOCP --&gt; PCIE
    PCIE --&gt; NOCP --&gt; TLBI --&gt; NOCI --&gt; NOC
    
    SMN --&gt;|Config Access| SMNI
    SMNI --&gt; CFG
    SMNI --&gt; SII
    SMNI --&gt; TLBI
    SMNI --&gt; TLBO
    SMNI --&gt; MSI
    
    PCIE --&gt;|CII Signals| SII
    NOC --&gt;|MSI Input| MSI
    
    CLK -.-&gt;|Reset/Clock| NOCP
    CLK -.-&gt;|Reset/Clock| NOCI
    CLK -.-&gt;|Reset/Clock| SMNI
    
    style NOCP fill:#e1f5ff
    style NOCI fill:#e1f5ff
    style SMNI fill:#e1f5ff
    style TLBI fill:#fff4e1
    style TLBO fill:#fff4e1
    style MSI fill:#ffe1f5
    style SII fill:#ffe1f5
    style CFG fill:#e1ffe1
    style CLK fill:#e1ffe1
        </div></section>
<section id="design-principles">
<h3>2.2 Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>C++ Implementation:</strong> All internal components are C++ classes (not SystemC modules) for performance and simplicity.</p></li>
<li><p><strong>Function Callbacks:</strong> Internal communication uses C++ function callbacks instead of TLM sockets.</p></li>
<li><p><strong>RAII Memory Management:</strong> Smart pointers (<code class="docutils literal notranslate"><span class="pre">std::unique_ptr</span></code>) for automatic resource cleanup.</p></li>
<li><p><strong>Address-Based Routing:</strong> Upper address bits [63:60] determine routing paths.</p></li>
<li><p><strong>Signal-Based Control:</strong> Control plane uses <code class="docutils literal notranslate"><span class="pre">sc_signal</span></code> for isolation, reset, and configuration tracking.</p></li>
</ol>
</section>
<section id="system-connection-diagrams">
<h3>2.3 System Connection Diagrams<a class="headerlink" href="#system-connection-diagrams" title="Permalink to this heading"></a></h3>
<p>This section shows how the Keraunos PCIe Tile connects to external subsystems in a complete SoC integration. Each subsystem connection is shown in a separate diagram for clarity.</p>
<section id="smn-subsystem-connection">
<h4>2.3.1 SMN Subsystem Connection<a class="headerlink" href="#smn-subsystem-connection" title="Permalink to this heading"></a></h4>
<div class="mermaid">
            graph LR
    subgraph SMN[&quot;SMN Subsystem&quot;]
        direction TB
        SMN_FAB[SMN Network Fabric&lt;br/&gt;Configuration Master&lt;br/&gt;64-bit TLM]
        SMN_INT[SMN Interrupt Controller]
    end
    
    subgraph TILE[&quot;Keraunos PCIe Tile&quot;]
        direction TB
        
        subgraph TLM[&quot;TLM Sockets&quot;]
            SMN_T[smn_n_target&lt;br/&gt;64-bit Target]
            SMN_I[smn_n_initiator&lt;br/&gt;64-bit Initiator]
        end
        
        subgraph OUT[&quot;Output Signals&quot;]
            CFG_UP[config_update]
            BUS[pcie_app_bus_num&lt;br/&gt;8-bit]
            DEV[pcie_app_dev_num&lt;br/&gt;8-bit]
            TYPE[pcie_device_type&lt;br/&gt;1-bit: 0=EP, 1=RP]
        end
    end
    
    SMN_FAB &lt;--&gt;|TLM blocking transport&lt;br/&gt;Configuration writes&lt;br/&gt;Read status/TLBs/MSI| SMN_T
    SMN_I &lt;--&gt;|TLM blocking transport&lt;br/&gt;Bypass path responses| SMN_FAB
    CFG_UP --&gt;|Config space update&lt;br/&gt;interrupt from CII| SMN_INT
    BUS -.-&gt;|Read from SII| SMN_FAB
    DEV -.-&gt;|Read from SII| SMN_FAB
    TYPE -.-&gt;|Read from SII| SMN_FAB
    
    style SMN_T fill:#ffe1f5,stroke:#e91e63,stroke-width:3px
    style SMN_I fill:#ffe1f5,stroke:#e91e63,stroke-width:3px
    style CFG_UP fill:#ffe1e1,stroke:#f44336,stroke-width:3px
        </div><p><strong>SMN Connection Details:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal/Socket</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_target</span></code></p></td>
<td><p>TLM Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Input</p></td>
<td><p>Receives configuration transactions from SMN for TLBs, MSI, SII, Config registers</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code></p></td>
<td><p>TLM Initiator Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Output</p></td>
<td><p>Sends bypass path responses via <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>Interrupt to SMN when PCIe config space is written (CII tracking)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_bus_num</span></code></p></td>
<td><p>Signal</p></td>
<td><p>8-bit</p></td>
<td><p>Output</p></td>
<td><p>PCIe bus number from SII CORE_CONTROL register</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_dev_num</span></code></p></td>
<td><p>Signal</p></td>
<td><p>8-bit</p></td>
<td><p>Output</p></td>
<td><p>PCIe device number from SII CORE_CONTROL register</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_device_type</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>Device type: 0=Endpoint, 1=Root Port</p></td>
</tr>
</tbody>
</table>
<p><strong>SMN Configuration Targets:</strong></p>
<p>SMN can configure the following via <code class="docutils literal notranslate"><span class="pre">smn_n_target</span></code>:</p>
<ul class="simple">
<li><p><strong>Config Register Block</strong> (offset 0x0xxx): <code class="docutils literal notranslate"><span class="pre">system_ready</span></code>, enables, isolation control</p></li>
<li><p><strong>SII Block</strong> (offset 0x1xxx): CORE_CONTROL (device_type [2:0]: 0x4=RP), CFG_MODIFIED (RW1C), BUS_DEV_NUM. Writes to CORE_CONTROL invoke a <strong>device_type callback</strong> so NOC-PCIE switch controller mode (EP/RP) is updated immediately for BME logic.</p></li>
<li><p><strong>TLB Configuration</strong> (offset 0x3xxx-0x7xxx): Valid bits, page masks, base addresses</p></li>
<li><p><strong>MSI Relay</strong> (offset 0x8xxx): MSI-X table, PBA, masks</p></li>
</ul>
<p><strong>Configuration Sequence:</strong></p>
<ol class="arabic simple">
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code> to Config Register Block</p></li>
<li><p>SMN configures TLB entries (inbound/outbound)</p></li>
<li><p>SMN enables data paths: <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code></p></li>
<li><p>SMN monitors <code class="docutils literal notranslate"><span class="pre">config_update</span></code> interrupt for PCIe config space changes</p></li>
</ol>
</section>
<section id="noc-subsystem-connection">
<h4>2.3.2 NOC Subsystem Connection<a class="headerlink" href="#noc-subsystem-connection" title="Permalink to this heading"></a></h4>
<div class="mermaid">
            graph LR
    subgraph NOC[&quot;NOC Subsystem&quot;]
        direction TB
        NOC_FAB[NOC Network Fabric&lt;br/&gt;Data Transfer&lt;br/&gt;64-bit TLM]
        MSI_SRC[MSI Interrupt Source&lt;br/&gt;Vector Generator]
        TO_MON[Timeout Monitor]
    end
    
    subgraph TILE[&quot;Keraunos PCIe Tile&quot;]
        direction TB
        
        subgraph TLM[&quot;TLM Sockets&quot;]
            NOC_T[noc_n_target&lt;br/&gt;64-bit Target]
            NOC_I[noc_n_initiator&lt;br/&gt;64-bit Initiator]
        end
        
        subgraph OUT[&quot;Output Signals&quot;]
            TO_OUT[noc_timeout&lt;br/&gt;3-bit]
        end
    end
    
    NOC_FAB &lt;--&gt;|TLM blocking transport&lt;br/&gt;Outbound data path&lt;br/&gt;NOC to PCIe via TLB| NOC_T
    MSI_SRC --&gt;|Write MSI vector&lt;br/&gt;addr 0x18800000&lt;br/&gt;Generate MSI-X| NOC_T
    NOC_I &lt;--&gt;|TLM blocking transport&lt;br/&gt;Inbound data path&lt;br/&gt;PCIe to NOC via TLB| NOC_FAB
    TO_OUT -.-&gt;|Timeout status&lt;br/&gt;monitoring| TO_MON
    
    style NOC_T fill:#e1f5ff,stroke:#3498db,stroke-width:3px
    style NOC_I fill:#e1f5ff,stroke:#3498db,stroke-width:3px
    style TO_OUT fill:#fff4e1,stroke:#ff9800,stroke-width:2px
        </div><p><strong>NOC Connection Details:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal/Socket</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code></p></td>
<td><p>TLM Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Input</p></td>
<td><p>Receives NOC transactions for outbound PCIe path (NOC→TLB→PCIe)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code></p></td>
<td><p>TLM Initiator Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Output</p></td>
<td><p>Sends translated inbound PCIe transactions via <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> (PCIe→TLB→NOC)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_timeout</span></code></p></td>
<td><p>Signal</p></td>
<td><p>3-bit</p></td>
<td><p>Output</p></td>
<td><p>NOC transaction timeout status for monitoring</p></td>
</tr>
</tbody>
</table>
<p><strong>Data Flow Paths:</strong></p>
<ol class="arabic simple">
<li><p><strong>Outbound Path (NOC → PCIe):</strong></p>
<ul class="simple">
<li><p>NOC writes to <code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code> socket</p></li>
<li><p>NOC-IO switch routes to outbound TLB</p></li>
<li><p>TLB translates NOC address to PCIe address</p></li>
<li><p>NOC-PCIE switch checks <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code></p></li>
<li><p>If enabled, forwards through <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code> (real <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code>) to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></li>
</ul>
</li>
<li><p><strong>Inbound Path (PCIe → NOC):</strong></p>
<ul class="simple">
<li><p>PCIe controller writes to <code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code> socket</p></li>
<li><p>NOC-PCIE switch routes based on addr[63:60]</p></li>
<li><p>Inbound TLB translates PCIe address to NOC address</p></li>
<li><p>NOC-IO switch forwards through <code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code> (real <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code>) to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></li>
</ul>
</li>
<li><p><strong>MSI Generation:</strong></p>
<ul class="simple">
<li><p>NOC MSI source writes MSI vector to <code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code> at special address (0x18800000)</p></li>
<li><p>MSI Relay Unit processes vector, checks masks</p></li>
<li><p>Generates MSI-X transaction to PCIe controller</p></li>
<li><p><strong>Note:</strong> MSI generation functional via initiator sockets to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></li>
</ul>
</li>
</ol>
</section>
<section id="designware-pcie-controller-connection">
<h4>2.3.3 Designware PCIe Controller Connection<a class="headerlink" href="#designware-pcie-controller-connection" title="Permalink to this heading"></a></h4>
<div class="mermaid">
            graph LR
    subgraph DW[&quot;Designware PCIe Controller&quot;]
        direction TB
        
        subgraph DATA[&quot;Data Path&quot;]
            AXI_M[AXI Master Interface&lt;br/&gt;Inbound TLPs]
            AXI_S[AXI Slave Interface&lt;br/&gt;Outbound TLPs]
        end
        
        subgraph CII[&quot;CII Interface&quot;]
            CII_HV[cii_hdr_valid]
            CII_TYPE[cii_hdr_type&lt;br/&gt;5-bit]
            CII_ADDR[cii_hdr_addr&lt;br/&gt;12-bit]
        end
        
        subgraph INT[&quot;Interrupts&quot;]
            FLR_I[FLR Request]
            HOT_I[Hot Reset]
            RAS_I[RAS Error]
            DMA_I[DMA Done]
            MISC_I[Misc Int]
        end
        
        subgraph CTL[&quot;Control&quot;]
            CLK[pcie_core_clk]
            RST[controller_reset_n]
        end
    end
    
    subgraph TILE[&quot;Keraunos PCIe Tile&quot;]
        direction TB
        
        subgraph TLM[&quot;TLM Sockets&quot;]
            P_TGT[pcie_controller_target&lt;br/&gt;64-bit Target]
            P_INIT[pcie_controller_initiator&lt;br/&gt;64-bit Initiator]
        end
        
        subgraph CII_IN[&quot;CII Inputs&quot;]
            C_HV[pcie_cii_hv]
            C_TYPE[pcie_cii_hdr_type&lt;br/&gt;5-bit]
            C_ADDR[pcie_cii_hdr_addr&lt;br/&gt;12-bit]
        end
        
        subgraph INT_IN[&quot;Interrupt Inputs&quot;]
            F_IN[pcie_flr_request]
            H_IN[pcie_hot_reset]
            R_IN[pcie_ras_error]
            D_IN[pcie_dma_completion]
            M_IN[pcie_misc_int]
        end
        
        subgraph INT_OUT[&quot;Interrupt Outputs&quot;]
            F_OUT[function_level_reset]
            H_OUT[hot_reset_requested]
            R_OUT[ras_error]
            D_OUT[dma_completion]
            M_OUT[controller_misc_int]
        end
        
        subgraph CTL_IN[&quot;Control Inputs&quot;]
            P_CLK[pcie_core_clk]
            P_RST[pcie_controller_reset_n]
        end
    end
    
    subgraph SYS[&quot;System&quot;]
        INT_CTRL[System Interrupt&lt;br/&gt;Controller]
    end
    
    AXI_M &lt;--&gt;|TLM b_transport&lt;br/&gt;Inbound PCIe TLPs| P_TGT
    P_INIT &lt;--&gt;|TLM b_transport&lt;br/&gt;Outbound PCIe TLPs| AXI_S
    
    CII_HV --&gt;|Config write detected| C_HV
    CII_TYPE --&gt;|TLP type 0x04| C_TYPE
    CII_ADDR --&gt;|Byte offset 0-127| C_ADDR
    
    FLR_I --&gt;|Event signal| F_IN
    HOT_I --&gt;|Event signal| H_IN
    RAS_I --&gt;|Event signal| R_IN
    DMA_I --&gt;|Event signal| D_IN
    MISC_I --&gt;|Event signal| M_IN
    
    F_OUT --&gt;|Forwarded| INT_CTRL
    H_OUT --&gt;|Forwarded| INT_CTRL
    R_OUT --&gt;|Forwarded| INT_CTRL
    D_OUT --&gt;|Forwarded| INT_CTRL
    M_OUT --&gt;|Forwarded| INT_CTRL
    
    CLK --&gt;|PCIe domain| P_CLK
    RST --&gt;|Active low| P_RST
    
    style P_TGT fill:#fff4e1,stroke:#ff9800,stroke-width:3px
    style P_INIT fill:#fff4e1,stroke:#ff9800,stroke-width:3px
    style C_HV fill:#d1f5d1,stroke:#4caf50,stroke-width:2px
    style C_TYPE fill:#d1f5d1,stroke:#4caf50,stroke-width:2px
    style C_ADDR fill:#d1f5d1,stroke:#4caf50,stroke-width:2px
    style F_OUT fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style H_OUT fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style R_OUT fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style D_OUT fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style M_OUT fill:#ffe1e1,stroke:#f44336,stroke-width:2px
        </div><p><strong>PCIe Controller Connection Details:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal/Socket</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code></p></td>
<td><p>TLM Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Input</p></td>
<td><p>Receives inbound TLPs from PCIe controller AXI master</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code></p></td>
<td><p>TLM Initiator Socket</p></td>
<td><p>64-bit</p></td>
<td><p>Output</p></td>
<td><p>Sends outbound TLPs via <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hv</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>CII header valid: config space write detected</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_type</span></code></p></td>
<td><p>Signal</p></td>
<td><p>5-bit</p></td>
<td><p>Input</p></td>
<td><p>TLP type (0x04 = configuration write)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_addr</span></code></p></td>
<td><p>Signal</p></td>
<td><p>12-bit</p></td>
<td><p>Input</p></td>
<td><p>Config space byte address (track first 128B)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_flr_request</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Function-level reset requested</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_hot_reset</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Hot reset detected on link</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_ras_error</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>RAS error event</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_dma_completion</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>DMA transaction completed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_misc_int</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Miscellaneous controller interrupt</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">function_level_reset</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>FLR forwarded to system (requires delta cycle)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hot_reset_requested</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>Hot reset forwarded to system</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ras_error</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>RAS error forwarded to system</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dma_completion</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>DMA done forwarded to system</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controller_misc_int</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>Misc interrupt forwarded to system</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code></p></td>
<td><p>Clock</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>PCIe core clock (Gen3: 250MHz)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Controller reset (active low), resets SII CII state</p></td>
</tr>
</tbody>
</table>
<p><strong>CII Tracking Flow:</strong></p>
<ol class="arabic simple">
<li><p>PCIe controller detects config space write</p></li>
<li><p>Asserts <code class="docutils literal notranslate"><span class="pre">cii_hdr_valid</span></code> with type and address</p></li>
<li><p>Tile’s SII block tracks writes to first 128 bytes</p></li>
<li><p>Sets bit in <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> register</p></li>
<li><p>Asserts <code class="docutils literal notranslate"><span class="pre">config_update</span></code> interrupt to SMN</p></li>
<li><p>SMN reads <code class="docutils literal notranslate"><span class="pre">CFG_MODIFIED</span></code>, clears with RW1C writes</p></li>
</ol>
<p><strong>Interrupt Forwarding:</strong></p>
<ul class="simple">
<li><p><strong>Critical:</strong> All interrupt forwarding requires <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> after input changes</p></li>
<li><p>Input signals must propagate through SystemC delta cycle before outputs are valid</p></li>
<li><p>Outputs go to system interrupt controller for software handling</p></li>
</ul>
</section>
<section id="system-control-connection">
<h4>2.3.4 System Control Connection<a class="headerlink" href="#system-control-connection" title="Permalink to this heading"></a></h4>
<div class="mermaid">
            graph LR
    subgraph SYS[&quot;System Control&quot;]
        direction TB
        RST_CTRL[Reset Controller]
        ISO_CTRL[Isolation Controller&lt;br/&gt;Power Management]
        CLK_GEN[Clock Generator]
        INT_CTRL[Interrupt Controller]
    end
    
    subgraph TILE[&quot;Keraunos PCIe Tile&quot;]
        direction TB
        
        subgraph RST[&quot;Reset Inputs&quot;]
            COLD[cold_reset_n&lt;br/&gt;Active Low]
            WARM[warm_reset_n&lt;br/&gt;Active Low]
        end
        
        subgraph ISO[&quot;Isolation&quot;]
            ISO_REQ[isolate_req]
        end
        
        subgraph CLK[&quot;Clocks&quot;]
            AXI[axi_clk]
        end
        
        subgraph INT[&quot;Interrupt Outputs&quot;]
            SYS_I[pcie_sys_int]
        end
    end
    
    RST_CTRL --&gt;|Cold reset&lt;br/&gt;Resets SII and&lt;br/&gt;reset control| COLD
    RST_CTRL --&gt;|Warm reset&lt;br/&gt;Similar to cold| WARM
    ISO_CTRL --&gt;|Isolation request&lt;br/&gt;Clears all enables&lt;br/&gt;PERMANENT| ISO_REQ
    CLK_GEN --&gt;|AXI/NOC domain&lt;br/&gt;System clock| AXI
    SYS_I -.-&gt;|System interrupt&lt;br/&gt;Currently tied to 0| INT_CTRL
    
    style COLD fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style WARM fill:#ffe1e1,stroke:#f44336,stroke-width:2px
    style ISO_REQ fill:#ffcccc,stroke:#cc0000,stroke-width:3px
    style AXI fill:#e1ffe1,stroke:#4caf50,stroke-width:2px
        </div><p><strong>System Control Connection Details:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Cold reset (active low): Resets SII block and reset control module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Warm reset (active low): Similar behavior to cold reset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>Isolation request: Clears <code class="docutils literal notranslate"><span class="pre">system_ready</span></code> and all enables (PERMANENT)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axi_clk</span></code></p></td>
<td><p>Clock</p></td>
<td><p>1-bit</p></td>
<td><p>Input</p></td>
<td><p>AXI/NOC domain clock (system-dependent frequency)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_sys_int</span></code></p></td>
<td><p>Signal</p></td>
<td><p>1-bit</p></td>
<td><p>Output</p></td>
<td><p>System interrupt output (currently tied to 0)</p></td>
</tr>
</tbody>
</table>
<p><strong>Reset Behavior:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reset Type</p></th>
<th class="head"><p>Resets</p></th>
<th class="head"><p>Does NOT Reset</p></th>
<th class="head"><p>Recovery</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>SII CII tracking, reset control module; <strong>BME</strong> restored to default (enabled) in NOC-PCIE switch; SII <strong>device_type</strong> (EP/RP) reset to EP</p></td>
<td><p>Config registers, TLBs, enables</p></td>
<td><p>Software reconfiguration required</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>Similar to cold reset</p></td>
<td><p>Config registers, TLBs, enables</p></td>
<td><p>Software reconfiguration required</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>SII CII tracking only</p></td>
<td><p>Everything else</p></td>
<td><p>Automatic on reset deassertion</p></td>
</tr>
</tbody>
</table>
<p><strong>Critical Isolation Limitation:</strong></p>
<p>⚠️ <strong>WARNING:</strong> Asserting <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> permanently clears all enables. Recovery requires:</p>
<ol class="arabic simple">
<li><p>Cold reset cycle (<code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code> low then high)</p></li>
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code></p></li>
<li><p>SMN reconfigures TLB entries</p></li>
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code></p></li>
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code></p></li>
</ol>
<p>Simply deasserting <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> does NOT restore functionality. This is a known architectural limitation.</p>
<p><strong>Connection Summary:</strong></p>
</section>
<section id="tlm-socket-connections-64-bit-blocking-transport">
<h4>TLM Socket Connections (64-bit, blocking transport)<a class="headerlink" href="#tlm-socket-connections-64-bit-blocking-transport" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Socket</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>External Subsystem</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code></p></td>
<td><p>Input</p></td>
<td><p>NOC Network Fabric</p></td>
<td><p>Receives NOC transactions for outbound PCIe (NOC→PCIe)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code></p></td>
<td><p>Output</p></td>
<td><p>NOC / <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></td>
<td><p>Sends translated inbound PCIe via real initiator socket (PCIe→NOC)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_target</span></code></p></td>
<td><p>Input</p></td>
<td><p>SMN Network Fabric</p></td>
<td><p>Receives configuration transactions from SMN</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code></p></td>
<td><p>Output</p></td>
<td><p>SMN / <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></td>
<td><p>Sends bypass/response transactions via real initiator socket</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code></p></td>
<td><p>Input</p></td>
<td><p>DW PCIe AXI Master</p></td>
<td><p>Receives inbound TLPs from PCIe controller</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code></p></td>
<td><p>Output</p></td>
<td><p>DW PCIe AXI Slave / <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></td>
<td><p>Sends outbound TLPs via real initiator socket</p></td>
</tr>
</tbody>
</table>
</section>
<section id="clock-connections">
<h4>Clock Connections<a class="headerlink" href="#clock-connections" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Input</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Frequency</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code></p></td>
<td><p>DW PCIe Controller</p></td>
<td><p>PCIe Link Speed</p></td>
<td><p>PCIe domain clock (Gen3: 250MHz)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axi_clk</span></code></p></td>
<td><p>System Clock Generator</p></td>
<td><p>System Dependent</p></td>
<td><p>AXI/NOC domain clock</p></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Both clocks must be running for tile operation. Clock domain crossing is handled internally.</p>
</section>
<section id="reset-connections">
<h4>Reset Connections<a class="headerlink" href="#reset-connections" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Input</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Effect</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>System Reset Controller</p></td>
<td><p>Active Low</p></td>
<td><p>Resets SII and reset control modules</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>System Reset Controller</p></td>
<td><p>Active Low</p></td>
<td><p>Similar to cold reset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>DW PCIe Controller</p></td>
<td><p>Active Low</p></td>
<td><p>Resets SII CII tracking state</p></td>
</tr>
</tbody>
</table>
<p><strong>Integration Note:</strong> Cold reset does NOT clear configuration registers. Software reconfiguration required after reset.</p>
</section>
<section id="cii-interface-connections-configuration-intercept">
<h4>CII Interface Connections (Configuration Intercept)<a class="headerlink" href="#cii-interface-connections-configuration-intercept" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Input</p></th>
<th class="head"><p>DW PCIe Output</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hv</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cii_hdr_valid</span></code></p></td>
<td><p>1-bit</p></td>
<td><p>Indicates valid CII header (config write detected)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cii_hdr_type</span></code></p></td>
<td><p>5-bit</p></td>
<td><p>TLP type (0x04 = configuration write)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_addr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cii_hdr_addr</span></code></p></td>
<td><p>12-bit</p></td>
<td><p>Config space byte address (track first 128B)</p></td>
</tr>
</tbody>
</table>
<p><strong>Purpose:</strong> Allows tile to track PCIe configuration space writes and generate <code class="docutils literal notranslate"><span class="pre">config_update</span></code> interrupt to SMN.</p>
</section>
<section id="interrupt-forwarding-pcie-controller-tile-system">
<h4>Interrupt Forwarding (PCIe Controller → Tile → System)<a class="headerlink" href="#interrupt-forwarding-pcie-controller-tile-system" title="Permalink to this heading"></a></h4>
<p><strong>Inputs from DW PCIe Controller:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Input</p></th>
<th class="head"><p>DW PCIe Source</p></th>
<th class="head"><p>Trigger Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_flr_request</span></code></p></td>
<td><p>FLR logic</p></td>
<td><p>Function-level reset requested via config space</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_hot_reset</span></code></p></td>
<td><p>Link training</p></td>
<td><p>Hot reset detected on PCIe link</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_ras_error</span></code></p></td>
<td><p>RAS logic</p></td>
<td><p>Reliability/Availability/Serviceability error</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_dma_completion</span></code></p></td>
<td><p>DMA engine</p></td>
<td><p>DMA transaction completed</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_misc_int</span></code></p></td>
<td><p>Various</p></td>
<td><p>Controller-specific miscellaneous interrupts</p></td>
</tr>
</tbody>
</table>
<p><strong>Outputs to System Interrupt Controller:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Output</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">function_level_reset</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>Forwarded FLR (requires delta cycle wait)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hot_reset_requested</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>Forwarded hot reset (requires delta cycle wait)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ras_error</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>Forwarded RAS error (requires delta cycle wait)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dma_completion</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>Forwarded DMA done (requires delta cycle wait)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controller_misc_int</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>Forwarded misc interrupt (requires delta cycle wait)</p></td>
</tr>
</tbody>
</table>
<p><strong>Implementation Note:</strong> All interrupt forwarding requires <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> after input signal changes to allow SystemC delta cycle propagation before reading outputs.</p>
</section>
<section id="cii-interrupt-output">
<h4>CII Interrupt Output<a class="headerlink" href="#cii-interrupt-output" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Output</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Trigger Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></td>
<td><p>SMN Interrupt Controller</p></td>
<td><p>PCIe config space write detected in first 128B (via CII tracking)</p></td>
</tr>
</tbody>
</table>
<p><strong>Software Handling:</strong> SMN reads <code class="docutils literal notranslate"><span class="pre">CFG_MODIFIED</span></code> register, processes changes, writes 1s to clear (RW1C). Interrupt deasserts when all bits cleared.</p>
</section>
<section id="status-outputs">
<h4>Status Outputs<a class="headerlink" href="#status-outputs" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Output</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_bus_num</span></code></p></td>
<td><p>System/SMN</p></td>
<td><p>8-bit</p></td>
<td><p>PCIe bus number from SII CORE_CONTROL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_dev_num</span></code></p></td>
<td><p>System/SMN</p></td>
<td><p>8-bit</p></td>
<td><p>PCIe device number from SII CORE_CONTROL</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_device_type</span></code></p></td>
<td><p>System/SMN</p></td>
<td><p>1-bit</p></td>
<td><p>0=Endpoint, 1=Root Port (from SII)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_sys_int</span></code></p></td>
<td><p>System Interrupt Controller</p></td>
<td><p>1-bit</p></td>
<td><p>System interrupt (currently tied to 0)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_timeout</span></code></p></td>
<td><p>NOC Timeout Monitor</p></td>
<td><p>3-bit</p></td>
<td><p>NOC transaction timeout status</p></td>
</tr>
</tbody>
</table>
</section>
<section id="isolation-control">
<h4>Isolation Control<a class="headerlink" href="#isolation-control" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile Input</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>Isolation Controller</p></td>
<td><p>Request isolation mode (clears all enables)</p></td>
</tr>
</tbody>
</table>
<p><strong>Critical Limitation:</strong> Deasserting <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> does NOT restore enables. Recovery requires:</p>
<ol class="arabic simple">
<li><p>Cold reset cycle</p></li>
<li><p>SMN reconfiguration of <code class="docutils literal notranslate"><span class="pre">system_ready</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code></p></li>
</ol>
</section>
<section id="msi-input-special-case">
<h4>MSI Input (Special Case)<a class="headerlink" href="#msi-input-special-case" title="Permalink to this heading"></a></h4>
<p>The NOC subsystem can write to the tile’s <code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code> socket at a specific MSI input address (e.g., 0x18800000) to generate MSI-X interrupts. The MSI relay unit processes these and forwards them to the PCIe controller via <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code>.</p>
<p><strong>Note:</strong> MSI routing paths are functional. Outbound MSI transactions are forwarded through real initiator sockets to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code>, enabling cross-socket data verification in the testbench.</p>
</section>
<section id="integration-checklist">
<h4>Integration Checklist<a class="headerlink" href="#integration-checklist" title="Permalink to this heading"></a></h4>
<p>✅ <strong>Required Connections:</strong></p>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect all 6 TLM sockets (3 target, 3 initiator) with matching bit widths</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect both clocks (<code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code> from DW PCIe, <code class="docutils literal notranslate"><span class="pre">axi_clk</span></code> from system)</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect all 3 reset signals (cold, warm, pcie_controller)</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect 3 CII interface signals (hv, type, addr) from DW PCIe CII output</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect 5 interrupt inputs from DW PCIe controller</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect 6 interrupt outputs to system interrupt controller(s)</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect isolation control from power management</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Connect status outputs to system monitoring/SMN</p></li>
</ul>
<p>⚠️ <strong>SystemC Simulation Requirements:</strong></p>
<ul class="simple">
<li><p>Ensure <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> in drivers after changing input signals</p></li>
<li><p>All interrupt outputs require delta cycle propagation</p></li>
<li><p>TLM blocking transport calls are synchronous but internal signals are not</p></li>
</ul>
<p>🔧 <strong>Configuration Sequence:</strong></p>
<ol class="arabic simple">
<li><p>Deassert cold reset</p></li>
<li><p>Wait for stable clocks</p></li>
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code></p></li>
<li><p>SMN configures TLB entries</p></li>
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code> and <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code></p></li>
<li><p>System enters normal operation</p></li>
</ol>
</section>
</section>
</section>
<hr class="docutils" />
<section id="theory-of-operation">
<h2>3. Theory of Operation<a class="headerlink" href="#theory-of-operation" title="Permalink to this heading"></a></h2>
<p>This section describes the operational modes and transaction flows of the Keraunos PCIe Tile.</p>
<section id="operational-modes">
<h3>3.1 Operational Modes<a class="headerlink" href="#operational-modes" title="Permalink to this heading"></a></h3>
<p>The PCIe Tile operates in several distinct modes:</p>
<section id="normal-operation-mode">
<h4>Normal Operation Mode<a class="headerlink" href="#normal-operation-mode" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><strong>System Ready</strong>: <code class="docutils literal notranslate"><span class="pre">system_ready</span></code> register bit set to 1</p></li>
<li><p><strong>Application Paths Enabled</strong>: <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code> and <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code> set as needed</p></li>
<li><p><strong>No Isolation</strong>: <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> signal deasserted</p></li>
<li><p><strong>Clocks Running</strong>: Both <code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code> and <code class="docutils literal notranslate"><span class="pre">axi_clk</span></code> active</p></li>
<li><p><strong>No Reset</strong>: <code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code> and <code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code> asserted (active high)</p></li>
</ul>
<p>In this mode, all data paths are operational and transactions flow freely between NOC, PCIe, and SMN domains.</p>
</section>
<section id="isolation-mode">
<h4>Isolation Mode<a class="headerlink" href="#isolation-mode" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Triggered By</strong>: Assertion of <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> signal</p></li>
<li><p><strong>Effect</strong>: Clears <code class="docutils literal notranslate"><span class="pre">system_ready</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code>, and <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code></p></li>
<li><p><strong>Data Path</strong>: All PCIe controller transactions return <code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code> (DECERR)</p></li>
<li><p><strong>Recovery Limitation</strong>: Deasserting <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> does NOT automatically restore enables (requires cold reset + software reconfiguration)</p></li>
<li><p><strong>Use Case</strong>: Power domain isolation, fault containment</p></li>
</ul>
</section>
<section id="bypass-mode">
<h4>Bypass Mode<a class="headerlink" href="#bypass-mode" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Condition</strong>: <code class="docutils literal notranslate"><span class="pre">system_ready=0</span></code> but <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code> or <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code></p></li>
<li><p><strong>Routing</strong>: Uses route 0xE or 0xF to access status register directly</p></li>
<li><p><strong>Purpose</strong>: Allow status monitoring without full system initialization</p></li>
<li><p><strong>Limited Functionality</strong>: Only status register readable; normal data paths blocked</p></li>
</ul>
</section>
<section id="reset-modes">
<h4>Reset Modes<a class="headerlink" href="#reset-modes" title="Permalink to this heading"></a></h4>
<p><strong>Cold Reset:</strong></p>
<ul class="simple">
<li><p><strong>Trigger</strong>: <code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code> signal deasserted (active low)</p></li>
<li><p><strong>Scope</strong>: Resets SII block (<code class="docutils literal notranslate"><span class="pre">pcie_sii_reset_ctrl_</span></code>) and reset control module (<code class="docutils literal notranslate"><span class="pre">pcie_reset_ctrl_</span></code>)</p></li>
<li><p><strong>Does NOT Reset</strong>: Configuration registers, TLB entries, switch enables</p></li>
<li><p><strong>Recovery</strong>: Requires software reconfiguration after reset</p></li>
</ul>
<p><strong>Warm Reset:</strong></p>
<ul class="simple">
<li><p><strong>Trigger</strong>: <code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code> signal deasserted (active low)</p></li>
<li><p><strong>Scope</strong>: Similar to cold reset but may preserve certain configuration state</p></li>
<li><p><strong>Note</strong>: Current implementation behavior similar to cold reset</p></li>
</ul>
</section>
</section>
<section id="initialization-and-boot-sequence">
<h3>3.2 Initialization and Boot Sequence<a class="headerlink" href="#initialization-and-boot-sequence" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant SMN as SMN Host
    participant Tile as PCIe Tile
    participant Switch as NOC-PCIE Switch
    participant TLB as TLB Units
    participant SII as SII Block
    participant PCIE as PCIe Controller

    Note over Tile: Power-On / Cold Reset
    SMN-&gt;&gt;Tile: Deassert cold_reset_n
    Tile-&gt;&gt;SII: Reset SII state
    Tile-&gt;&gt;Switch: system_ready=0, enables=0
    
    Note over Tile: Configuration Phase
    SMN-&gt;&gt;Switch: Write system_ready=1
    Switch-&gt;&gt;Switch: Enable routing logic
    
    SMN-&gt;&gt;TLB: Configure inbound TLB entries
    Note over TLB: Set valid bits, page masks, base addresses
    
    SMN-&gt;&gt;TLB: Configure outbound TLB entries
    Note over TLB: Set application path translations
    
    SMN-&gt;&gt;Switch: Write pcie_inbound_app_enable=1
    SMN-&gt;&gt;Switch: Write pcie_outbound_app_enable=1
    Switch-&gt;&gt;Switch: Enable application data paths
    
    Note over Tile: Normal Operation
    PCIE-&gt;&gt;Switch: Inbound transaction
    Switch-&gt;&gt;TLB: Address translation
    TLB-&gt;&gt;Switch: Translated address
    Switch-&gt;&gt;PCIE: Transaction complete
        </div><p><strong>Initialization Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>Reset Phase</strong></p>
<ul class="simple">
<li><p>Assert <code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code> to bring tile to known state</p></li>
<li><p>SII block clears all CII tracking state</p></li>
<li><p>Switch enables default to 0</p></li>
</ul>
</li>
<li><p><strong>System Ready Configuration</strong></p>
<ul class="simple">
<li><p>SMN writes <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code> to status register (offset 0x0)</p></li>
<li><p>Enables basic routing logic in switches</p></li>
<li><p>Status register becomes readable via routes 0xE and 0xF</p></li>
</ul>
</li>
<li><p><strong>TLB Configuration</strong></p>
<ul class="simple">
<li><p>Configure inbound TLBs (Sys In0, Sys In1, App In0/1/2)</p></li>
<li><p>Set valid bits, page sizes, base addresses, address masks</p></li>
<li><p>Configure outbound TLBs (Sys Out, App Out0/1)</p></li>
<li><p>Set AxUSER fields for NOC routing</p></li>
</ul>
</li>
<li><p><strong>Data Path Enablement</strong></p>
<ul class="simple">
<li><p>Write <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code> for PCIe→NOC application paths</p></li>
<li><p>Write <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code> for NOC→PCIe application paths</p></li>
<li><p>System enters normal operation mode</p></li>
</ul>
</li>
</ol>
</section>
<section id="inbound-data-flow-pcie-to-noc">
<h3>3.3 Inbound Data Flow (PCIe to NOC)<a class="headerlink" href="#inbound-data-flow-pcie-to-noc" title="Permalink to this heading"></a></h3>
<p><strong>Transaction Path: PCIe Controller → NOC-PCIE Switch → Inbound TLB → NOC-IO Switch → NOC</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant PCIE as PCIe Controller
    participant NOCP as NOC-PCIE Switch
    participant TLB as Inbound TLB
    participant NOCI as NOC-IO Switch
    participant NOC as NOC Network

    PCIE-&gt;&gt;NOCP: b_transport(addr[63:0], data)
    Note over NOCP: Check system_ready
    
    alt system_ready == 0
        NOCP-&gt;&gt;PCIE: TLM_ADDRESS_ERROR_RESPONSE
    else Route bits [63:60]
        NOCP-&gt;&gt;NOCP: Decode route (0x0,0x1,0x4,0x6,0x7)
        
        alt Application path (0x0, 0x1, 0x6, 0x7)
            Note over NOCP: Check pcie_inbound_app_enable
            alt Enable == 0
                NOCP-&gt;&gt;PCIE: TLM_ADDRESS_ERROR_RESPONSE
            else Enable == 1
                NOCP-&gt;&gt;TLB: translate_and_forward(addr)
                Note over TLB: Calculate index = (addr &gt;&gt; shift) &amp; page_mask
                Note over TLB: Check valid bit
                
                alt valid == 0
                    TLB-&gt;&gt;NOCP: TLM_ADDRESS_ERROR_RESPONSE
                    NOCP-&gt;&gt;PCIE: DECERR
                else valid == 1
                    TLB-&gt;&gt;TLB: new_addr = entry.addr + offset
                    TLB-&gt;&gt;TLB: Set AxUSER field
                    TLB-&gt;&gt;NOCI: forward(new_addr, AxUSER)
                    NOCI-&gt;&gt;NOC: b_transport(translated_addr)
                    NOC-&gt;&gt;NOCI: TLM_OK_RESPONSE
                    NOCI-&gt;&gt;TLB: Success
                    TLB-&gt;&gt;NOCP: Success
                    NOCP-&gt;&gt;PCIE: TLM_OK_RESPONSE
                end
            end
        else System path (0x4)
            NOCP-&gt;&gt;TLB: translate_and_forward(addr)
            Note over TLB: System TLB (smaller pages)
            TLB-&gt;&gt;NOCI: forward(translated_addr)
            NOCI-&gt;&gt;NOC: b_transport
            NOC-&gt;&gt;PCIE: Response propagates back
        end
    end
        </div><p><strong>Key Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>PCIe Controller Transaction</strong></p>
<ul class="simple">
<li><p>Transaction arrives at <code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code> socket</p></li>
<li><p>64-bit address with route field [63:60]</p></li>
</ul>
</li>
<li><p><strong>NOC-PCIE Switch Routing</strong></p>
<ul class="simple">
<li><p>Check <code class="docutils literal notranslate"><span class="pre">system_ready</span></code> flag (blocks if 0)</p></li>
<li><p>Decode route bits [63:60]</p></li>
<li><p>For application paths: check <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code></p></li>
<li><p>For system paths: always allowed if <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code></p></li>
</ul>
</li>
<li><p><strong>TLB Translation</strong></p>
<ul class="simple">
<li><p>Extract page index: <code class="docutils literal notranslate"><span class="pre">(addr</span> <span class="pre">&gt;&gt;</span> <span class="pre">shift)</span> <span class="pre">&amp;</span> <span class="pre">page_mask</span></code></p></li>
<li><p>Look up TLB entry</p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">valid</span></code> bit</p></li>
<li><p>Calculate translated address: <code class="docutils literal notranslate"><span class="pre">base_addr</span> <span class="pre">+</span> <span class="pre">offset</span></code></p></li>
<li><p>Set AxUSER field for NOC routing</p></li>
</ul>
</li>
<li><p><strong>NOC-IO Switch Forwarding</strong></p>
<ul class="simple">
<li><p>Forward translated address through <code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code> (real <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code>) to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></li>
<li><p>Preserve AxUSER field</p></li>
<li><p>Cross-socket data verification: data written via inbound path can be read back via outbound path</p></li>
<li><p>Return response to PCIe controller</p></li>
</ul>
</li>
</ol>
</section>
<section id="outbound-data-flow-noc-to-pcie">
<h3>3.4 Outbound Data Flow (NOC to PCIe)<a class="headerlink" href="#outbound-data-flow-noc-to-pcie" title="Permalink to this heading"></a></h3>
<p><strong>Transaction Path: NOC → NOC-IO Switch → Outbound TLB → NOC-PCIE Switch → PCIe Controller</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant NOC as NOC Network
    participant NOCI as NOC-IO Switch
    participant TLB as Outbound TLB
    participant NOCP as NOC-PCIE Switch
    participant PCIE as PCIe Controller

    NOC-&gt;&gt;NOCI: b_transport(noc_addr, data)
    NOCI-&gt;&gt;TLB: translate_address()
    
    Note over TLB: Calculate TLB index
    Note over TLB: Check valid bit
    
    alt valid == 0
        TLB-&gt;&gt;NOCI: TLM_ADDRESS_ERROR_RESPONSE
        NOCI-&gt;&gt;NOC: DECERR
    else valid == 1
        TLB-&gt;&gt;TLB: pcie_addr = entry.addr + offset
        TLB-&gt;&gt;TLB: Convert 64-bit to 52-bit
        
        alt Application path
            Note over NOCP: Check pcie_outbound_app_enable
            alt Enable == 0
                NOCP-&gt;&gt;NOCI: TLM_ADDRESS_ERROR_RESPONSE
                NOCI-&gt;&gt;NOC: DECERR
            else Enable == 1
                NOCP-&gt;&gt;PCIE: b_transport(pcie_addr)
                PCIE-&gt;&gt;NOCP: TLM_OK_RESPONSE
                NOCP-&gt;&gt;NOCI: Success
                NOCI-&gt;&gt;NOC: TLM_OK_RESPONSE
            end
        else System path
            NOCP-&gt;&gt;PCIE: b_transport(pcie_addr)
            PCIE-&gt;&gt;NOC: Response propagates back
        end
    end
        </div><p><strong>Key Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>NOC Transaction</strong></p>
<ul class="simple">
<li><p>Arrives at <code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code> socket</p></li>
<li><p>NOC-specific addressing</p></li>
</ul>
</li>
<li><p><strong>NOC-IO Switch Processing</strong></p>
<ul class="simple">
<li><p>Routes to appropriate outbound TLB</p></li>
</ul>
</li>
<li><p><strong>Outbound TLB Translation</strong></p>
<ul class="simple">
<li><p>Translate NOC address to PCIe address space</p></li>
<li><p>Check valid bit</p></li>
<li><p>Convert 64-bit internal address to 52-bit PCIe address</p></li>
</ul>
</li>
<li><p><strong>NOC-PCIE Switch Gating</strong></p>
<ul class="simple">
<li><p>For application paths: check <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code></p></li>
<li><p><strong>BME qualification (EP mode only):</strong> When controller is Endpoint and Bus Master Enable is disabled, memory TLPs are blocked (DECERR); Config, DBI, and Message TLPs are exempt and allowed. In Root Port mode, BME is not checked and all traffic is allowed.</p></li>
<li><p>Outbound TLBs pass <strong>AxUSER</strong> (TLP type, DBI flag) to the switch for BME exemption decoding.</p></li>
<li><p>If enabled and (BME OK or exempt), forward through <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code> (real <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code>) to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code></p></li>
<li><p>Cross-socket data verification: data written via outbound path can be read back via inbound path</p></li>
</ul>
</li>
</ol>
</section>
<section id="configuration-access-flow">
<h3>3.5 Configuration Access Flow<a class="headerlink" href="#configuration-access-flow" title="Permalink to this heading"></a></h3>
<p><strong>Transaction Path: SMN → SMN-IO Switch → Configuration Targets</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant SMN as SMN Host
    participant SMNI as SMN-IO Switch
    participant TGT as Config Target
    participant SII as SII Block
    participant MSI as MSI Relay
    participant TLB as TLB Config

    SMN-&gt;&gt;SMNI: b_transport(smn_addr, data, cmd)
    
    Note over SMNI: Decode address bits [31:28]
    
    alt Config Register Block
        SMNI-&gt;&gt;TGT: forward(offset 0x0-0xFFF)
        TGT-&gt;&gt;TGT: Read/Write register
        Note over TGT: system_ready, enables, isolation
        TGT-&gt;&gt;SMNI: Response
        SMNI-&gt;&gt;SMN: TLM_OK_RESPONSE
        
    else SII Configuration
        SMNI-&gt;&gt;SII: process_apb_access(addr, data)
        Note over SII: CORE_CONTROL, CFG_MODIFIED, BUS_DEV_NUM
        alt Write to CFG_MODIFIED (RW1C)
            SII-&gt;&gt;SII: Clear modified bits
            SII-&gt;&gt;SII: Update config_update interrupt
        end
        SII-&gt;&gt;SMNI: Response
        
    else MSI Relay Configuration
        SMNI-&gt;&gt;MSI: process_msi_config(addr, data)
        Note over MSI: Configure MSI-X table, PBA, masks
        Note over MSI: Configure MSI-X table, PBA, masks
        MSI-&gt;&gt;SMNI: Response
        
    else TLB Configuration
        SMNI-&gt;&gt;TLB: process_tlb_config(addr, data)
        Note over TLB: Set valid bits, masks, base addresses
        Note over TLB: TLB config via SMN works correctly
        TLB-&gt;&gt;SMNI: Response
        
    else Unknown address
        SMNI-&gt;&gt;SMN: TLM_ADDRESS_ERROR_RESPONSE
    end
        </div><p><strong>Configuration Targets:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Address Range [31:28]</p></th>
<th class="head"><p>Target</p></th>
<th class="head"><p>Functionality</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>Config Registers</p></td>
<td><p>system_ready, enables, isolation</p></td>
</tr>
<tr class="row-odd"><td><p>0x1</p></td>
<td><p>SII Block</p></td>
<td><p>CORE_CONTROL, CFG_MODIFIED, BUS_DEV_NUM</p></td>
</tr>
<tr class="row-even"><td><p>0x2</p></td>
<td><p>Reserved</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>0x3-0x7</p></td>
<td><p>TLB Config</p></td>
<td><p>Inbound/Outbound TLB entries</p></td>
</tr>
<tr class="row-even"><td><p>0x8</p></td>
<td><p>MSI Relay</p></td>
<td><p>MSI-X table, PBA, masks</p></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> TLB configuration via SMN now works correctly. Configuration writes to TLB entries are properly routed and processed with correct offsets.</p>
</section>
<section id="msi-interrupt-generation-flow">
<h3>3.6 MSI Interrupt Generation Flow<a class="headerlink" href="#msi-interrupt-generation-flow" title="Permalink to this heading"></a></h3>
<p><strong>Transaction Path: NOC MSI Input → MSI Relay → PCIe Controller (MSI Output)</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant NOC as NOC (MSI Source)
    participant MSI as MSI Relay Unit
    participant Tile as PCIe Tile
    participant PCIE as PCIe Controller

    NOC-&gt;&gt;MSI: Write to msi_input (0x18800000)
    Note over MSI: process_msi_input() called
    Note over MSI: process_msi_input() called
    
    MSI-&gt;&gt;MSI: Extract vector number
    MSI-&gt;&gt;MSI: Check per-vector mask
    MSI-&gt;&gt;MSI: Check global mask
    MSI-&gt;&gt;MSI: Set PBA bit
    MSI-&gt;&gt;MSI: Increment msi_outstanding
    MSI-&gt;&gt;MSI: Trigger process_pending_msis()
    
    Note over Tile: signal_update_process()
    Tile-&gt;&gt;MSI: Call process_pending_msis()
    
    alt MSI-X enabled AND not masked AND PBA set
        MSI-&gt;&gt;MSI: Read MSI-X table entry
        MSI-&gt;&gt;MSI: Prepare MSI transaction
        MSI-&gt;&gt;PCIE: b_transport(msi_addr, msi_data)
        Note over PCIE: Forwarded via initiator socket&lt;br/&gt;to sparse_backing_memory
        PCIE-&gt;&gt;MSI: TLM_OK_RESPONSE
        MSI-&gt;&gt;MSI: Clear PBA bit
        MSI-&gt;&gt;MSI: Decrement msi_outstanding
    end
        </div><p><strong>MSI Flow Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>MSI Input Write</strong></p>
<ul class="simple">
<li><p>NOC writes to <code class="docutils literal notranslate"><span class="pre">msi_input_target</span></code> socket</p></li>
<li><p>Vector number encoded in write data</p></li>
</ul>
</li>
<li><p><strong>MSI Relay Processing</strong></p>
<ul class="simple">
<li><p>Check per-vector mask bit</p></li>
<li><p>Check global mask (<code class="docutils literal notranslate"><span class="pre">msix_mask_all_</span></code>)</p></li>
<li><p>Set corresponding PBA (Pending Bit Array) bit</p></li>
<li><p>Increment <code class="docutils literal notranslate"><span class="pre">msi_outstanding</span></code> counter</p></li>
</ul>
</li>
<li><p><strong>MSI Generation</strong> (via <code class="docutils literal notranslate"><span class="pre">process_pending_msis()</span></code>)</p>
<ul class="simple">
<li><p>Called by tile’s <code class="docutils literal notranslate"><span class="pre">signal_update_process()</span></code></p></li>
<li><p>Check MSI-X enabled (<code class="docutils literal notranslate"><span class="pre">msix_enable_</span></code>)</p></li>
<li><p>For each pending PBA bit:</p>
<ul>
<li><p>Read MSI-X table entry (address, data, mask)</p></li>
<li><p>If not masked, generate MSI transaction to PCIe</p></li>
<li><p>Clear PBA bit on successful delivery</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>Note:</strong> MSI output transactions are forwarded through the <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code> socket (now a real <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code>) to the testbench’s <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code>, enabling cross-socket data verification of MSI delivery.</p>
</section>
<section id="cii-tracking-and-configuration-update">
<h3>3.7 CII Tracking and Configuration Update<a class="headerlink" href="#cii-tracking-and-configuration-update" title="Permalink to this heading"></a></h3>
<p><strong>Configuration Intercept Interface (CII) Flow:</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant PCIE as PCIe Controller
    participant Tile as PCIe Tile
    participant SII as SII Block
    participant SMN as SMN Host

    Note over PCIE: PCIe config space write occurs
    PCIE-&gt;&gt;Tile: Assert pcie_cii_hv signal
    PCIE-&gt;&gt;Tile: Set pcie_cii_addr[7:0]
    PCIE-&gt;&gt;Tile: Set pcie_cii_type[3:0]
    
    Note over Tile: signal_update_process()
    Tile-&gt;&gt;SII: update()
    
    Note over SII: Read CII input signals
    alt pcie_cii_hv == 1
        SII-&gt;&gt;SII: Check type == 0x04 (config write)
        alt type == 0x04
            SII-&gt;&gt;SII: Check addr &lt; 0x80 (first 128B)
            alt addr &lt; 0x80
                SII-&gt;&gt;SII: reg_index = addr[6:2]
                SII-&gt;&gt;SII: cfg_modified_[reg_index] = 1
                SII-&gt;&gt;SII: Assert config_update interrupt
                SII-&gt;&gt;Tile: config_update = 1
                Tile-&gt;&gt;SMN: Interrupt signaled
                
                Note over SMN: Software handles interrupt
                SMN-&gt;&gt;SII: Read CFG_MODIFIED register
                SII-&gt;&gt;SMN: Return modified bitmask
                SMN-&gt;&gt;SII: Write to CFG_MODIFIED (RW1C)
                SII-&gt;&gt;SII: Clear specified bits
                alt All bits cleared
                    SII-&gt;&gt;SII: Deassert config_update
                    SII-&gt;&gt;Tile: config_update = 0
                end
            end
        end
    end
    
    Note over Tile: Reset clears all state
    alt pcie_controller_reset_n == 0
        SII-&gt;&gt;SII: cfg_modified_ = 0
        SII-&gt;&gt;SII: config_update = 0
    end
        </div><p><strong>CII Tracking Details:</strong></p>
<ol class="arabic simple">
<li><p><strong>Detection Phase</strong></p>
<ul class="simple">
<li><p>PCIe controller asserts <code class="docutils literal notranslate"><span class="pre">pcie_cii_hv</span></code> (handshake valid)</p></li>
<li><p>Provides address (<code class="docutils literal notranslate"><span class="pre">pcie_cii_addr</span></code>) and type (<code class="docutils literal notranslate"><span class="pre">pcie_cii_type</span></code>)</p></li>
<li><p>Type 0x04 indicates configuration write</p></li>
</ul>
</li>
<li><p><strong>Filtering</strong></p>
<ul class="simple">
<li><p>Only track first 128 bytes (addr &lt; 0x80)</p></li>
<li><p>Covers standard PCIe config space registers</p></li>
<li><p>Calculate register index: <code class="docutils literal notranslate"><span class="pre">addr[6:2]</span></code> (32-bit aligned)</p></li>
</ul>
</li>
<li><p><strong>State Update</strong></p>
<ul class="simple">
<li><p>Set corresponding bit in 32-bit <code class="docutils literal notranslate"><span class="pre">cfg_modified_</span></code> bitmask</p></li>
<li><p>Assert <code class="docutils literal notranslate"><span class="pre">config_update</span></code> output signal (sticky)</p></li>
<li><p>Interrupt remains asserted until software clears</p></li>
</ul>
</li>
<li><p><strong>Software Clear</strong> (RW1C - Read/Write 1 to Clear)</p>
<ul class="simple">
<li><p>SMN reads <code class="docutils literal notranslate"><span class="pre">CFG_MODIFIED</span></code> register to see which registers changed</p></li>
<li><p>SMN writes 1s to clear specific bits</p></li>
<li><p>When all bits cleared, <code class="docutils literal notranslate"><span class="pre">config_update</span></code> deasserts</p></li>
</ul>
</li>
<li><p><strong>Reset Behavior</strong></p>
<ul class="simple">
<li><p>Controller reset (<code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n=0</span></code>) clears all state</p></li>
<li><p>Both <code class="docutils literal notranslate"><span class="pre">cfg_modified_</span></code> and <code class="docutils literal notranslate"><span class="pre">config_update</span></code> reset to 0</p></li>
</ul>
</li>
</ol>
</section>
<section id="isolation-and-recovery">
<h3>3.8 Isolation and Recovery<a class="headerlink" href="#isolation-and-recovery" title="Permalink to this heading"></a></h3>
<p><strong>Isolation Sequence:</strong></p>
<div class="mermaid">
            sequenceDiagram
    participant EXT as External Control
    participant Tile as PCIe Tile
    participant CFG as Config Registers
    participant Switch as NOC-PCIE Switch
    participant PCIE as PCIe Controller

    Note over Tile: Normal Operation
    EXT-&gt;&gt;Tile: Assert isolate_req signal
    
    Note over Tile: signal_update_process()
    Tile-&gt;&gt;CFG: set_isolate_req(true)
    CFG-&gt;&gt;CFG: system_ready = 0
    CFG-&gt;&gt;CFG: pcie_inbound_app_enable = 0
    CFG-&gt;&gt;CFG: pcie_outbound_app_enable = 0
    CFG-&gt;&gt;Switch: Update enable signals
    
    Note over Switch: All PCIe transactions blocked
    PCIE-&gt;&gt;Switch: b_transport(addr)
    Switch-&gt;&gt;PCIE: TLM_ADDRESS_ERROR_RESPONSE
    
    Note over Tile: Attempt Recovery
    EXT-&gt;&gt;Tile: Deassert isolate_req signal
    Tile-&gt;&gt;CFG: set_isolate_req(false)
    CFG-&gt;&gt;CFG: isolate_req_ = 0
    Note over CFG: Enables NOT restored
    
    Note over Switch: Still blocked (limitation)
    PCIE-&gt;&gt;Switch: b_transport(addr)
    Switch-&gt;&gt;PCIE: TLM_ADDRESS_ERROR_RESPONSE
    
    Note over Tile: Full Recovery Sequence
    EXT-&gt;&gt;Tile: Cold reset cycle
    Note over Tile: Reset does NOT restore enables
    EXT-&gt;&gt;CFG: SMN write system_ready=1
    EXT-&gt;&gt;CFG: SMN write pcie_inbound_app_enable=1
    EXT-&gt;&gt;CFG: SMN write pcie_outbound_app_enable=1
    Note over Switch: Normal operation restored
        </div><p><strong>Isolation Behavior:</strong></p>
<ul class="simple">
<li><p><strong>Trigger</strong>: <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> signal assertion</p></li>
<li><p><strong>Effect</strong>: Clears all enable flags in <code class="docutils literal notranslate"><span class="pre">ConfigRegBlock</span></code></p></li>
<li><p><strong>Data Path</strong>: All PCIe traffic returns DECERR</p></li>
<li><p><strong>Critical Limitation</strong>: <code class="docutils literal notranslate"><span class="pre">set_isolate_req(false)</span></code> does NOT restore enables</p></li>
<li><p><strong>Recovery Requires</strong>: Cold reset + full SMN reconfiguration</p></li>
</ul>
<p>This is a known architectural limitation documented in the test plan.</p>
</section>
<section id="error-handling">
<h3>3.9 Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this heading"></a></h3>
<p><strong>Error Conditions and Responses:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Condition</p></th>
<th class="head"><p>Detection Point</p></th>
<th class="head"><p>Response</p></th>
<th class="head"><p>Recovery</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Invalid TLB Entry</strong></p></td>
<td><p>TLB translate</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Configure valid TLB entry</p></td>
</tr>
<tr class="row-odd"><td><p><strong>System Not Ready</strong></p></td>
<td><p>NOC-PCIE Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Write <code class="docutils literal notranslate"><span class="pre">system_ready=1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Inbound Path Disabled</strong></p></td>
<td><p>NOC-PCIE Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Write <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable=1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Outbound Path Disabled</strong></p></td>
<td><p>NOC-PCIE Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Write <code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable=1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>BME Blocked (EP, BME=0, memory TLP)</strong></p></td>
<td><p>NOC-PCIE Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Set BME=1 or use exempt TLP type (Config/DBI/Message)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Unknown Route</strong></p></td>
<td><p>NOC-PCIE Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Use valid route (0x0,0x1,0x4,0x6,0x7,0xE,0xF)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Unmapped SMN Address</strong></p></td>
<td><p>SMN-IO Switch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_ADDRESS_ERROR_RESPONSE</span></code></p></td>
<td><p>Use valid SMN address range</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Bad TLM Command</strong></p></td>
<td><p>Switch routing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TLM_COMMAND_ERROR_RESPONSE</span></code></p></td>
<td><p>Use READ or WRITE command</p></td>
</tr>
<tr class="row-even"><td><p><strong>Isolation Active</strong></p></td>
<td><p>Config Registers</p></td>
<td><p>All paths blocked</p></td>
<td><p>Full recovery sequence required</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Page Boundary Cross</strong></p></td>
<td><p>TLB indexing</p></td>
<td><p>May access invalid entry</p></td>
<td><p>Align transactions to page boundaries</p></td>
</tr>
</tbody>
</table>
<p><strong>Error Response Flow:</strong></p>
<p>All error responses propagate back through the transaction chain:</p>
<ul class="simple">
<li><p>Switch/TLB detects error</p></li>
<li><p>Sets <code class="docutils literal notranslate"><span class="pre">trans.set_response_status(TLM_ADDRESS_ERROR_RESPONSE)</span></code> or <code class="docutils literal notranslate"><span class="pre">TLM_COMMAND_ERROR_RESPONSE</span></code></p></li>
<li><p>Returns to initiator</p></li>
<li><p>No retry mechanism (single-shot transactions)</p></li>
<li><p>Software must detect and handle errors</p></li>
</ul>
</section>
<section id="operating-mode-summary">
<h3>3.10 Operating Mode Summary<a class="headerlink" href="#operating-mode-summary" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>system_ready</p></th>
<th class="head"><p>inbound_enable</p></th>
<th class="head"><p>outbound_enable</p></th>
<th class="head"><p>isolate_req</p></th>
<th class="head"><p>Data Flow</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Normal</strong></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>Full bidirectional</p></td>
<td><p>Standard operation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>System Only</strong></p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>System paths only</p></td>
<td><p>Pre-application init</p></td>
</tr>
<tr class="row-even"><td><p><strong>Inbound Only</strong></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>PCIe→NOC only</p></td>
<td><p>Receive-only mode</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Outbound Only</strong></p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>NOC→PCIe only</p></td>
<td><p>Transmit-only mode</p></td>
</tr>
<tr class="row-even"><td><p><strong>Bypass</strong></p></td>
<td><p>0</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p>0</p></td>
<td><p>Status register only</p></td>
<td><p>Pre-init diagnostics</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Isolated</strong></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>All blocked</p></td>
<td><p>Fault containment</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reset</strong></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>All blocked</p></td>
<td><p>Coming out of reset</p></td>
</tr>
</tbody>
</table>
<p><strong>Mode Transitions:</strong></p>
<ul class="simple">
<li><p><strong>Reset → Normal</strong>: Requires software configuration sequence</p></li>
<li><p><strong>Normal → Isolated</strong>: Automatic on <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> assertion</p></li>
<li><p><strong>Isolated → Normal</strong>: Requires full recovery (reset + reconfig)</p></li>
<li><p><strong>Normal ↔ System Only</strong>: Software enable/disable of application paths</p></li>
<li><p><strong>Any → Reset</strong>: Hardware signal (<code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code>, <code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code>)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="detailed-block-diagram">
<h2>4. Detailed Block Diagram<a class="headerlink" href="#detailed-block-diagram" title="Permalink to this heading"></a></h2>
<section id="complete-system-architecture">
<h3>3.1 Complete System Architecture<a class="headerlink" href="#complete-system-architecture" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            graph TB
    subgraph &quot;NOC Domain&quot;
        NOCN[NOC Network]
    end
    
    subgraph &quot;SMN Domain&quot;
        SMNN[SMN Network]
    end
    
    subgraph &quot;PCIe Domain&quot;
        PCTRL[PCIe Controller]
    end
    
    subgraph &quot;Keraunos PCIe Tile&quot;
        subgraph &quot;NOC-PCIE Switch&quot;
            NOCP1[Route Decoder&lt;br/&gt;bits 63:60]
            NOCP2[Status Register&lt;br/&gt;routes 0xE/0xF]
            NOCP3[Isolation Gate]
        end
        
        subgraph &quot;Inbound TLBs&quot;
            TLBS[TLB Sys In0&lt;br/&gt;16KB pages]
            TLBA0[TLB App In0 instances 0-3&lt;br/&gt;16MB pages]
            TLBA1[TLB App In1&lt;br/&gt;8GB pages]
        end
        
        subgraph &quot;Outbound TLBs&quot;
            TLBSO[TLB Sys Out0&lt;br/&gt;64KB pages]
            TLBAO0[TLB App Out0&lt;br/&gt;16MB pages]
            TLBAO1[TLB App Out1&lt;br/&gt;8GB pages]
        end
        
        subgraph &quot;NOC-IO Switch&quot;
            NOCI1[NOC Output]
            NOCI2[MSI Input Route]
            NOCI3[TLB App Out Route]
        end
        
        subgraph &quot;SMN-IO Switch&quot;
            SMNI1[Config Router&lt;br/&gt;0x18xxxxxx]
            SMNI2[TLB Config&lt;br/&gt;8 instances]
            SMNI3[Sys TLB Bypass]
        end
        
        subgraph &quot;Control &amp; Status&quot;
            CFG1[Config Registers&lt;br/&gt;0x18000000]
            SII1[SII Block&lt;br/&gt;0x18101000&lt;br/&gt;CII Tracking]
            MSI1[MSI Relay&lt;br/&gt;0x18800000&lt;br/&gt;16 vectors]
            PHY1[PCIe PHY&lt;br/&gt;0x18102000/3000]
        end
        
        subgraph &quot;Clock/Reset&quot;
            CLK1[Cold Reset]
            CLK2[Warm Reset]
            CLK3[Isolation Control]
        end
    end
    
    NOCN &lt;--&gt;|noc_n_target&lt;br/&gt;noc_n_initiator| NOCI1
    SMNN &lt;--&gt;|smn_n_target&lt;br/&gt;smn_n_initiator| SMNI1
    PCTRL &lt;--&gt;|pcie_controller_target&lt;br/&gt;pcie_controller_initiator| NOCP1
    
    NOCP1 --&gt; TLBS
    NOCP1 --&gt; TLBA0
    NOCP1 --&gt; TLBA1
    TLBS --&gt; NOCI1
    TLBA0 --&gt; NOCI1
    TLBA1 --&gt; NOCI1
    
    NOCI1 --&gt; TLBSO
    NOCI1 --&gt; TLBAO0
    NOCI1 --&gt; TLBAO1
    TLBSO --&gt; NOCP1
    TLBAO0 --&gt; NOCP1
    TLBAO1 --&gt; NOCP1
    
    NOCI2 --&gt; MSI1
    MSI1 --&gt; NOCP1
    
    SMNI1 --&gt; CFG1
    SMNI1 --&gt; SII1
    SMNI1 --&gt; MSI1
    SMNI1 --&gt; SMNI2
    SMNI2 -.-&gt;|Config| TLBS
    SMNI2 -.-&gt;|Config| TLBA0
    SMNI2 -.-&gt;|Config| TLBA1
    SMNI2 -.-&gt;|Config| TLBSO
    SMNI2 -.-&gt;|Config| TLBAO0
    SMNI2 -.-&gt;|Config| TLBAO1
    SMNI1 --&gt; PHY1
    
    PCTRL -.-&gt;|CII signals| SII1
    
    CLK1 -.-&gt;|Control| NOCP3
    CLK2 -.-&gt;|Control| CFG1
    CLK3 -.-&gt;|Control| NOCP3
    
    style NOCP1 fill:#e1f5ff
    style NOCI1 fill:#e1f5ff
    style SMNI1 fill:#e1f5ff
    style TLBS fill:#fff4e1
    style TLBA0 fill:#fff4e1
    style TLBA1 fill:#fff4e1
    style TLBSO fill:#fff4e1
    style TLBAO0 fill:#fff4e1
    style TLBAO1 fill:#fff4e1
    style MSI1 fill:#ffe1f5
    style SII1 fill:#ffe1f5
    style CFG1 fill:#e1ffe1
    style CLK1 fill:#f5e1e1
    style CLK2 fill:#f5e1e1
    style CLK3 fill:#f5e1e1
        </div></section>
</section>
<hr class="docutils" />
<section id="data-flow-paths">
<h2>5. Data Flow Paths<a class="headerlink" href="#data-flow-paths" title="Permalink to this heading"></a></h2>
<section id="inbound-data-flow-pcie-noc">
<h3>4.1 Inbound Data Flow (PCIe → NOC)<a class="headerlink" href="#inbound-data-flow-pcie-noc" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant PC as PCIe Controller
    participant NPS as NOC-PCIE Switch
    participant TLB as Inbound TLB
    participant NIS as NOC-IO Switch
    participant NOC as NOC Network
    
    PC-&gt;&gt;NPS: Write(addr=0x1xxx, data)
    Note over NPS: Route decode: bits[63:60]=0x1
    NPS-&gt;&gt;NPS: Check isolation/enables
    NPS-&gt;&gt;TLB: TLB App In1
    Note over TLB: Index = (addr&gt;&gt;33) &amp; 0x3F = 0
    Note over TLB: Valid check: entry[0].valid = true
    TLB-&gt;&gt;TLB: Translate address
    Note over TLB: translated = (entry[0].addr&lt;&lt;12) | offset
    TLB-&gt;&gt;NIS: Forward with translated addr
    NIS-&gt;&gt;NOC: Route via noc_n_initiator socket
    Note over NOC: Forwarded to sparse_backing_memory&lt;br/&gt;for cross-socket data verification
    NOC--&gt;&gt;NIS: TLM_OK_RESPONSE
    NIS--&gt;&gt;TLB: Response
    TLB--&gt;&gt;NPS: Response
    NPS--&gt;&gt;PC: TLM_OK_RESPONSE
        </div></section>
<section id="outbound-data-flow-noc-pcie">
<h3>4.2 Outbound Data Flow (NOC → PCIe)<a class="headerlink" href="#outbound-data-flow-noc-pcie" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant NOC as NOC Network
    participant NIS as NOC-IO Switch
    participant TLB as Outbound TLB
    participant NPS as NOC-PCIE Switch
    participant PC as PCIe Controller
    
    NOC-&gt;&gt;NIS: Read(addr=0x10001xxx)
    Note over NIS: Route to TLB App Out0
    NIS-&gt;&gt;TLB: Forward transaction
    Note over TLB: Index = (addr&gt;&gt;24) &amp; 0x3F
    TLB-&gt;&gt;TLB: Translate address
    Note over TLB: Check entry valid, translate
    TLB-&gt;&gt;NPS: Forward to PCIe
    NPS-&gt;&gt;PC: TLM transaction via initiator socket
    Note over PC: Forwarded to sparse_backing_memory&lt;br/&gt;for cross-socket data verification
    PC--&gt;&gt;NPS: Data response
    NPS--&gt;&gt;TLB: Response
    TLB--&gt;&gt;NIS: Response
    NIS--&gt;&gt;NOC: TLM_OK_RESPONSE + data
        </div></section>
<section id="configuration-access-flow-smn-config">
<h3>4.3 Configuration Access Flow (SMN → Config)<a class="headerlink" href="#configuration-access-flow-smn-config" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant SMN as SMN Network
    participant SIS as SMN-IO Switch
    participant CFG as Config Target
    
    SMN-&gt;&gt;SIS: Write(addr=0x18101004, data)
    Note over SIS: Route decode: base check
    alt Address = 0x18000000-0x18000FFF
        SIS-&gt;&gt;CFG: Config Reg Block
        Note over CFG: System control registers
    else Address = 0x18101000-0x1811xxxx
        SIS-&gt;&gt;CFG: SII Config (APB)
        Note over CFG: CII config registers
    else Address = 0x18200000-0x182Fxxxx
        SIS-&gt;&gt;CFG: TLB Config (8 instances)
        Note over CFG: TLB entry configuration
    else Address = 0x18800000-0x18800FFF
        SIS-&gt;&gt;CFG: MSI Relay Config
        Note over CFG: MSI-X table, PBA, mask
    end
    
    CFG--&gt;&gt;SIS: Response (may be DECERR)
    Note over CFG: TLB config via SMN&lt;br/&gt;works correctly
    SIS--&gt;&gt;SMN: Response
        </div></section>
<section id="msi-generation-flow">
<h3>4.4 MSI Generation Flow<a class="headerlink" href="#msi-generation-flow" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant NOC as NOC Network
    participant NIS as NOC-IO Switch
    participant MSI as MSI Relay
    participant NPS as NOC-PCIE Switch
    participant PC as PCIe Controller
    
    NOC-&gt;&gt;NIS: Write(addr=0x18800000, data=vector)
    Note over NIS: Detect MSI input address
    NIS-&gt;&gt;MSI: process_msi_input()
    Note over MSI: Check: msix_enable &amp;&amp;&lt;br/&gt;!global_mask &amp;&amp;&lt;br/&gt;!vector_mask[vector]
    
    alt MSI enabled and unmasked
        MSI-&gt;&gt;MSI: Read MSI-X table[vector]
        Note over MSI: Get address, data from table
        MSI-&gt;&gt;MSI: Increment outstanding counter
        MSI-&gt;&gt;NPS: Generate MSI transaction
        NPS-&gt;&gt;PC: MSI write(table_addr, table_data)
        PC--&gt;&gt;NPS: MSI delivered
        NPS--&gt;&gt;MSI: Complete
        MSI-&gt;&gt;MSI: Decrement outstanding
    else MSI masked or disabled
        Note over MSI: PBA bit set for later delivery
    end
    
    MSI--&gt;&gt;NIS: TLM_OK_RESPONSE
    NIS--&gt;&gt;NOC: Complete
        </div></section>
<section id="cii-interrupt-flow">
<h3>4.5 CII Interrupt Flow<a class="headerlink" href="#cii-interrupt-flow" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant PC as PCIe Controller
    participant CII as CII Signals
    participant SII as SII Block
    participant INT as Interrupt Output
    
    Note over PC: Host writes to&lt;br/&gt;PCIe config space
    PC-&gt;&gt;CII: pcie_cii_hv = true
    PC-&gt;&gt;CII: pcie_cii_hdr_type = 0x04
    PC-&gt;&gt;CII: pcie_cii_hdr_addr = 0x010
    
    Note over CII: Signal propagation&lt;br/&gt;wait(SC_ZERO_TIME)
    
    CII-&gt;&gt;SII: signal_update_process()
    Note over SII: SiiBlock::update() called
    
    SII-&gt;&gt;SII: CII Tracking Phase
    Note over SII: Check: hv &amp;&amp; type==0x04 &amp;&amp;&lt;br/&gt;addr&lt;0x080
    SII-&gt;&gt;SII: reg_index = addr &gt;&gt; 2 = 4
    SII-&gt;&gt;SII: cii_new_bits = (1 &lt;&lt; 4)
    
    SII-&gt;&gt;SII: cfg_modified Update
    Note over SII: cfg_modified |= cii_new_bits
    
    SII-&gt;&gt;SII: Interrupt Generation
    Note over SII: config_int = (cfg_modified != 0)
    
    SII-&gt;&gt;INT: config_update = true
    Note over INT: Interrupt asserted
    
    Note over PC: Later: reset pulse or RW1C
    PC-&gt;&gt;SII: pcie_controller_reset_n = 0→1
    SII-&gt;&gt;SII: Clear cfg_modified
    SII-&gt;&gt;INT: config_update = false
        </div></section>
</section>
<hr class="docutils" />
<section id="module-descriptions">
<h2>6. Module Descriptions<a class="headerlink" href="#module-descriptions" title="Permalink to this heading"></a></h2>
<section id="noc-pcie-switch">
<h3>5.1 NOC-PCIE Switch<a class="headerlink" href="#noc-pcie-switch" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Routes traffic from PCIe controller to appropriate destination (TLBs, bypass paths, status register). On the outbound path (NOC→PCIe), applies <strong>Bus Master Enable (BME)</strong> qualification per specification Table 33.</p>
<p><strong>BME Logic (Outbound Path):</strong></p>
<ul class="simple">
<li><p><strong>Controller mode</strong> comes from SII CORE_CONTROL device_type (EP vs RP). When the SII register is written via SMN (APB), a <strong>device_type callback</strong> notifies the tile immediately so <code class="docutils literal notranslate"><span class="pre">controller_is_ep_</span></code> in the switch is updated without waiting for the next signal delta cycle.</p></li>
<li><p><strong>BME state</strong> is set by the testbench or integration via <code class="docutils literal notranslate"><span class="pre">set_bus_master_enable(bool)</span></code>; in real hardware this reflects the PCIe controller Command Register bit 2.</p></li>
<li><p><strong>EP mode, BME=0:</strong> Memory TLPs are blocked (DECERR). Config, DBI, and Message TLPs are exempt and allowed. Exemption is derived from AxUSER (TLP type and DBI bit) passed from outbound TLBs.</p></li>
<li><p><strong>EP mode, BME=1:</strong> All TLPs allowed.</p></li>
<li><p><strong>RP mode:</strong> BME is not checked; all outbound TLPs allowed regardless of BME.</p></li>
<li><p><strong>Cold reset:</strong> The tile’s <code class="docutils literal notranslate"><span class="pre">signal_update_process</span></code> restores <code class="docutils literal notranslate"><span class="pre">bus_master_enable_</span></code> to true when <code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code> is low, so each test starts with a defined state.</p></li>
</ul>
<p><strong>Route Table:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Route [63:60]</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>TLB App In0 [0]</p></td>
<td><p>Application TLB instance 0</p></td>
</tr>
<tr class="row-odd"><td><p>0x1</p></td>
<td><p>TLB App In1</p></td>
<td><p>Application TLB (large pages)</p></td>
</tr>
<tr class="row-even"><td><p>0x4</p></td>
<td><p>TLB Sys In0</p></td>
<td><p>System TLB</p></td>
</tr>
<tr class="row-odd"><td><p>0x8</p></td>
<td><p>Bypass App</p></td>
<td><p>Direct to NOC-IO</p></td>
</tr>
<tr class="row-even"><td><p>0x9</p></td>
<td><p>Bypass Sys</p></td>
<td><p>Direct to SMN-IO</p></td>
</tr>
<tr class="row-odd"><td><p>0xE, 0xF</p></td>
<td><p>Status Register</p></td>
<td><p>Read-only status (if system_ready)</p></td>
</tr>
<tr class="row-even"><td><p>Other</p></td>
<td><p>DECERR</p></td>
<td><p>TLM_ADDRESS_ERROR_RESPONSE</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Register Format:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="n">system_ready</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="n">pcie_outbound_app_enable</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="n">pcie_inbound_app_enable</span>
<span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="n">Reserved</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="translation-lookaside-buffers">
<h3>5.2 Translation Lookaside Buffers<a class="headerlink" href="#translation-lookaside-buffers" title="Permalink to this heading"></a></h3>
<p><strong>TLB Configuration:</strong></p>
<div class="mermaid">
            graph LR
    subgraph &quot;Inbound TLBs - 5 instances&quot;
        TLBS[TLB Sys In0&lt;br/&gt;16KB pages&lt;br/&gt;shift=14, index 19:14]
        TLBA0[TLB App In0 instances 0-3&lt;br/&gt;16MB pages&lt;br/&gt;shift=24, index 29:24]
        TLBA1[TLB App In1&lt;br/&gt;8GB pages&lt;br/&gt;shift=33, index 38:33]
    end
    
    subgraph &quot;Outbound TLBs - 3 instances&quot;
        TLBSO[TLB Sys Out0&lt;br/&gt;64KB pages, 16 entries&lt;br/&gt;shift=16, index 19:16]
        TLBAO[TLB App Out0&lt;br/&gt;16TB pages, 16 entries&lt;br/&gt;shift=44, index 47:44]
        TLBAO1[TLB App Out1&lt;br/&gt;64KB pages, 16 entries&lt;br/&gt;shift=16, index 19:16]
    end
    
    subgraph &quot;TLB Entry Structure&quot;
        ENT[valid: 1 bit&lt;br/&gt;addr: 52 bits 63:12&lt;br/&gt;attr: 32 bits AxUSER]
    end
    
    style TLBS fill:#fff4e1
    style TLBA0 fill:#fff4e1
    style TLBA1 fill:#fff4e1
    style TLBSO fill:#fff4e1
    style TLBAO fill:#fff4e1
    style TLBAO1 fill:#fff4e1
    style ENT fill:#e1ffe1
        </div><p><strong>Translation Algorithm (corrected):</strong></p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">=</span> <span class="pre">(address</span> <span class="pre">&gt;&gt;</span> <span class="pre">page_shift)</span> <span class="pre">&amp;</span> <span class="pre">mask</span></code> (mask 0x3F for 64-entry TLBs, 0xF for 16-entry).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">index</span></code> out of range or <code class="docutils literal notranslate"><span class="pre">!entries[index].valid</span></code> → DECERR.</p></li>
<li><p><strong>Page-mask translation:</strong> <code class="docutils literal notranslate"><span class="pre">page_mask</span> <span class="pre">=</span> <span class="pre">(1ULL</span> <span class="pre">&lt;&lt;</span> <span class="pre">page_shift)</span> <span class="pre">-</span> <span class="pre">1</span></code>;<br />
<code class="docutils literal notranslate"><span class="pre">translated_addr</span> <span class="pre">=</span> <span class="pre">((entry.addr</span> <span class="pre">&lt;&lt;</span> <span class="pre">12)</span> <span class="pre">&amp;</span> <span class="pre">~page_mask)</span> <span class="pre">|</span> <span class="pre">(input_addr</span> <span class="pre">&amp;</span> <span class="pre">page_mask)</span></code>.<br />
The base (entry.addr &lt;&lt; 12) is masked to page alignment; the offset comes from the input address within the page. This ensures correct translation for each TLB’s page size (e.g. 16KB Sys In0, 64KB Sys Out0, 16TB App Out0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axuser</span></code> / <code class="docutils literal notranslate"><span class="pre">attr</span></code> from <code class="docutils literal notranslate"><span class="pre">entries[index].attr</span></code>.</p></li>
</ol>
<p><strong>TLB Sys In0 / Sys Out0 usage:</strong></p>
<ul class="simple">
<li><p><strong>TLB Sys In0</strong> (route 0x4): System inbound; translates PCIe → SMN. Output goes to SMN-IO → SMN-N. Per specification it can also be used for addresses bound for NoC; in this implementation it is wired to the system path (SMN). Lookup is <strong>not</strong> gated by system_ready (only bypass paths 0x8/0x9 are).</p></li>
<li><p><strong>TLB Sys Out0</strong>: System outbound; SMN-N → PCIe (SMC/DBI). 16 entries, 64KB pages.</p></li>
</ul>
</section>
<section id="msi-relay-unit">
<h3>5.3 MSI Relay Unit<a class="headerlink" href="#msi-relay-unit" title="Permalink to this heading"></a></h3>
<p><strong>Architecture:</strong></p>
<div class="mermaid">
            graph TB
    subgraph &quot;MSI Relay Components&quot;
        TBL[MSI-X Table&lt;br/&gt;16 entries&lt;br/&gt;address, data, mask]
        PBA[Pending Bit Array&lt;br/&gt;16 bits&lt;br/&gt;read-only]
        CTL[Control&lt;br/&gt;msix_enable&lt;br/&gt;msix_mask&lt;br/&gt;outstanding counter]
    end
    
    subgraph &quot;Inputs&quot;
        NOCI[NOC-IO Switch&lt;br/&gt;MSI input &#64; 0x18800000]
        SMNI[SMN-IO Switch&lt;br/&gt;Config &#64; 0x18800000]
    end
    
    subgraph &quot;Output&quot;
        NOCP[NOC-PCIE Switch&lt;br/&gt;MSI to PCIe]
    end
    
    NOCI --&gt;|process_msi_input| CTL
    SMNI -.-&gt;|config access&lt;br/&gt;via SMN| TBL
    CTL --&gt; TBL
    CTL --&gt; PBA
    TBL --&gt;|MSI generation| NOCP
    
    style TBL fill:#ffe1f5
    style PBA fill:#ffe1f5
    style CTL fill:#ffe1f5
        </div><p><strong>MSI-X Table Entry (16 bytes):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>   <span class="n">Message</span> <span class="n">Address</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span>
<span class="p">[</span><span class="mi">95</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>  <span class="n">Message</span> <span class="n">Data</span> <span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span>
<span class="p">[</span><span class="mi">96</span><span class="p">]</span>     <span class="n">Per</span><span class="o">-</span><span class="n">Vector</span> <span class="n">Mask</span> <span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
<span class="p">[</span><span class="mi">127</span><span class="p">:</span><span class="mi">97</span><span class="p">]</span> <span class="n">Reserved</span>
</pre></div>
</div>
</section>
<section id="system-information-interface-sii">
<h3>5.4 System Information Interface (SII)<a class="headerlink" href="#system-information-interface-sii" title="Permalink to this heading"></a></h3>
<p><strong>CII Tracking State Machine:</strong></p>
<div class="mermaid">
            stateDiagram-v2
    [*] --&gt; Idle: Reset
    
    Idle --&gt; WaitCII: Normal operation
    WaitCII --&gt; DetectWrite: CII handshake valid
    
    DetectWrite --&gt; CheckType: Read CII header
    CheckType --&gt; CheckAddr: Config write detected
    CheckType --&gt; WaitCII: Not config write
    
    CheckAddr --&gt; SetBit: First 128B of config space
    CheckAddr --&gt; WaitCII: Beyond 128B boundary
    
    SetBit --&gt; AssertInt: Set modified bit
    AssertInt --&gt; WaitCII: Assert interrupt
    
    WaitCII --&gt; ClearInt: Controller reset
    ClearInt --&gt; Idle: Clear all state
    
    note right of SetBit: Tracks 32 config registers
    note right of AssertInt: Sticky until reset or RW1C
        </div><p><strong>APB Registers:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Register</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0000</p></td>
<td><p>CORE_CONTROL</p></td>
<td><p>RW</p></td>
<td><p>Device type [2:0]: 0x4=RP</p></td>
</tr>
<tr class="row-odd"><td><p>0x0004</p></td>
<td><p>CFG_MODIFIED</p></td>
<td><p>RW1C</p></td>
<td><p>Config modified bitmask (32 bits)</p></td>
</tr>
<tr class="row-even"><td><p>0x0008</p></td>
<td><p>BUS_DEV_NUM</p></td>
<td><p>RW</p></td>
<td><p>Bus[15:8], Device[7:0] numbers</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="address-map">
<h2>7. Address Map<a class="headerlink" href="#address-map" title="Permalink to this heading"></a></h2>
<section id="inbound-address-routing">
<h3>6.1 Inbound Address Routing<a class="headerlink" href="#inbound-address-routing" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            graph TD
    START[PCIe Transaction&lt;br/&gt;addr 63:0]
    
    START --&gt; ROUTE{Route bits&lt;br/&gt;63:60}
    
    ROUTE --&gt;|0x0| TLB0[TLB App In0 inst 0&lt;br/&gt;16MB pages]
    ROUTE --&gt;|0x1| TLB1[TLB App In1&lt;br/&gt;8GB pages]
    ROUTE --&gt;|0x4| TLB4[TLB Sys In0&lt;br/&gt;16KB pages]
    ROUTE --&gt;|0x8| BP8[Bypass App&lt;br/&gt;NOC-IO direct]
    ROUTE --&gt;|0x9| BP9[Bypass Sys&lt;br/&gt;SMN-IO direct]
    ROUTE --&gt;|0xE,0xF| STAT[Status Register&lt;br/&gt;Read-only]
    ROUTE --&gt;|Other| ERR[DECERR&lt;br/&gt;TLM_ADDRESS_ERROR]
    
    TLB0 --&gt; NOC[NOC Network]
    TLB1 --&gt; NOC
    TLB4 --&gt; NOC
    BP8 --&gt; NOC
    BP9 --&gt; SMN[SMN Network]
    STAT --&gt; RET[Return status word]
    
    style TLB0 fill:#fff4e1
    style TLB1 fill:#fff4e1
    style TLB4 fill:#fff4e1
    style BP8 fill:#e1f5ff
    style BP9 fill:#e1f5ff
    style STAT fill:#e1ffe1
    style ERR fill:#ffe1e1
        </div></section>
<section id="configuration-address-map">
<h3>6.2 Configuration Address Map<a class="headerlink" href="#configuration-address-map" title="Permalink to this heading"></a></h3>
<p><strong>SMN Configuration Space (base 0x18000000):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Base Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Module</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x18000000</p></td>
<td><p>4KB</p></td>
<td><p>Config Reg Block</p></td>
<td><p>System control, enables</p></td>
</tr>
<tr class="row-odd"><td><p>0x18101000</p></td>
<td><p>64KB</p></td>
<td><p>SII APB</p></td>
<td><p>Device type, CFG_MODIFIED, bus/dev</p></td>
</tr>
<tr class="row-even"><td><p>0x18102000</p></td>
<td><p>4KB</p></td>
<td><p>PCIe PHY APB</p></td>
<td><p>PHY APB registers</p></td>
</tr>
<tr class="row-odd"><td><p>0x18103000</p></td>
<td><p>4KB</p></td>
<td><p>PCIe PHY AHB</p></td>
<td><p>PHY AHB registers</p></td>
</tr>
<tr class="row-even"><td><p>0x18200000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys In0</p></td>
<td><p>TLB entry config (64×16B)</p></td>
</tr>
<tr class="row-odd"><td><p>0x18210000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [0]</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18220000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [1]</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18230000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [2]</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18240000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [3]</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18250000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In1</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18260000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys Out0</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18270000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out0</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18280000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out1</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18800000</p></td>
<td><p>4KB</p></td>
<td><p>MSI Relay</p></td>
<td><p>MSI-X table, PBA, mask</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="clock-and-reset-strategy">
<h2>8. Clock and Reset Strategy<a class="headerlink" href="#clock-and-reset-strategy" title="Permalink to this heading"></a></h2>
<section id="reset-hierarchy">
<h3>7.1 Reset Hierarchy<a class="headerlink" href="#reset-hierarchy" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            graph TD
    subgraph &quot;Reset Sources&quot;
        COLD[cold_reset_n&lt;br/&gt;Top-level reset]
        WARM[warm_reset_n&lt;br/&gt;Warm reset]
        PCIER[pcie_controller_reset_n&lt;br/&gt;PCIe-specific]
        ISOL[isolate_req&lt;br/&gt;Isolation control]
    end
    
    subgraph &quot;Reset Targets&quot;
        CLK[Clock/Reset Control&lt;br/&gt;pcie_sii_reset_ctrl&lt;br/&gt;pcie_reset_ctrl]
        SII[SII Block&lt;br/&gt;cfg_modified&lt;br/&gt;config_update]
        CFG[Config Registers&lt;br/&gt;system_ready&lt;br/&gt;enables]
    end
    
    COLD --&gt; CLK
    WARM --&gt; CLK
    PCIER --&gt; SII
    ISOL --&gt; CFG
    
    style COLD fill:#f5e1e1
    style WARM fill:#f5e1e1
    style PCIER fill:#f5e1e1
    style ISOL fill:#fff4e1
    style CLK fill:#e1ffe1
    style SII fill:#ffe1f5
    style CFG fill:#e1ffe1
        </div></section>
<section id="reset-effects">
<h3>7.2 Reset Effects<a class="headerlink" href="#reset-effects" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reset Signal</p></th>
<th class="head"><p>Affects</p></th>
<th class="head"><p>Preserves</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>Clock/Reset control registers</p></td>
<td><p>Config, TLBs, enables, system_ready</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>Same as cold reset</p></td>
<td><p>Same as cold reset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>SII cfg_modified, config_update</p></td>
<td><p>All other state</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>Clears all enable flags</p></td>
<td><p>TLB config, register values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="isolation-sequence">
<h3>7.3 Isolation Sequence<a class="headerlink" href="#isolation-sequence" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            sequenceDiagram
    participant EXT as External Control
    participant CFG as Config Reg Block
    participant SW as NOC-PCIE Switch
    
    Note over CFG: Initial State:&lt;br/&gt;system_ready=1&lt;br/&gt;inbound_enable=1&lt;br/&gt;outbound_enable=1
    
    EXT-&gt;&gt;CFG: isolate_req = 1
    Note over CFG: wait(SC_ZERO_TIME)
    CFG-&gt;&gt;CFG: system_ready = 0
    CFG-&gt;&gt;CFG: inbound_enable = 0
    CFG-&gt;&gt;CFG: outbound_enable = 0
    CFG-&gt;&gt;SW: Update enables
    Note over SW: All PCIe traffic → DECERR
    
    Note over EXT: Later: attempt recovery
    EXT-&gt;&gt;CFG: isolate_req = 0
    Note over CFG: wait(SC_ZERO_TIME)
    Note over CFG: Enables NOT restored!&lt;br/&gt;Permanent state loss
    
    Note over SW: Traffic still blocked&lt;br/&gt;No recovery mechanism
        </div></section>
</section>
<hr class="docutils" />
<section id="interface-specifications">
<h2>9. Interface Specifications<a class="headerlink" href="#interface-specifications" title="Permalink to this heading"></a></h2>
<section id="external-tlm-sockets">
<h3>8.1 External TLM Sockets<a class="headerlink" href="#external-tlm-sockets" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Socket Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>NOC → Tile (outbound)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → NOC (inbound), forwards to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>SMN → Tile (config)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → SMN (bypass), forwards to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>PCIe → Tile</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → PCIe, forwards to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification</p></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The three “initiator” sockets (<code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code>, <code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code>) are implemented as <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> types that forward transactions to the testbench’s <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification. This enables end-to-end data integrity checks where data written through one socket can be read back through another.</p>
</section>
<section id="control-and-status-signals">
<h3>8.2 Control and Status Signals<a class="headerlink" href="#control-and-status-signals" title="Permalink to this heading"></a></h3>
<p><strong>Input Signals:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal Name</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>1</p></td>
<td><p>Cold reset (active low)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>1</p></td>
<td><p>Warm reset (active low)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>1</p></td>
<td><p>Isolation request</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hv</span></code></p></td>
<td><p>1</p></td>
<td><p>CII header valid</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_type</span></code></p></td>
<td><p>5</p></td>
<td><p>CII header type</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_addr</span></code></p></td>
<td><p>12</p></td>
<td><p>CII header address</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code></p></td>
<td><p>1</p></td>
<td><p>PCIe core clock</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>1</p></td>
<td><p>PCIe controller reset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_flr_request</span></code></p></td>
<td><p>1</p></td>
<td><p>Function-level reset request</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_hot_reset</span></code></p></td>
<td><p>1</p></td>
<td><p>Hot reset indication</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_ras_error</span></code></p></td>
<td><p>1</p></td>
<td><p>RAS error indication</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_dma_completion</span></code></p></td>
<td><p>1</p></td>
<td><p>DMA completion</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_misc_int</span></code></p></td>
<td><p>1</p></td>
<td><p>Miscellaneous interrupt</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axi_clk</span></code></p></td>
<td><p>1</p></td>
<td><p>AXI clock</p></td>
</tr>
</tbody>
</table>
<p><strong>Output Signals:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal Name</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_bus_num</span></code></p></td>
<td><p>8</p></td>
<td><p>Application bus number</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_dev_num</span></code></p></td>
<td><p>8</p></td>
<td><p>Application device number</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_device_type</span></code></p></td>
<td><p>1</p></td>
<td><p>0=EP, 1=RP</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_sys_int</span></code></p></td>
<td><p>1</p></td>
<td><p>System interrupt</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">function_level_reset</span></code></p></td>
<td><p>1</p></td>
<td><p>FLR forwarded</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hot_reset_requested</span></code></p></td>
<td><p>1</p></td>
<td><p>Hot reset forwarded</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></td>
<td><p>1</p></td>
<td><p>Config update interrupt (CII)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ras_error</span></code></p></td>
<td><p>1</p></td>
<td><p>RAS error forwarded</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dma_completion</span></code></p></td>
<td><p>1</p></td>
<td><p>DMA completion forwarded</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controller_misc_int</span></code></p></td>
<td><p>1</p></td>
<td><p>Misc interrupt forwarded</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_timeout</span></code></p></td>
<td><p>3</p></td>
<td><p>NOC timeout status</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="known-limitations-and-findings">
<h2>10. Known Limitations and Findings<a class="headerlink" href="#known-limitations-and-findings" title="Permalink to this heading"></a></h2>
<section id="architecture-limitations">
<h3>9.1 Architecture Limitations<a class="headerlink" href="#architecture-limitations" title="Permalink to this heading"></a></h3>
<div class="mermaid">
            graph TB
    subgraph &quot;Known Issues&quot;
        ISOL[Isolation Recovery&lt;br/&gt;No restore mechanism]
    end
    
    subgraph &quot;Resolved Issues&quot;
        PASS[Address Passthrough&lt;br/&gt;RESOLVED - TLB config&lt;br/&gt;via SMN works correctly]
        MSI[MSI PBA&lt;br/&gt;RESOLVED - initiator&lt;br/&gt;sockets to backing memory]
    end
    
    subgraph &quot;Impacts&quot;
        REC[Isolation&lt;br/&gt;Single-use only]
    end
    
    subgraph &quot;Mitigations&quot;
        AVOID[Avoid Isolation&lt;br/&gt;in test env]
        BACK[sparse_backing_memory&lt;br/&gt;Cross-socket verification]
    end
    
    ISOL --&gt; REC
    
    REC -.-&gt;|Mitigation| AVOID
    PASS -.-&gt;|Fixed| BACK
    MSI -.-&gt;|Fixed| BACK
    
    style PASS fill:#e1ffe1
    style ISOL fill:#ffe1e1
    style MSI fill:#e1ffe1
    style REC fill:#fff4e1
    style AVOID fill:#e1ffe1
    style BACK fill:#e1ffe1
        </div></section>
<section id="documented-findings">
<h3>9.2 Documented Findings<a class="headerlink" href="#documented-findings" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Address Passthrough (RESOLVED):</strong> SMN-IO/NOC-IO switches now correctly route TLB configuration via SMN. TLB config writes work correctly.</p></li>
<li><p><strong>TLB Configuration (RESOLVED):</strong> TLB config writes via SMN now function correctly, enabling proper address translation setup.</p></li>
<li><p><strong>MSI Relay (RESOLVED):</strong> MSI output transactions forwarded through real initiator sockets to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification.</p></li>
<li><p><strong>Signal Propagation (RESOLVED):</strong> <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> required for signal changes to propagate.</p></li>
<li><p><strong>Isolation Recovery Impossible:</strong> <code class="docutils literal notranslate"><span class="pre">isolate_req=false</span></code> does not restore enables. This is a known architectural limitation.</p></li>
<li><p><strong>CII Processing (RESOLVED):</strong> Restored via <code class="docutils literal notranslate"><span class="pre">SiiBlock::update()</span></code> method.</p></li>
<li><p><strong>DUT Initiator Socket Architecture (NEW):</strong> All three initiator sockets (<code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code>, <code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code>) are now <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> types that forward to <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code>, enabling cross-socket data verification.</p></li>
<li><p><strong>BME and Controller Mode (IMPLEMENTED):</strong> Bus Master Enable logic in NOC-PCIE switch per Table 33; SII device_type callback propagates EP/RP mode to the switch on APB write; cold reset restores BME default and SII device_type to EP.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="test-coverage-summary">
<h2>11. Test Coverage Summary<a class="headerlink" href="#test-coverage-summary" title="Permalink to this heading"></a></h2>
<section id="test-suite-overview">
<h3>10.1 Test Suite Overview<a class="headerlink" href="#test-suite-overview" title="Permalink to this heading"></a></h3>
<p><strong>86 test cases, 344 checks</strong> (includes 5 BME-directed tests; target 100% pass)</p>
<div class="mermaid">
            pie title Test Distribution
    &quot;E2E Tests (41)&quot; : 41
    &quot;Directed Tests (45)&quot; : 45
        </div><div class="mermaid">
            graph LR
    subgraph &quot;Test Categories&quot;
        E2E[E2E Tests&lt;br/&gt;41 tests]
        DIR[Directed Tests&lt;br/&gt;40 tests]
    end
    
    subgraph &quot;E2E Breakdown&quot;
        E1[Inbound TLB: 10]
        E2[Outbound TLB: 9]
        E3[Bypass: 2]
        E4[MSI: 8]
        E5[SII: 4]
        E6[Switch: 4]
        E7[Power/Isolation: 2]
        E8[Integration: 2]
    end
    
    subgraph &quot;Directed Breakdown&quot;
        D1[TLB Unit: 8]
        D2[MSI Unit: 5]
        D3[Switch Unit: 7]
        D4[Config: 3]
        D5[SII: 6]
        D6[Signals: 3]
        D7[Reset: 2]
        D8[Integration: 1]
        D9[Data Verification: 5]
        D10[BME: 5]
    end
    
    E2E --&gt; E1
    E2E --&gt; E2
    E2E --&gt; E3
    E2E --&gt; E4
    E2E --&gt; E5
    E2E --&gt; E6
    E2E --&gt; E7
    E2E --&gt; E8
    
    DIR --&gt; D1
    DIR --&gt; D2
    DIR --&gt; D3
    DIR --&gt; D4
    DIR --&gt; D5
    DIR --&gt; D6
    DIR --&gt; D7
    DIR --&gt; D8
    DIR --&gt; D9
    DIR --&gt; D10
    
    style E2E fill:#e1f5ff
    style DIR fill:#fff4e1
        </div></section>
<section id="coverage-metrics">
<h3>10.2 Coverage Metrics<a class="headerlink" href="#coverage-metrics" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Functional Coverage:</strong> 100% of testable features</p></li>
<li><p><strong>Route Coverage:</strong> All 16 route values exercised (0x0-0xF)</p></li>
<li><p><strong>TLB Boundary Coverage:</strong> Entry 0, 1, 63 tested</p></li>
<li><p><strong>Error Path Coverage:</strong> DECERR, isolation blocking, invalid TLB entries</p></li>
<li><p><strong>Signal Coverage:</strong> All input/output signals exercised</p></li>
<li><p><strong>Cross-Socket Data Verification:</strong> Enabled via <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> through real initiator sockets</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="references">
<h2>12. References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<section id="related-documentation">
<h3>11.1 Related Documentation<a class="headerlink" href="#related-documentation" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>SystemC Design Document:</strong> Detailed low-level implementation</p></li>
<li><p><strong>Test Plan:</strong> Comprehensive verification strategy and results</p></li>
<li><p><strong>Test Implementation:</strong> 86 test cases in <code class="docutils literal notranslate"><span class="pre">Keranous_pcie_tileTest.cc</span></code> (includes 5 BME-directed tests)</p></li>
</ul>
</section>
<section id="source-code-organization">
<h3>11.2 Source Code Organization<a class="headerlink" href="#source-code-organization" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Keraunos_PCIe_tile/
├── SystemC/
│   ├── include/         (15 header files)
│   └── src/             (15 implementation files)
├── Tests/
│   └── Unittests/
│       ├── Keranous_pcie_tileTest.cc        (86 tests)
│       └── Keranous_pcie_tileTestHarness.h
└── doc/
    ├── Keraunos_PCIe_Tile_HLD.md
    ├── Keraunos_PCIE_Tile_SystemC_Design_Document.md
    └── Keraunos_PCIE_Tile_Testplan.md
</pre></div>
</div>
<hr class="docutils" />
<p><strong>Document Control:</strong></p>
<ul class="simple">
<li><p><strong>Version:</strong> 2.0</p></li>
<li><p><strong>Date:</strong> February 10, 2026</p></li>
<li><p><strong>Status:</strong> Updated - DUT initiator socket architecture</p></li>
<li><p><strong>Next Review:</strong> Upon DUT architecture changes or test plan updates</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Keraunos_System_Architecture.html" class="btn btn-neutral float-left" title="Keraunos System Architecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Keraunos_PCIE_Tile_SystemC_Design_Document.html" class="btn btn-neutral float-right" title="Keraunos PCIE Tile SystemC/TLM2.0 Design Document" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, SystemC Modeling Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>