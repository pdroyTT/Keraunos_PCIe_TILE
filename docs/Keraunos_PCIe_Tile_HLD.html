<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Keraunos PCIe Tile - High-Level Design Document &mdash; Keraunos PCIe Tile 2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
        <script>
mermaid.initialize({
    startOnLoad: true,
    theme: 'default',
    themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#000',
        primaryBorderColor: '#1976d2',
        lineColor: '#1976d2',
        secondaryColor: '#fff4e1',
        tertiaryColor: '#e8f5e9'
    },
    flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis',
        padding: 15
    },
    sequence: {
        useMaxWidth: true,
        diagramMarginX: 50,
        diagramMarginY: 10,
        actorMargin: 50,
        boxMargin: 10,
        boxTextMargin: 5,
        noteMargin: 10,
        messageMargin: 35
    },
    gantt: {
        useMaxWidth: true,
        barHeight: 20,
        barGap: 4,
        topPadding: 50,
        leftPadding: 75,
        gridLineStartPadding: 35
    },
    class: {
        useMaxWidth: true
    },
    state: {
        useMaxWidth: true
    }
});
</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Keraunos PCIE Tile SystemC/TLM2.0 Design Document" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html" />
    <link rel="prev" title="Keraunos System Architecture" href="Keraunos_System_Architecture.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Keraunos PCIe Tile
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Keraunos_System_Architecture.html">Keraunos System Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-integration-in-keraunos-e100-chiplet-ecosystem">PCIe Tile Integration in Keraunos-E100 Chiplet Ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#executive-summary">Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#system-overview">1. System Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#grendel-chiplet-ecosystem">1.1 Grendel Chiplet Ecosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#keraunos-e100-role">1.2 Keraunos-E100 Role</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#keraunos-e100-chiplet-architecture">2. Keraunos-E100 Chiplet Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#high-level-block-diagram">2.1 High-Level Block Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#key-subsystems">2.2 Key Subsystems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#chiplet-harness">2.2.1 Chiplet Harness</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-subsystem">2.2.2 PCIe Subsystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#hsio-high-speed-i-o-tiles">2.2.3 HSIO (High-Speed I/O) Tiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_System_Architecture.html#noc-infrastructure">2.2.4 NOC Infrastructure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-position-in-the-system">3. PCIe Tile Position in the System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-tile-overview">3.1 PCIe Tile Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#architectural-position">3.2 Architectural Position</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#key-interfaces">3.3 Key Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#connectivity-architecture">4. Connectivity Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#inbound-data-path-host-chip">4.1 Inbound Data Path (Host → Chip)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#outbound-data-path-chip-host">4.2 Outbound Data Path (Chip → Host)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#configuration-path-smn-pcie-tile-registers">4.3 Configuration Path (SMN → PCIe Tile Registers)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#msi-interrupt-path-chip-host">4.4 MSI Interrupt Path (Chip → Host)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#data-flow-paths">5. Data Flow Paths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#end-to-end-data-flow-example-host-dma-to-quasar">5.1 End-to-End Data Flow Example: Host DMA to Quasar</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#multi-hop-data-flow-quasar-pcie-host-pcie-quasar">5.2 Multi-Hop Data Flow: Quasar → PCIe → Host → PCIe → Quasar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#address-space-integration">6. Address Space Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#system-address-map">6.1 System Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#pcie-bar-base-address-register-mapping">6.2 PCIe BAR (Base Address Register) Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#address-translation-stages">6.3 Address Translation Stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#system-use-cases">7. System Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-1-model-initialization">7.1 Use Case 1: Model Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-2-inference-execution">7.2 Use Case 2: Inference Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-3-package-to-package-communication">7.3 Use Case 3: Package-to-Package Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#use-case-4-system-management">7.4 Use Case 4: System Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_System_Architecture.html#appendices">8. Appendices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#acronyms-and-abbreviations">8.1 Acronyms and Abbreviations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#reference-documents">8.2 Reference Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_System_Architecture.html#revision-history">8.3 Revision History</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Keraunos PCIe Tile - High-Level Design Document</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="#definitions-and-acronyms">1.3 Definitions and Acronyms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-overview">2. Architecture Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#top-level-architecture">2.1 Top-Level Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-principles">2.2 Design Principles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#block-diagram">3. Block Diagram</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tile-level-block-diagram">3.1 Tile-Level Block Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-flow-paths">3.2 Data Flow Paths</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-descriptions">4. Module Descriptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#noc-pcie-switch">4.1 NOC-PCIE Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#noc-io-switch">4.2 NOC-IO Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smn-io-switch">4.3 SMN-IO Switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#translation-lookaside-buffers-tlbs">4.4 Translation Lookaside Buffers (TLBs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-relay-unit">4.5 MSI Relay Unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-information-interface-sii-block">4.6 System Information Interface (SII) Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-register-block">4.7 Configuration Register Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clock-and-reset-control">4.8 Clock and Reset Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pcie-phy-model">4.9 PCIe PHY Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pll-cgm-clock-generation-module">4.10 PLL/CGM (Clock Generation Module)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interface-specifications">5. Interface Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#external-tlm-sockets">5.1 External TLM Sockets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-input-signals">5.2 Control Input Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-signals">5.3 Output Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#internal-signals">5.4 Internal Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#address-map">6. Address Map</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inbound-address-map-pcie-noc-smn">6.1 Inbound Address Map (PCIe → NOC/SMN)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-address-map-smn">6.2 Configuration Address Map (SMN)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-relay-address-map-0x18800000">6.3 MSI Relay Address Map (0x18800000)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-flow">7. Data Flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inbound-data-flow-pcie-noc">7.1 Inbound Data Flow (PCIe → NOC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outbound-data-flow-noc-pcie">7.2 Outbound Data Flow (NOC → PCIe)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-access-flow-smn-config-registers">7.3 Configuration Access Flow (SMN → Config Registers)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#msi-generation-flow-noc-pcie-via-msi-relay">7.4 MSI Generation Flow (NOC → PCIe via MSI Relay)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cii-interrupt-flow-pcie-config-write-config-update">7.5 CII Interrupt Flow (PCIe Config Write → config_update)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clock-and-reset-strategy">8. Clock and Reset Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clock-domains">8.1 Clock Domains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reset-strategy">8.2 Reset Strategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#power-on-initialization">8.3 Power-On Initialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-and-control">9. Configuration and Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tile-initialization-sequence">9.1 Tile Initialization Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#runtime-control">9.2 Runtime Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status-monitoring">9.3 Status Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">10. References</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#related-documents">10.1 Related Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source-code-organization">10.2 Source Code Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-design-decisions">10.3 Key Design Decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-limitations-and-findings">10.4 Known Limitations and Findings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-a-signal-timing-diagrams">Appendix A: Signal Timing Diagrams</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-1-cii-interrupt-timing">A.1 CII Interrupt Timing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-2-isolation-sequence">A.2 Isolation Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-3-cold-reset-cycle">A.3 Cold Reset Cycle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-b-address-decode-examples">Appendix B: Address Decode Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#b-1-inbound-tlb-translation-tlb-sys-in0">B.1 Inbound TLB Translation (TLB Sys In0)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-2-status-register-access">B.2 Status Register Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-3-smn-config-write-address-passthrough-issue">B.3 SMN Config Write (Address Passthrough Issue)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-c-test-coverage-summary">Appendix C: Test Coverage Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html">Keraunos PCIE Tile SystemC/TLM2.0 Design Document</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#sphinx-setup-instructions">Sphinx Setup Instructions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#install-required-extensions">1. Install Required Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configure-conf-py">2. Configure <code class="docutils literal notranslate"><span class="pre">conf.py</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-html-documentation">3. Build HTML Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#alternative-use-make">4. Alternative: Use make</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#key-implementation-features">⭐ Key Implementation Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#references">1.3 References</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-version">1.4 Implementation Version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-architecture-overview-new">1.5 Refactored Architecture Overview ⭐ NEW</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#why-refactoring-was-necessary">1.5.1 Why Refactoring Was Necessary</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-architecture-pattern">1.5.2 Refactored Architecture Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#original-design-socket-based">Original Design (Socket-Based):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#refactored-design-function-based">Refactored Design (Function-Based):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#function-callback-communication-pattern">1.5.3 Function Callback Communication Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#callback-type-definition">Callback Type Definition:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#setting-up-callbacks-wire-components">Setting Up Callbacks (Wire Components):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#benefits-of-function-callbacks">Benefits of Function Callbacks:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smart-pointer-memory-management">1.5.4 Smart Pointer Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-memory-integration">1.5.5 SCML2 Memory Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#temporal-decoupling-support">1.5.6 Temporal Decoupling Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modern-c-best-practices-applied">1.5.7 Modern C++ Best Practices Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#file-organization">1.5.8 File Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-communication-pattern">1.5.9 Component Communication Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#null-safety-pattern">1.5.10 Null Safety Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-characteristics">1.5.11 Performance Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#code-example-complete-transaction-path">1.5.12 Code Example - Complete Transaction Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#system-overview">2. System Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#keraunos-pcie-tile-context">2.1 Keraunos PCIE Tile Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modeled-components">2.2 Modeled Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-objectives">2.3 Design Objectives</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture">3. Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overall-structure">3.1 Overall Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-hierarchy">3.2 Component Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#data-flow">3.3 Data Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-traffic-flow">Inbound Traffic Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-traffic-flow">Outbound Traffic Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-flow">MSI Flow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-design">4. Component Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-common-structures">4.1 TLB Common Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbentry-structure">4.1.1 TlbEntry Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-tlb-design">4.2 Inbound TLB Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overview-and-use-cases">4.2.1 Overview and Use Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbsysin0-system-management-inbound-tlb">4.2.2 TLBSysIn0 - System Management Inbound TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappin0-application-inbound-tlb-bar0-1">4.2.3 TLBAppIn0 - Application Inbound TLB (BAR0/1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappin1-application-inbound-tlb-bar4-5">4.2.4 TLBAppIn1 - Application Inbound TLB (BAR4/5)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-tlb-translation-flow">4.2.5 Inbound TLB Translation Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-examples">4.2.6 Address Translation Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axuser-field-format">4.2.7 AxUSER Field Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-and-initialization">4.2.8 Configuration and Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#error-handling">4.2.9 Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-with-system">4.2.10 Integration with System</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-tlb-design">4.3 Outbound TLB Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id1">4.3.1 Overview and Use Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbsysout0-system-management-outbound-tlb">4.3.2 TLBSysOut0 - System Management Outbound TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappout0-application-outbound-tlb-high-address">4.3.3 TLBAppOut0 - Application Outbound TLB (High Address)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlbappout1-application-outbound-tlb-dbi-access">4.3.4 TLBAppOut1 - Application Outbound TLB (DBI Access)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-tlb-translation-flow">4.3.5 Outbound TLB Translation Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id2">4.3.6 Address Translation Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id3">4.3.7 Configuration and Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id4">4.3.8 Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id5">4.3.9 Integration with System</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-relay-unit-design">4.4 MSI Relay Unit Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#overview">4.4.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id6">4.4.2 Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-x-table-entry">4.4.3 MSI-X Table Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pending-bit-array-pba">4.4.4 Pending Bit Array (PBA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-thrower-logic">4.4.5 MSI Thrower Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#register-map">4.4.6 Register Map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#intra-tile-fabric-switch-design">4.5 Intra-Tile Fabric Switch Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-pcie-switch">4.5.1 NOC-PCIE Switch</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-io-switch">4.5.2 NOC-IO Switch</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smn-io-switch">4.5.3 SMN-IO Switch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#system-information-interface-sii-block">4.6 System Information Interface (SII) Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id7">4.6.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture-and-operation">4.6.2 Architecture and Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#cii-tracking-implementation">4.6.3 CII Tracking Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id8">4.6.4 Register Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-domain-crossing">4.6.5 Clock Domain Crossing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interrupt-generation-and-routing">4.6.6 Interrupt Generation and Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface-specification">4.6.7 Interface Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-details">4.6.8 Implementation Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-register-block">4.7 Configuration Register Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id9">4.7.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#status-registers">4.7.2 Status Registers</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#isolation-behavior">4.7.3 Isolation Behavior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-reset-control-module">4.8 Clock &amp; Reset Control Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id10">4.8.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#clock-domains">4.8.2 Clock Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#reset-sequence">4.8.3 Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface">4.8.4 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pll-cgm-clock-generation-module">4.9 PLL/CGM (Clock Generation Module)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id11">4.9.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pll-lock">4.9.2 PLL Lock</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id12">4.9.3 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pcie-phy-model">4.10 PCIE PHY Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id13">4.10.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#features">4.10.2 Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id14">4.10.3 Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#external-interface-modules">4.11 External Interface Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-n-interface">4.11.1 NOC-N Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smn-n-interface">4.11.2 SMN-N Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#top-level-keraunos-pcie-tile-module">4.12 Top-Level Keraunos PCIE Tile Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id15">4.12.1 Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#external-interfaces">4.12.2 External Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#internal-connections">4.12.3 Internal Connections</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#interface-specifications">5. Interface Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlm2-0-interfaces">5.1 TLM2.0 Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-target-socket-inbound-tlbs">5.1.1 AXI4 Target Socket (Inbound TLBs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-initiator-socket-all-tlbs">5.1.2 AXI4 Initiator Socket (All TLBs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#apb-target-socket-configuration">5.1.3 APB Target Socket (Configuration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#axi4-lite-initiator-socket-msi-relay">5.1.4 AXI4-Lite Initiator Socket (MSI Relay)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#systemc-signals">5.2 SystemC Signals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#control-signals">5.2.1 Control Signals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-interfaces">5.3 Address Translation Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-lookup-methods">5.3.1 TLB Lookup Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-methods">5.3.2 Configuration Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id16">6. Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#address-translation-algorithms">6.1 Address Translation Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-translation-tlbsysin0">6.1.1 Inbound Translation (TLBSysIn0)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#outbound-translation-tlbappout0">6.1.2 Outbound Translation (TLBAppOut0)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#id17">6.2 Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#invalid-tlb-entry">6.2.1 Invalid TLB Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#out-of-range-index">6.2.2 Out-of-Range Index</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#msi-relay-unit-state-machine">6.3 MSI Relay Unit State Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#threading-model">6.4 Threading Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-modeling">6.5 Memory Modeling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modeling-approach">7. Modeling Approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#abstraction-level">7.1 Abstraction Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-usage">7.2 SCML2 Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#socket-type-selection-rationale">7.2.1 Socket Type Selection Rationale</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlm2-0-compliance">7.3 TLM2.0 Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-patterns">7.4 Design Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-considerations">8. Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#simulation-performance">8.1 Simulation Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#optimization-opportunities">8.2 Optimization Opportunities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scalability">8.3 Scalability</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#dependencies-and-requirements">9. Dependencies and Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#software-dependencies">9.1 Software Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#hardware-dependencies">9.2 Hardware Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-requirements">9.3 Integration Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#detailed-implementation-architecture">9. Detailed Implementation Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#class-hierarchy-and-relationships">9.1 Class Hierarchy and Relationships</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#top-level-module-only-sc-module">Top-Level Module (Only sc_module):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#internal-component-pattern">Internal Component Pattern:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#communication-architecture">9.2 Communication Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#transaction-flow-pattern">Transaction Flow Pattern:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-management-architecture">9.3 Memory Management Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#smart-pointer-ownership-tree">Smart Pointer Ownership Tree:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#callback-wiring-implementation">9.4 Callback Wiring Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#complete-wiring-example">Complete Wiring Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#scml2-memory-usage-pattern">9.5 SCML2 Memory Usage Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-storage-implementation">Configuration Storage Implementation:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#component-lifecycle">9.6 Component Lifecycle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#initialization-sequence">Initialization Sequence:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#transaction-processing-flow">9.7 Transaction Processing Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#inbound-pcie-transaction-example">Inbound PCIe Transaction Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#routing-decision-implementation">9.8 Routing Decision Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#noc-pcie-switch-routing-logic">NOC-PCIE Switch Routing Logic:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-translation-implementation">9.9 TLB Translation Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#translation-algorithm">Translation Algorithm:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#error-handling-strategy">9.10 Error Handling Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#layered-error-response">Layered Error Response:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-register-implementation">9.11 Configuration Register Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#register-access-pattern">Register Access Pattern:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#implementation-guide">10. Implementation Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#building-the-design">10.1 Building the Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#prerequisites">Prerequisites:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-commands">Build Commands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#build-output">Build Output:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#running-tests">10.2 Running Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#unit-tests-auto-generated">Unit Tests (Auto-Generated):</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-coverage">Test Coverage:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-new-components">10.3 Adding New Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#pattern-for-c-class-components">Pattern for C++ Class Components:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#debugging-and-troubleshooting">10.4 Debugging and Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#common-issues-and-solutions">Common Issues and Solutions:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#debug-tools">Debug Tools:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#performance-tuning">10.5 Performance Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#temporal-decoupling-configuration">Temporal Decoupling Configuration:</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-timing-annotations">Adding Timing Annotations:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-development-guide">10.6 Test Development Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#adding-new-test-cases">Adding New Test Cases:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#configuration-management">10.7 Configuration Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#tlb-configuration-example">TLB Configuration Example:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#integration-with-vdk-platform">10.8 Integration with VDK Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#module-instantiation-in-platform">Module Instantiation in Platform:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#memory-management-best-practices">10.9 Memory Management Best Practices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#raii-pattern-already-applied">RAII Pattern (Already Applied):</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#coding-standards-applied">10.10 Coding Standards Applied</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#modern-c-17-features-used">Modern C++17 Features Used:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-infrastructure">11. Test Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-framework-overview">11.1 Test Framework Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-categories-33-tests">11.2 Test Categories (33 Tests)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-execution-results">11.3 Test Execution Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#test-api-examples">11.4 Test API Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#coverage-goals">11.5 Coverage Goals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#migration-from-original-design">12. Migration from Original Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#for-developers-familiar-with-original">12.1 For Developers Familiar with Original</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#api-migration-guide">12.2 API Migration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#backward-compatibility-notes">12.3 Backward Compatibility Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#known-limitations-and-future-work">13. Known Limitations and Future Work</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#current-limitations">13.1 Current Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#future-enhancements">13.2 Future Enhancements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#lessons-learned-and-best-practices">14. Lessons Learned and Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#architecture-decisions">14.1 Architecture Decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#design-patterns-applied">14.2 Design Patterns Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#recommendations-for-similar-projects">14.3 Recommendations for Similar Projects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-a-implemented-components-summary">Appendix A: Implemented Components Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-1-complete-component-list">A.1 Complete Component List</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-2-component-statistics">A.2 Component Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#a-3-scml-compliance">A.3 SCML Compliance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-b-address-map-summary">Appendix B: Address Map Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-1-tlb-configuration-space">B.1 TLB Configuration Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-2-msi-relay-unit-address-map">B.2 MSI Relay Unit Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-3-sii-block-address-map">B.3 SII Block Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-4-config-register-block-address-map">B.4 Config Register Block Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-5-smn-io-switch-address-map">B.5 SMN-IO Switch Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-6-noc-io-switch-address-map">B.6 NOC-IO Switch Address Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#b-7-noc-pcie-switch-routing-map">B.7 NOC-PCIE Switch Routing Map</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_SystemC_Design_Document.html#appendix-c-acronyms-and-abbreviations">Appendix C: Acronyms and Abbreviations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html">Keraunos PCIE Tile SystemC/TLM2.0 Testplan</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#introduction">1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#purpose">1.1 Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#scope">1.2 Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-objectives">1.3 Test Objectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#references">1.4 References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-traceability-matrix">1.5 Test Traceability Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-environment">2. Test Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#testbench-structure">2.1 Testbench Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-components">2.2 Test Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-tools">2.3 Test Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-strategy">3. Test Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-levels">3.1 Test Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-methodology">3.2 Test Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-phases">3.3 Test Phases</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#inbound-tlb-test-cases">4. Inbound TLB Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbsysin0-test-cases">4.1 TLBSysIn0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-001-basic-address-translation">TC_INBOUND_SYS_001: Basic Address Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-002-invalid-entry-detection">TC_INBOUND_SYS_002: Invalid Entry Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-003-index-calculation">TC_INBOUND_SYS_003: Index Calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-004-page-boundary-crossing">TC_INBOUND_SYS_004: Page Boundary Crossing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-005-axuser-field-mapping">TC_INBOUND_SYS_005: AxUSER Field Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-sys-006-system-ready-bypass">TC_INBOUND_SYS_006: System Ready Bypass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappin0-test-cases">4.2 TLBAppIn0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-001-bar0-1-translation">TC_INBOUND_APP0_001: BAR0/1 Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-002-multiple-instance-support">TC_INBOUND_APP0_002: Multiple Instance Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-003-16mb-page-size">TC_INBOUND_APP0_003: 16MB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app0-004-non-cacheable-and-qosid">TC_INBOUND_APP0_004: Non-Cacheable and QoSID</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappin1-test-cases">4.3 TLBAppIn1 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-001-bar4-5-translation">TC_INBOUND_APP1_001: BAR4/5 Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-002-8gb-page-size">TC_INBOUND_APP1_002: 8GB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-inbound-app1-003-dram-mapping">TC_INBOUND_APP1_003: DRAM Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#outbound-tlb-test-cases">5. Outbound TLB Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbsysout0-test-cases">5.1 TLBSysOut0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-001-dbi-access-translation">TC_OUTBOUND_SYS_001: DBI Access Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-002-64kb-page-size">TC_OUTBOUND_SYS_002: 64KB Page Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-sys-003-all-16-entries">TC_OUTBOUND_SYS_003: All 16 Entries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappout0-test-cases">5.2 TLBAppOut0 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-001-high-address-translation-256tb">TC_OUTBOUND_APP0_001: High Address Translation (&gt;=256TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-002-address-range-check">TC_OUTBOUND_APP0_002: Address Range Check</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app0-003-16tb-page-size">TC_OUTBOUND_APP0_003: 16TB Page Size</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlbappout1-test-cases">5.3 TLBAppOut1 Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app1-001-low-address-translation-256tb">TC_OUTBOUND_APP1_001: Low Address Translation (&lt;256TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-outbound-app1-002-dbi-access-from-application">TC_OUTBOUND_APP1_002: DBI Access from Application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-relay-unit-test-cases">6. MSI Relay Unit Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#register-access-tests">6.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-001-msi-receiver-write">TC_MSI_RELAY_001: MSI Receiver Write</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-002-msi-x-table-configuration">TC_MSI_RELAY_002: MSI-X Table Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-003-outstanding-count">TC_MSI_RELAY_003: Outstanding Count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-generation-tests">6.2 MSI Generation Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-004-basic-msi-generation">TC_MSI_RELAY_004: Basic MSI Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-005-msi-x-enable-control">TC_MSI_RELAY_005: MSI-X Enable Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-006-global-mask-control">TC_MSI_RELAY_006: Global Mask Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-007-vector-mask-control">TC_MSI_RELAY_007: Vector Mask Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-008-invalid-entry-handling">TC_MSI_RELAY_008: Invalid Entry Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-009-multiple-pending-interrupts">TC_MSI_RELAY_009: Multiple Pending Interrupts</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-010-setip-signal">TC_MSI_RELAY_010: SetIP Signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-msi-relay-011-all-16-vectors">TC_MSI_RELAY_011: All 16 Vectors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#integration-test-cases">7. Integration Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlb-msi-relay-integration">7.1 TLB + MSI Relay Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-001-msi-x-table-access-via-tlb">TC_INTEGRATION_001: MSI-X Table Access via TLB</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-002-msi-generation-through-fabric">TC_INTEGRATION_002: MSI Generation Through Fabric</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#multiple-tlb-integration">7.2 Multiple TLB Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-003-concurrent-tlb-operations">TC_INTEGRATION_003: Concurrent TLB Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-integration-004-outbound-inbound-round-trip">TC_INTEGRATION_004: Outbound + Inbound Round Trip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#switch-test-cases">8. Switch Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-pcie-switch-test-cases">8.1 NOC-PCIE Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-001-address-routing-based-on-axaddr-63-60">TC_SWITCH_NOC_PCIE_001: Address Routing Based on AxADDR[63:60]</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-002-status-register-special-routing">TC_SWITCH_NOC_PCIE_002: Status Register Special Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-003-isolation-support">TC_SWITCH_NOC_PCIE_003: Isolation Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-004-inbound-enable-control">TC_SWITCH_NOC_PCIE_004: Inbound Enable Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#enable-gating-test-cases-new-feb-2026">8.4 Enable Gating Test Cases (NEW - Feb 2026)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-negative-enable-001-inbound-enable-blocks-pcienoc-traffic">TC_NEGATIVE_ENABLE_001: Inbound Enable Blocks PCIe→NOC Traffic</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-negative-enable-002-outbound-enable-blocks-nocpcie-traffic">TC_NEGATIVE_ENABLE_002: Outbound Enable Blocks NOC→PCIe Traffic</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-negative-enable-003-both-enables-disabled-complete-isolation">TC_NEGATIVE_ENABLE_003: Both Enables Disabled - Complete Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-negative-enable-004-both-enables-active-positive-control">TC_NEGATIVE_ENABLE_004: Both Enables Active - Positive Control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#enable-gating-implementation-architecture">8.5 Enable Gating Implementation Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-005-bypass-path-routing">TC_SWITCH_NOC_PCIE_005: Bypass Path Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-pcie-006-address-conversion-64-bit-to-52-bit">TC_SWITCH_NOC_PCIE_006: Address Conversion (64-bit to 52-bit)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-io-switch-test-cases">8.2 NOC-IO Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-001-local-resource-routing">TC_SWITCH_NOC_IO_001: Local Resource Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-002-external-noc-routing">TC_SWITCH_NOC_IO_002: External NOC Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-003-high-address-routing-axaddr-51-48">TC_SWITCH_NOC_IO_003: High Address Routing (AxADDR[51:48])</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-noc-io-004-timeout-detection">TC_SWITCH_NOC_IO_004: Timeout Detection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#smn-io-switch-test-cases">8.3 SMN-IO Switch Test Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-001-address-based-routing">TC_SWITCH_SMN_IO_001: Address-Based Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-002-serdes-routing">TC_SWITCH_SMN_IO_002: SerDes Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-003-external-smn-routing">TC_SWITCH_SMN_IO_003: External SMN Routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-switch-smn-io-004-timeout-detection">TC_SWITCH_SMN_IO_004: Timeout Detection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#sii-block-test-cases">9. SII Block Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id1">9.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-001-configuration-register-access">TC_SII_001: Configuration Register Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-002-cii-tracking">TC_SII_002: CII Tracking</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-sii-003-bus-device-number-assignment">TC_SII_003: Bus/Device Number Assignment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#config-register-block-test-cases">10. Config Register Block Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id2">10.1 Register Access Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-001-tlb-configuration-space-access">TC_CONFIG_REG_001: TLB Configuration Space Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-002-system-ready-register">TC_CONFIG_REG_002: System Ready Register</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-003-pcie-enable-registers">TC_CONFIG_REG_003: PCIE Enable Registers</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-config-reg-004-isolation-behavior">TC_CONFIG_REG_004: Isolation Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-reset-test-cases">11. Clock &amp; Reset Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-generation-tests">11.1 Clock Generation Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-001-reference-clock-generation">TC_CLOCK_RESET_001: Reference Clock Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-002-pcie-clock-generation">TC_CLOCK_RESET_002: PCIE Clock Generation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reset-sequence-tests">11.2 Reset Sequence Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-003-cold-reset-sequence">TC_CLOCK_RESET_003: Cold Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-004-warm-reset-sequence">TC_CLOCK_RESET_004: Warm Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-clock-reset-005-isolation-behavior">TC_CLOCK_RESET_005: Isolation Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pll-cgm-test-cases">12. PLL/CGM Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pll-lock-tests">12.1 PLL Lock Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-pll-cgm-001-pll-lock-sequence">TC_PLL_CGM_001: PLL Lock Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-pll-cgm-002-pll-configuration">TC_PLL_CGM_002: PLL Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#pcie-phy-test-cases">13. PCIE PHY Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phy-configuration-tests">13.1 PHY Configuration Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-001-apb-configuration-access">TC_PHY_001: APB Configuration Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-002-ahb-firmware-download">TC_PHY_002: AHB Firmware Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-phy-003-lane-reversal-support">TC_PHY_003: Lane Reversal Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#external-interface-test-cases">14. External Interface Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#noc-n-interface-tests">14.1 NOC-N Interface Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-external-noc-001-transaction-forwarding">TC_EXTERNAL_NOC_001: Transaction Forwarding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#smn-n-interface-tests">14.2 SMN-N Interface Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-external-smn-001-transaction-forwarding">TC_EXTERNAL_SMN_001: Transaction Forwarding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#top-level-integration-test-cases">15. Top-Level Integration Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#full-tile-integration">15.1 Full Tile Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-001-complete-reset-sequence">TC_TOP_LEVEL_001: Complete Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-002-end-to-end-transaction-flow">TC_TOP_LEVEL_002: End-to-End Transaction Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-003-msi-end-to-end-flow">TC_TOP_LEVEL_003: MSI End-to-End Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-004-isolation-sequence">TC_TOP_LEVEL_004: Isolation Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-top-level-005-multiple-clock-domain-operation">TC_TOP_LEVEL_005: Multiple Clock Domain Operation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#end-to-end-test-cases">16. End-to-End Test Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#inbound-data-paths-pcie-noc-smn">16.1 Inbound Data Paths (PCIe → NOC/SMN)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-001-pcie-read-tlb-app0-noc-n">TC_E2E_INBOUND_001: PCIe Read → TLB App0 → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-002-pcie-write-tlb-app1-noc-n">TC_E2E_INBOUND_002: PCIe Write → TLB App1 → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-003-pcie-tlb-sys-smn-n">TC_E2E_INBOUND_003: PCIe → TLB Sys → SMN-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-004-pcie-bypass-app-path">TC_E2E_INBOUND_004: PCIe Bypass App Path</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-inbound-005-pcie-bypass-sys-path">TC_E2E_INBOUND_005: PCIe Bypass Sys Path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#outbound-data-paths-noc-smn-pcie">16.2 Outbound Data Paths (NOC/SMN → PCIe)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-001-noc-n-tlb-app-out0-pcie">TC_E2E_OUTBOUND_001: NOC-N → TLB App Out0 → PCIe</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-002-smn-n-tlb-sys-out0-pcie">TC_E2E_OUTBOUND_002: SMN-N → TLB Sys Out0 → PCIe</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-outbound-003-noc-n-tlb-app-out1-pcie-dbi">TC_E2E_OUTBOUND_003: NOC-N → TLB App Out1 → PCIe DBI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#configuration-paths-smn-tlb-sii-msi-config">16.3 Configuration Paths (SMN → TLB/SII/MSI Config)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-001-smn-n-tlb-config">TC_E2E_CONFIG_001: SMN-N → TLB Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-002-smn-n-sii-config">TC_E2E_CONFIG_002: SMN-N → SII Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-config-003-smn-n-msi-relay-config">TC_E2E_CONFIG_003: SMN-N → MSI Relay Config</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-interrupt-flows">16.4 MSI Interrupt Flows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msi-001-msi-generation-noc-n">TC_E2E_MSI_001: MSI Generation → NOC-N</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msi-002-downstream-msi-input-processing">TC_E2E_MSI_002: Downstream MSI Input → Processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#status-register-access">16.5 Status Register Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-status-001-status-register-read-route-0xe">TC_E2E_STATUS_001: Status Register Read (Route 0xE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-status-002-status-register-disabled-access">TC_E2E_STATUS_002: Status Register Disabled Access</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#isolation-and-error-handling">16.6 Isolation and Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-isolation-001-global-isolation">TC_E2E_ISOLATION_001: Global Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-isolation-002-config-access-during-isolation">TC_E2E_ISOLATION_002: Config Access During Isolation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#multi-path-concurrent-traffic">16.7 Multi-Path Concurrent Traffic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-concurrent-001-simultaneous-inbound-outbound">TC_E2E_CONCURRENT_001: Simultaneous Inbound + Outbound</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-concurrent-002-multiple-tlb-simultaneous-access">TC_E2E_CONCURRENT_002: Multiple TLB Simultaneous Access</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reset-and-initialization-sequences">16.8 Reset and Initialization Sequences</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-reset-001-cold-reset-sequence">TC_E2E_RESET_001: Cold Reset Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-reset-002-warm-reset-sequence">TC_E2E_RESET_002: Warm Reset Sequence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#complete-transaction-flows">16.9 Complete Transaction Flows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-001-pcie-memory-read-noc-memory-response">TC_E2E_FLOW_001: PCIe Memory Read → NOC → Memory → Response</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-002-pcie-memory-write-noc-memory-completion">TC_E2E_FLOW_002: PCIe Memory Write → NOC → Memory → Completion</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-003-noc-memory-read-pcie-controller">TC_E2E_FLOW_003: NOC Memory Read → PCIe Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-flow-004-smn-config-write-pcie-dbi">TC_E2E_FLOW_004: SMN Config Write → PCIe DBI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#error-injection-and-recovery">16.10 Error Injection and Recovery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-001-invalid-tlb-entry">TC_E2E_ERROR_001: Invalid TLB Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-002-timeout-handling">TC_E2E_ERROR_002: Timeout Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-error-003-address-decode-error">TC_E2E_ERROR_003: Address Decode Error</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-x-end-to-end-flow">16.11 MSI-X End-to-End Flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msix-001-complete-msi-x-interrupt-flow">TC_E2E_MSIX_001: Complete MSI-X Interrupt Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-msix-002-multiple-vector-interrupts">TC_E2E_MSIX_002: Multiple Vector Interrupts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-domain-crossing">16.12 Clock Domain Crossing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-cdc-001-axi-clock-pcie-clock">TC_E2E_CDC_001: AXI Clock → PCIe Clock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#performance-and-stress-tests">16.13 Performance and Stress Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-perf-001-maximum-throughput-test">TC_E2E_PERF_001: Maximum Throughput Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-stress-001-address-space-sweep">TC_E2E_STRESS_001: Address Space Sweep</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-stress-002-tlb-entry-exhaustion">TC_E2E_STRESS_002: TLB Entry Exhaustion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#power-management">16.14 Power Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-power-001-isolation-mode-entry-exit">TC_E2E_POWER_001: Isolation Mode Entry/Exit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#system-integration-scenarios">16.15 System Integration Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-001-boot-sequence">TC_E2E_SYSTEM_001: Boot Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-002-shutdown-sequence">TC_E2E_SYSTEM_002: Shutdown Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-system-003-error-recovery-scenario">TC_E2E_SYSTEM_003: Error Recovery Scenario</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#refactored-architecture-validation">16.16 Refactored Architecture Validation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-refactor-001-function-callback-chain">TC_E2E_REFACTOR_001: Function Callback Chain</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tc-e2e-refactor-002-no-internal-sockets-remain">TC_E2E_REFACTOR_002: No Internal Sockets Remain</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#coverage-goals">17. Coverage Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#id3">16. Coverage Goals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#functional-coverage">16.1 Functional Coverage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#tlb-coverage">TLB Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#msi-relay-coverage">MSI Relay Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#switch-coverage">Switch Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#sii-coverage">SII Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#config-register-coverage">Config Register Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#clock-reset-coverage">Clock/Reset Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phy-coverage">PHY Coverage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#code-coverage">16.2 Code Coverage</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#specification-coverage">16.3 Specification Coverage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-infrastructure">17. Test Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#testbench-components">9.1 Testbench Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#stimulus-generator">Stimulus Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#monitor">Monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#reference-model">Reference Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-utilities">9.2 Test Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#test-configuration">9.3 Test Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-testing">18. Regression Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-suite">10.1 Regression Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#regression-criteria">10.2 Regression Criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#continuous-integration">10.3 Continuous Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-a-unit-integration-test-case-summary-sections-4-15">Appendix A: Unit/Integration Test Case Summary (Sections 4-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-a-2-end-to-end-test-case-summary-section-16-implemented-in-keranous-pcie-tiletest-cc">Appendix A.2: End-to-End Test Case Summary (Section 16) — Implemented in <code class="docutils literal notranslate"><span class="pre">Keranous_pcie_tileTest.cc</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#appendix-b-test-execution-plan">Appendix B: Test Execution Plan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-1-unit-tests-weeks-1-3">Phase 1: Unit Tests (Weeks 1-3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-2-functional-tests-weeks-4-5">Phase 2: Functional Tests (Weeks 4-5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-3-integration-tests-weeks-6-7">Phase 3: Integration Tests (Weeks 6-7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-4-system-tests-week-8">Phase 4: System Tests (Week 8)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Keraunos_PCIE_Tile_Testplan.html#phase-5-regression-week-9">Phase 5: Regression (Week 9)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ENABLE_GATING_DESIGN.html">Enable Gating Feature - Design Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#register-interface">Register Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#implementation">Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#signal-propagation">Signal Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ENABLE_GATING_DESIGN.html#test-coverage">Test Coverage</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Keraunos PCIe Tile</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Keraunos PCIe Tile - High-Level Design Document</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Keraunos_PCIe_Tile_HLD.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="keraunos-pcie-tile-high-level-design-document">
<h1>Keraunos PCIe Tile - High-Level Design Document<a class="headerlink" href="#keraunos-pcie-tile-high-level-design-document" title="Permalink to this heading"></a></h1>
<p><strong>Version:</strong> 2.0<br />
<strong>Date:</strong> February 10, 2026<br />
<strong>Author:</strong> Auto-generated from SystemC implementation and test coverage analysis</p>
<hr class="docutils" />
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#introduction"><span class="std std-doc">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#architecture-overview"><span class="std std-doc">Architecture Overview</span></a></p></li>
<li><p><a class="reference internal" href="#block-diagram"><span class="std std-doc">Block Diagram</span></a></p></li>
<li><p><a class="reference internal" href="#module-descriptions"><span class="std std-doc">Module Descriptions</span></a></p></li>
<li><p><a class="reference internal" href="#interface-specifications"><span class="std std-doc">Interface Specifications</span></a></p></li>
<li><p><a class="reference internal" href="#address-map"><span class="std std-doc">Address Map</span></a></p></li>
<li><p><a class="reference internal" href="#data-flow"><span class="std std-doc">Data Flow</span></a></p></li>
<li><p><a class="reference internal" href="#clock-and-reset-strategy"><span class="std std-doc">Clock and Reset Strategy</span></a></p></li>
<li><p><a class="reference internal" href="#configuration-and-control"><span class="std std-doc">Configuration and Control</span></a></p></li>
<li><p><a class="reference internal" href="#references"><span class="std std-doc">References</span></a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<section id="purpose">
<h3>1.1 Purpose<a class="headerlink" href="#purpose" title="Permalink to this heading"></a></h3>
<p>This document describes the high-level architecture of the Keraunos PCIe Tile, a SystemC/TLM2.0 model that provides PCIe connectivity between Network-on-Chip (NOC), System Management Network (SMN), and PCIe controller interfaces.</p>
</section>
<section id="scope">
<h3>1.2 Scope<a class="headerlink" href="#scope" title="Permalink to this heading"></a></h3>
<p>The Keraunos PCIe Tile integrates:</p>
<ul class="simple">
<li><p><strong>3 fabric switches</strong> for routing traffic between NOC, SMN, and PCIe domains</p></li>
<li><p><strong>8 Translation Lookaside Buffers (TLBs)</strong> for address translation (5 inbound, 3 outbound)</p></li>
<li><p><strong>MSI-X relay unit</strong> for interrupt handling</p></li>
<li><p><strong>System Information Interface (SII)</strong> for PCIe configuration tracking</p></li>
<li><p><strong>Configuration register block</strong> for tile-level control</p></li>
<li><p><strong>Clock and reset control</strong> infrastructure</p></li>
</ul>
</section>
<section id="definitions-and-acronyms">
<h3>1.3 Definitions and Acronyms<a class="headerlink" href="#definitions-and-acronyms" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>CII</strong></p></td>
<td><p>Configuration Intercept Interface - PCIe config space write detection</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DECERR</strong></p></td>
<td><p>Decode Error - TLM address error response</p></td>
</tr>
<tr class="row-even"><td><p><strong>MSI-X</strong></p></td>
<td><p>Message Signaled Interrupts - Extended</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NOC</strong></p></td>
<td><p>Network-on-Chip</p></td>
</tr>
<tr class="row-even"><td><p><strong>PBA</strong></p></td>
<td><p>Pending Bit Array (for MSI-X)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>SII</strong></p></td>
<td><p>System Information Interface</p></td>
</tr>
<tr class="row-even"><td><p><strong>SMN</strong></p></td>
<td><p>System Management Network</p></td>
</tr>
<tr class="row-odd"><td><p><strong>TLB</strong></p></td>
<td><p>Translation Lookaside Buffer</p></td>
</tr>
<tr class="row-even"><td><p><strong>TLM</strong></p></td>
<td><p>Transaction Level Modeling</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="architecture-overview">
<h2>2. Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permalink to this heading"></a></h2>
<section id="top-level-architecture">
<h3>2.1 Top-Level Architecture<a class="headerlink" href="#top-level-architecture" title="Permalink to this heading"></a></h3>
<p>The Keraunos PCIe Tile acts as a bridge between three major interconnect domains:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────────┐
│                    Keraunos PCIe Tile                           │
│                                                                 │
│  NOC-N ──────► NOC-PCIE ──┬──► Inbound TLBs ──► NOC-IO ──► NOC-N│
│  (Target/Init)  Switch    │    (5 instances)     Switch    (Out)│
│                           │                                     │
│                           └──► Outbound TLBs ◄── NOC-IO ◄────┘  │
│                                (3 instances)     Switch         │
│                                                                 │
│  SMN-N ──────► SMN-IO ────┬──► Config Registers                │
│  (Target/Init)  Switch    ├──► TLB Config (8x)                 │
│                           ├──► MSI Relay Config                │
│                           ├──► SII Config (APB)                │
│                           ├──► PCIe PHY Config                 │
│                           └──► Bypass (TLB Sys)                │
│                                                                 │
│  PCIe Ctrl ──► NOC-PCIE ──┬──► Inbound paths (via TLBs)        │
│  (Target/Init)  Switch    ├──► Bypass paths (NOC-IO/SMN-IO)    │
│                           └──► Status Register (route 0xE/0xF)  │
│                                                                 │
│  Clock/Reset Control ◄──── cold_reset_n, warm_reset_n          │
│  SII Block ◄──────────────── CII inputs (config intercept)     │
│  MSI Relay ◄──────────────── MSI input traffic (from NOC-IO)   │
│                                                                 │
│  Interrupt Outputs: config_update, FLR, hot_reset, RAS, DMA... │
└─────────────────────────────────────────────────────────────────┘
</pre></div>
</div>
</section>
<section id="design-principles">
<h3>2.2 Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>C++ Implementation:</strong> All internal components are C++ classes (not SystemC modules) for performance and simplicity.</p></li>
<li><p><strong>Function Callbacks:</strong> Internal communication uses C++ function callbacks instead of TLM sockets.</p></li>
<li><p><strong>RAII Memory Management:</strong> Smart pointers (<code class="docutils literal notranslate"><span class="pre">std::unique_ptr</span></code>) for automatic resource cleanup.</p></li>
<li><p><strong>Address-Based Routing:</strong> Upper address bits [63:60] determine routing paths.</p></li>
<li><p><strong>Signal-Based Control:</strong> Control plane uses <code class="docutils literal notranslate"><span class="pre">sc_signal</span></code> for isolation, reset, and configuration tracking.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="block-diagram">
<h2>3. Block Diagram<a class="headerlink" href="#block-diagram" title="Permalink to this heading"></a></h2>
<section id="tile-level-block-diagram">
<h3>3.1 Tile-Level Block Diagram<a class="headerlink" href="#tile-level-block-diagram" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                          ┌──────────────────────────────────────────────┐
                          │        KERAUNOS PCIE TILE                    │
                          │                                              │
  ┌──────────┐            │  ┌──────────────────────────────────────┐   │
  │   NOC    │◄───────────┼──┤   NOC-PCIE Switch                    │   │
  │ Network  │────────────┼─►│   - Route decode [63:60]             │   │
  └──────────┘            │  │   - Status reg (0xE/0xF)             │   │
      ▲ ▼                 │  │   - Isolation gating                 │   │
      │ │                 │  └────┬───┬───┬───────────────┬─────────┘   │
      │ │                 │       │   │   │               │             │
      │ │                 │  ┌────▼───▼───▼───┐      ┌────▼──────┐      │
      │ │                 │  │  Inbound TLBs  │      │  Bypass   │      │
      │ │                 │  │  - TLB Sys In0 │      │  Paths    │      │
      │ │                 │  │  - TLB App In0 │      │           │      │
      │ │                 │  │    [0-3] (4x)  │      └─────┬─────┘      │
      │ │                 │  │  - TLB App In1 │            │            │
      │ │                 │  └───────┬────────┘            │            │
      │ │                 │          │                     │            │
      │ │                 │  ┌───────▼─────────────────────▼────────┐   │
      │ └─────────────────┼──┤   NOC-IO Switch                      │   │
      │                   │  │   - NOC-N output                     │   │
      └───────────────────┼──┤   - MSI Relay input                  │   │
                          │  │   - TLB App Out0 route               │   │
                          │  └──────────┬────────────┬──────────────┘   │
                          │             │            │                  │
                          │    ┌────────▼────┐  ┌────▼────────────┐    │
                          │    │  MSI Relay  │  │ Outbound TLBs   │    │
                          │    │  Unit       │  │ - TLB App Out0  │    │
                          │    │  - MSI-X    │  │ - TLB Sys Out0  │    │
                          │    │  - PBA      │  │ - TLB App Out1  │    │
                          │    └─────────────┘  └─────────────────┘    │
                          │                                             │
  ┌──────────┐            │  ┌──────────────────────────────────────┐  │
  │   SMN    │◄───────────┼──┤   SMN-IO Switch                      │  │
  │ Network  │────────────┼─►│   - Config Reg (0x18000000)          │  │
  └──────────┘            │  │   - TLB Config (0x18200000-0x182Fxxxx)│  │
                          │  │   - MSI Config (0x18800000)          │  │
                          │  │   - SII Config (0x18101000)          │  │
                          │  │   - PHY Config (0x18102000/0x18103000)│  │
                          │  │   - TLB Sys bypass                   │  │
                          │  └─────┬────┬────┬────┬──────┬──────────┘  │
                          │        │    │    │    │      │             │
                          │   ┌────▼┐ ┌─▼──┐ │ ┌──▼───┐ │             │
                          │   │Config│ │SII │ │ │ MSI  │ │             │
                          │   │ Reg  │ │Block│ │ │Relay │ │             │
                          │   │Block │ │     │ │ │      │ │             │
                          │   └──────┘ └────┘ │ └──────┘ │             │
                          │                   │          │             │
                          │              ┌────▼──┐  ┌────▼─────┐       │
                          │              │ TLBs  │  │PCIe PHY  │       │
                          │              │Config │  │          │       │
                          │              └───────┘  └──────────┘       │
                          │                                             │
  ┌──────────┐            │  ┌──────────────────────────────────────┐  │
  │   PCIe   │◄───────────┼──┤   PCIe Controller Interface          │  │
  │Controller│────────────┼─►│   - NOC-PCIE Switch (route from PCIe)│  │
  └──────────┘            │  └──────────────────────────────────────┘  │
                          │                                             │
                          │  ┌──────────────────────────────────────┐  │
     Control Inputs       │  │  Clock &amp; Reset Control               │  │
     ────────────────────►│  │  - cold_reset_n                      │  │
     - cold_reset_n       │  │  - warm_reset_n                      │  │
     - warm_reset_n       │  │  - isolate_req (clears enables)      │  │
     - isolate_req        │  └──────────────────────────────────────┘  │
     - pcie_cii_hv        │                                             │
     - pcie_cii_hdr_type  │  ┌──────────────────────────────────────┐  │
     - pcie_cii_hdr_addr  │  │  Interrupt Forwarding                │  │
     - pcie_flr_request   │  │  - config_update (from SII CII)      │  │
     - pcie_hot_reset     │  │  - function_level_reset (FLR fwd)    │  │
     - pcie_ras_error     │  │  - hot_reset_requested (fwd)         │  │
     - pcie_dma_completion│  │  - ras_error (fwd)                   │  │
     - pcie_misc_int      │  │  - dma_completion (fwd)              │  │
                          │  │  - controller_misc_int (fwd)         │  │
                          │  └──────────────────────────────────────┘  │
                          │                                             │
                          └─────────────────────────────────────────────┘
</pre></div>
</div>
</section>
<section id="data-flow-paths">
<h3>3.2 Data Flow Paths<a class="headerlink" href="#data-flow-paths" title="Permalink to this heading"></a></h3>
<p><strong>Inbound Path (PCIe → NOC):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PCIe Controller → NOC-PCIE Switch → Inbound TLB → NOC-IO Switch → NOC Network
                      │                   │
                      │                   └─► Address Translation
                      └─► Route decode [63:60], enable gating
</pre></div>
</div>
<p><strong>Outbound Path (NOC → PCIe):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NOC Network → NOC-IO Switch → Outbound TLB → NOC-PCIE Switch → PCIe Controller
                   │               │
                   │               └─► Address Translation
                   └─► MSI input path (0x18800000)
</pre></div>
</div>
<p><strong>Configuration Path (SMN → Tile Internals):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SMN Network → SMN-IO Switch ──┬─► Config Reg Block (0x18000000)
                              ├─► TLB Config (0x18200000-0x182Fxxxx)
                              ├─► MSI Relay Config (0x18800000)
                              ├─► SII Config APB (0x18101000)
                              ├─► PCIe PHY APB (0x18102000)
                              ├─► PCIe PHY AHB (0x18103000)
                              └─► TLB Sys bypass (inbound/outbound)
</pre></div>
</div>
<p><strong>Bypass Paths:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PCIe Controller → NOC-PCIE Switch ──┬─► Bypass App (route 0x8) → NOC-IO Switch → NOC
                                    └─► Bypass Sys (route 0x9) → SMN-IO Switch → SMN
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="module-descriptions">
<h2>4. Module Descriptions<a class="headerlink" href="#module-descriptions" title="Permalink to this heading"></a></h2>
<section id="noc-pcie-switch">
<h3>4.1 NOC-PCIE Switch<a class="headerlink" href="#noc-pcie-switch" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Routes traffic from PCIe controller to appropriate destination (TLBs, bypass paths, status register).</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>Route Decode:</strong> Address bits [63:60] determine destination</p></li>
<li><p><strong>Status Register:</strong> Routes 0xE and 0xF provide read-only system status</p></li>
<li><p><strong>Isolation Gating:</strong> <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> or <code class="docutils literal notranslate"><span class="pre">!pcie_inbound_enable</span></code> blocks all traffic</p></li>
<li><p><strong>Enable Control:</strong> <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code> gates application traffic</p></li>
</ul>
<p><strong>Route Table:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Route Bits [63:60]</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>TLB App In0 [0]</p></td>
<td><p>Application inbound TLB instance 0</p></td>
</tr>
<tr class="row-odd"><td><p>0x1</p></td>
<td><p>TLB App In1</p></td>
<td><p>Application inbound TLB (large pages)</p></td>
</tr>
<tr class="row-even"><td><p>0x4</p></td>
<td><p>TLB Sys In0</p></td>
<td><p>System inbound TLB</p></td>
</tr>
<tr class="row-odd"><td><p>0x8</p></td>
<td><p>Bypass App</p></td>
<td><p>Direct to NOC-IO (no translation)</p></td>
</tr>
<tr class="row-even"><td><p>0x9</p></td>
<td><p>Bypass Sys</p></td>
<td><p>Direct to SMN-IO (no translation)</p></td>
</tr>
<tr class="row-odd"><td><p>0xE, 0xF</p></td>
<td><p>Status Register</p></td>
<td><p>Read-only status (if <code class="docutils literal notranslate"><span class="pre">system_ready</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>Other</p></td>
<td><p>DECERR</p></td>
<td><p>TLM_ADDRESS_ERROR_RESPONSE</p></td>
</tr>
</tbody>
</table>
<p><strong>Status Register Format (32-bit):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="n">system_ready</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="n">pcie_outbound_app_enable</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="n">pcie_inbound_app_enable</span>
<span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="n">Reserved</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_noc_pcie_switch.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_noc_pcie_switch.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="noc-io-switch">
<h3>4.2 NOC-IO Switch<a class="headerlink" href="#noc-io-switch" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Routes traffic between NOC network and internal tile resources (MSI relay, outbound TLBs).</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>Address-Based Routing:</strong> Upper address bits determine destination</p></li>
<li><p><strong>MSI Input Path:</strong> Routes MSI trigger writes to MSI Relay at 0x18800000</p></li>
<li><p><strong>Outbound TLB Path:</strong> Routes traffic to application outbound TLB for PCIe egress</p></li>
</ul>
<p><strong>Route Logic:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if (addr &amp; 0x18800000) → MSI Relay (process_msi_input)
else                   → TLB App Out0 (process_outbound_traffic)
</pre></div>
</div>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_noc_io_switch.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_noc_io_switch.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="smn-io-switch">
<h3>4.3 SMN-IO Switch<a class="headerlink" href="#smn-io-switch" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Routes SMN configuration traffic to tile configuration registers, TLB config, MSI config, SII, and PCIe PHY.</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>Configuration Access:</strong> All tile-level configuration registers</p></li>
<li><p><strong>TLB Configuration:</strong> 8 TLB instances (5 inbound + 3 outbound)</p></li>
<li><p><strong>Bypass Data Path:</strong> TLB Sys inbound/outbound data traffic (not config)</p></li>
<li><p><strong>Address Passthrough Limitation:</strong> Passes full address to callbacks instead of relative offset</p></li>
</ul>
<p><strong>Address Map:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Base Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Access Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x18000000</p></td>
<td><p>256KB</p></td>
<td><p>MSI Relay Config</p></td>
<td><p>8 PF × 16KB config registers</p></td>
</tr>
<tr class="row-odd"><td><p>0x18040000</p></td>
<td><p>64KB</p></td>
<td><p>Config Reg Block (incl. TLBs)</p></td>
<td><p>TLB config + status registers</p></td>
</tr>
<tr class="row-even"><td><p>0x18050000</p></td>
<td><p>64KB</p></td>
<td><p>SMN-IO Fabric CSR</p></td>
<td><p>Placeholder registers</p></td>
</tr>
<tr class="row-odd"><td><p>0x18080000</p></td>
<td><p>256KB</p></td>
<td><p>SerDes AHB0</p></td>
<td><p>PHY AHB registers</p></td>
</tr>
<tr class="row-even"><td><p>0x180C0000</p></td>
<td><p>256KB</p></td>
<td><p>SerDes APB0</p></td>
<td><p>PHY APB registers</p></td>
</tr>
<tr class="row-odd"><td><p>0x18100000</p></td>
<td><p>1MB</p></td>
<td><p>SII Config (APB Demux)</p></td>
<td><p>APB config space</p></td>
</tr>
<tr class="row-even"><td><p>0x18400000</p></td>
<td><p>1MB</p></td>
<td><p>TLB Sys Outbound data path</p></td>
<td><p>Data path access</p></td>
</tr>
</tbody>
</table>
<p><strong>TLB Config Space within Config Reg Block (0x18040000 - 0x1804FFFF):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Component</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys Out0 Config</p></td>
</tr>
<tr class="row-odd"><td><p>0x1000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out0 Config</p></td>
</tr>
<tr class="row-even"><td><p>0x2000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out1 Config</p></td>
</tr>
<tr class="row-odd"><td><p>0x3000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys In0 Config</p></td>
</tr>
<tr class="row-even"><td><p>0x4000</p></td>
<td><p>16KB</p></td>
<td><p>TLB App In0 [0-3] Config (4 × 4KB)</p></td>
</tr>
<tr class="row-odd"><td><p>0x8000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In1 Config</p></td>
</tr>
<tr class="row-even"><td><p>0xFFF8</p></td>
<td><p>8B</p></td>
<td><p>System enables register</p></td>
</tr>
<tr class="row-odd"><td><p>0xFFFC</p></td>
<td><p>4B</p></td>
<td><p>System ready register</p></td>
</tr>
</tbody>
</table>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_smn_io_switch.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_smn_io_switch.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="translation-lookaside-buffers-tlbs">
<h3>4.4 Translation Lookaside Buffers (TLBs)<a class="headerlink" href="#translation-lookaside-buffers-tlbs" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Translate between PCIe IATU (Internal Address Translation Unit) addresses and system physical addresses.</p>
<p><strong>TLB Instances (8 total):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Page Shift</p></th>
<th class="head"><p>Index Bits</p></th>
<th class="head"><p>Entries</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TLB Sys In0</p></td>
<td><p>Inbound</p></td>
<td><p>1</p></td>
<td><p>14</p></td>
<td><p>[19:14]</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-odd"><td><p>TLB App In0</p></td>
<td><p>Inbound</p></td>
<td><p>4</p></td>
<td><p>24</p></td>
<td><p>[29:24]</p></td>
<td><p>64 each</p></td>
</tr>
<tr class="row-even"><td><p>TLB App In1</p></td>
<td><p>Inbound</p></td>
<td><p>1</p></td>
<td><p>33</p></td>
<td><p>[38:33]</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-odd"><td><p>TLB Sys Out0</p></td>
<td><p>Outbound</p></td>
<td><p>1</p></td>
<td><p>14</p></td>
<td><p>[19:14]</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-even"><td><p>TLB App Out0</p></td>
<td><p>Outbound</p></td>
<td><p>1</p></td>
<td><p>24</p></td>
<td><p>[29:24]</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-odd"><td><p>TLB App Out1</p></td>
<td><p>Outbound</p></td>
<td><p>1</p></td>
<td><p>33</p></td>
<td><p>[38:33]</p></td>
<td><p>64</p></td>
</tr>
</tbody>
</table>
<p><strong>Translation Algorithm (Inbound):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. index = (iatu_address &gt;&gt; page_shift) &amp; 0x3F
2. if (index &gt;= 64 || !entries[index].valid) → DECERR
3. translated_addr = (entries[index].addr &lt;&lt; 12) | (iatu_address &amp; page_mask)
4. axuser = entries[index].attr
5. Continue to next stage with translated address
</pre></div>
</div>
<p><strong>TLB Entry Structure:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">valid</span><span class="p">:</span>       <span class="mi">1</span> <span class="n">bit</span>    <span class="o">-</span> <span class="n">Entry</span> <span class="n">valid</span> <span class="n">flag</span>
<span class="n">addr</span><span class="p">:</span>        <span class="mi">52</span> <span class="n">bits</span>  <span class="o">-</span> <span class="n">Translated</span> <span class="n">address</span> <span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
<span class="n">attr</span><span class="p">:</span>        <span class="mi">32</span> <span class="n">bits</span>  <span class="o">-</span> <span class="n">AxUSER</span> <span class="n">attributes</span>
</pre></div>
</div>
<p><strong>Default Configuration:</strong></p>
<ul class="simple">
<li><p>Entry 0: valid=true (default-initialized, allows basic traffic flow)</p></li>
<li><p>Entries 1-63: valid=false (must be configured via SMN)</p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_inbound_tlb.h</span></code> / <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> (5 inbound TLB classes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_outbound_tlb.h</span></code> / <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> (3 outbound TLB classes)</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="msi-relay-unit">
<h3>4.5 MSI Relay Unit<a class="headerlink" href="#msi-relay-unit" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Relay MSI-X interrupts from software (via NOC) to PCIe controller.</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>MSI-X Table:</strong> 16 entries (address, data, per-vector mask)</p></li>
<li><p><strong>Pending Bit Array (PBA):</strong> 16-bit PBA for pending MSI tracking</p></li>
<li><p><strong>Global Mask:</strong> MSI-X mask and enable control</p></li>
<li><p><strong>Outstanding Counter:</strong> Tracks in-flight MSIs</p></li>
</ul>
<p><strong>MSI Generation Flow:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Software writes to MSI input address (0x18800000) via NOC
2. MSI relay checks: msix_enable &amp;&amp; !global_mask &amp;&amp; !vector_mask
3. If conditions met: generate MSI to PCIe controller
4. Increment msi_outstanding counter
5. Set PBA bit if unable to send immediately
</pre></div>
</div>
<p><strong>Configuration Registers (via SMN at 0x18800000):</strong></p>
<ul class="simple">
<li><p><strong>MSI-X Table:</strong> Offset 0x0000-0x00FF (16 entries × 16 bytes)</p>
<ul>
<li><p>Entry format: [63:0] address, [95:64] data, [96] mask, [127:97] reserved</p></li>
</ul>
</li>
<li><p><strong>Pending Bit Array:</strong> Offset 0x0100-0x0103 (16 bits, read-only)</p></li>
<li><p><strong>Outstanding Counter:</strong> Internal counter (read via status query)</p></li>
</ul>
<p><strong>Known Limitation (Address Passthrough):</strong></p>
<ul class="simple">
<li><p>MSI input path expects offset=0 for PBA bit setting</p></li>
<li><p>NOC-IO switch passes full address 0x18800000 to <code class="docutils literal notranslate"><span class="pre">process_msi_input()</span></code></p></li>
<li><p>PBA bits are never set due to offset mismatch</p></li>
<li><p>MSI generation still functional for basic relay</p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_msi_relay.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_msi_relay.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="system-information-interface-sii-block">
<h3>4.6 System Information Interface (SII) Block<a class="headerlink" href="#system-information-interface-sii-block" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Track PCIe configuration space updates via CII (Configuration Intercept Interface) and generate <code class="docutils literal notranslate"><span class="pre">config_update</span></code> interrupt.</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>CII Tracking:</strong> Monitors PCIe controller config writes (type 0x04, first 128 bytes)</p></li>
<li><p><strong>Accumulated Bitmask:</strong> 32-bit <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> register with RW1C semantics</p></li>
<li><p><strong>Interrupt Generation:</strong> Asserts <code class="docutils literal notranslate"><span class="pre">config_update</span></code> when any <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> bit is set</p></li>
<li><p><strong>APB Configuration:</strong> Bus/device number, device type, system interrupt control</p></li>
</ul>
<p><strong>CII Detection Logic:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">pcie_cii_hv</span> <span class="o">=</span> <span class="n">true</span> <span class="p">(</span><span class="n">CII</span> <span class="n">header</span> <span class="n">valid</span><span class="p">)</span>
<span class="mf">2.</span> <span class="n">Check</span> <span class="n">pcie_cii_hdr_type</span> <span class="o">==</span> <span class="mh">0x04</span> <span class="p">(</span><span class="n">config</span> <span class="n">write</span><span class="p">)</span>
<span class="mf">3.</span> <span class="n">Check</span> <span class="n">pcie_cii_hdr_addr</span> <span class="o">&lt;</span> <span class="mh">0x080</span> <span class="p">(</span><span class="n">first</span> <span class="mi">128</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">config</span> <span class="n">space</span><span class="p">)</span>
<span class="mf">4.</span> <span class="n">If</span> <span class="nb">all</span> <span class="n">true</span><span class="p">:</span> <span class="n">reg_index</span> <span class="o">=</span> <span class="n">addr</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="nb">set</span> <span class="n">cfg_modified</span><span class="p">[</span><span class="n">reg_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="mf">5.</span> <span class="n">Assert</span> <span class="n">config_update</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
<p><strong>CDC Synchronization:</strong></p>
<ul class="simple">
<li><p>CII inputs from PCIe clock domain</p></li>
<li><p>Synchronize <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> bitmask to APB clock domain</p></li>
<li><p>Write synchronized value to SCML2 memory for software readback</p></li>
</ul>
<p><strong>APB Registers (via SMN at 0x18101000):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Register</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0000</p></td>
<td><p>CORE_CONTROL</p></td>
<td><p>RW</p></td>
<td><p>Device type [2:0]: 0x4=RP, others=EP</p></td>
</tr>
<tr class="row-odd"><td><p>0x0004</p></td>
<td><p>CFG_MODIFIED</p></td>
<td><p>RW1C</p></td>
<td><p>Config modified bitmask (32 bits)</p></td>
</tr>
<tr class="row-even"><td><p>0x0008</p></td>
<td><p>BUS_DEV_NUM</p></td>
<td><p>RW</p></td>
<td><p>Bus number [15:8], Device number [7:0]</p></td>
</tr>
</tbody>
</table>
<p><strong>Interrupt Clear:</strong></p>
<ul class="simple">
<li><p>Software write-1-to-clear (RW1C) to CFG_MODIFIED register</p></li>
<li><p><strong>Limitation:</strong> Address passthrough blocks SMN writes from reaching SII</p></li>
<li><p>Alternative: <code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code> pulse clears <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> and deasserts <code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_sii.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_sii.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="configuration-register-block">
<h3>4.7 Configuration Register Block<a class="headerlink" href="#configuration-register-block" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Tile-level control registers for system readiness and isolation.</p>
<p><strong>Key Registers (accessed via SMN at 0x18000000):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset</p></th>
<th class="head"><p>Register</p></th>
<th class="head"><p>Bits</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0000</p></td>
<td><p>SYSTEM_CONTROL</p></td>
<td><p>[0]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">system_ready</span></code> - Master enable</p></td>
</tr>
<tr class="row-odd"><td><p>0x0004</p></td>
<td><p>ENABLE_CONTROL</p></td>
<td><p>[1:0]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable</span></code></p></td>
</tr>
<tr class="row-even"><td><p>0x0008</p></td>
<td><p>ISOLATION_CONTROL</p></td>
<td><p>[0]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> - Isolation request</p></td>
</tr>
</tbody>
</table>
<p><strong>Isolation Mechanism:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">When</span> <span class="n">isolate_req</span> <span class="ow">is</span> <span class="n">asserted</span> <span class="p">(</span><span class="nb">set</span> <span class="n">to</span> <span class="n">true</span><span class="p">):</span>
<span class="mf">1.</span> <span class="n">system_ready</span> <span class="o">=</span> <span class="n">false</span>
<span class="mf">2.</span> <span class="n">pcie_outbound_app_enable</span> <span class="o">=</span> <span class="n">false</span>
<span class="mf">3.</span> <span class="n">pcie_inbound_app_enable</span> <span class="o">=</span> <span class="n">false</span>
<span class="mf">4.</span> <span class="n">NOC</span><span class="o">-</span><span class="n">PCIE</span> <span class="n">switch</span> <span class="n">blocks</span> <span class="nb">all</span> <span class="n">inbound</span> <span class="n">traffic</span> <span class="p">(</span><span class="n">returns</span> <span class="n">DECERR</span><span class="p">)</span>

<span class="n">When</span> <span class="n">isolate_req</span> <span class="ow">is</span> <span class="n">deasserted</span> <span class="p">(</span><span class="nb">set</span> <span class="n">to</span> <span class="n">false</span><span class="p">):</span>
<span class="mf">1.</span> <span class="n">isolate_req</span> <span class="n">flag</span> <span class="n">cleared</span>
<span class="mf">2.</span> <span class="n">Enables</span> <span class="n">NOT</span> <span class="n">restored</span> <span class="p">(</span><span class="n">permanent</span> <span class="n">state</span> <span class="n">loss</span><span class="p">)</span>
<span class="mf">3.</span> <span class="n">Requires</span> <span class="n">external</span> <span class="n">software</span> <span class="n">reconfiguration</span> <span class="n">to</span> <span class="n">restore</span> <span class="n">traffic</span> <span class="n">flow</span>
</pre></div>
</div>
<p><strong>Known Limitation:</strong></p>
<ul class="simple">
<li><p>No reset handler to restore enables after isolation</p></li>
<li><p>De-asserting <code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> does not restore <code class="docutils literal notranslate"><span class="pre">system_ready</span></code> or enable bits</p></li>
<li><p>Cold/warm reset does not restore enables (only initialized in constructor)</p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_config_reg.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_config_reg.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="clock-and-reset-control">
<h3>4.8 Clock and Reset Control<a class="headerlink" href="#clock-and-reset-control" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Manage clock distribution and reset sequencing for tile internals.</p>
<p><strong>Clocks:</strong></p>
<ul class="simple">
<li><p><strong>pcie_core_clk:</strong> PCIe controller core clock input</p></li>
<li><p><strong>axi_clk:</strong> AXI interface clock input</p></li>
<li><p><strong>pcie_clock_:</strong> Internal PCIe clock signal (derived)</p></li>
<li><p><strong>ref_clock_:</strong> Reference clock for PLL</p></li>
</ul>
<p><strong>Resets:</strong></p>
<ul class="simple">
<li><p><strong>cold_reset_n:</strong> Full tile reset (active low)</p>
<ul>
<li><p>Resets: <code class="docutils literal notranslate"><span class="pre">pcie_sii_reset_ctrl_</span></code>, <code class="docutils literal notranslate"><span class="pre">pcie_reset_ctrl_</span></code></p></li>
<li><p>Does NOT reset: enables, TLBs, <code class="docutils literal notranslate"><span class="pre">system_ready</span></code></p></li>
</ul>
</li>
<li><p><strong>warm_reset_n:</strong> Warm reset (active low)</p>
<ul>
<li><p>Resets: Same as cold reset</p></li>
</ul>
</li>
<li><p><strong>pcie_controller_reset_n:</strong> PCIe controller-specific reset</p>
<ul>
<li><p>Clears SII <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> bitmask and deasserts <code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></li>
</ul>
</li>
</ul>
<p><strong>Reset Scope:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cold</span><span class="o">/</span><span class="n">Warm</span> <span class="n">Reset</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Affects</span><span class="p">:</span> <span class="n">Clock</span><span class="o">/</span><span class="n">Reset</span> <span class="n">control</span> <span class="n">block</span> <span class="n">internal</span> <span class="n">state</span>
<span class="o">-</span> <span class="n">Preserves</span><span class="p">:</span> <span class="n">Configuration</span> <span class="n">registers</span><span class="p">,</span> <span class="n">TLB</span> <span class="n">entries</span><span class="p">,</span> <span class="n">enable</span> <span class="n">flags</span>

<span class="n">PCIe</span> <span class="n">Controller</span> <span class="n">Reset</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Affects</span><span class="p">:</span> <span class="n">SII</span> <span class="n">cfg_modified</span> <span class="n">register</span><span class="p">,</span> <span class="n">config_update</span> <span class="n">interrupt</span>
<span class="o">-</span> <span class="n">Preserves</span><span class="p">:</span> <span class="n">All</span> <span class="n">other</span> <span class="n">state</span>
</pre></div>
</div>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_clock_reset.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_clock_reset.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="pcie-phy-model">
<h3>4.9 PCIe PHY Model<a class="headerlink" href="#pcie-phy-model" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Placeholder model for PCIe PHY (SERDES) configuration.</p>
<p><strong>Interfaces:</strong></p>
<ul class="simple">
<li><p><strong>APB Configuration:</strong> Accessed via SMN at 0x18102000</p></li>
<li><p><strong>AHB Configuration:</strong> Accessed via SMN at 0x18103000</p></li>
</ul>
<p><strong>Functionality:</strong></p>
<ul class="simple">
<li><p>Provides configuration register space for PHY settings</p></li>
<li><p>No actual signal-level simulation (TLM abstraction)</p></li>
<li><p>Returns TLM_OK_RESPONSE for all accesses</p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_phy.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_phy.cpp</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="pll-cgm-clock-generation-module">
<h3>4.10 PLL/CGM (Clock Generation Module)<a class="headerlink" href="#pll-cgm-clock-generation-module" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Placeholder model for PLL and clock generation.</p>
<p><strong>Functionality:</strong></p>
<ul class="simple">
<li><p>Manages internal clock generation from reference clock</p></li>
<li><p>Provides clock gating control</p></li>
<li><p>No detailed implementation (placeholder for future expansion)</p></li>
</ul>
<p><strong>Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_pll_cgm.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keraunos_pcie_pll_cgm.cpp</span></code></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="interface-specifications">
<h2>5. Interface Specifications<a class="headerlink" href="#interface-specifications" title="Permalink to this heading"></a></h2>
<section id="external-tlm-sockets">
<h3>5.1 External TLM Sockets<a class="headerlink" href="#external-tlm-sockets" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Socket Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>NOC → Tile (outbound traffic)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">noc_n_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → NOC (inbound traffic forwarded)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>SMN → Tile (config/data)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">smn_n_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → SMN (bypass/data forwarded)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_target</span></code></p></td>
<td><p>Target</p></td>
<td><p>64-bit</p></td>
<td><p>Inbound</p></td>
<td><p>PCIe → Tile (inbound traffic)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_initiator</span></code></p></td>
<td><p>Initiator</p></td>
<td><p>64-bit</p></td>
<td><p>Outbound</p></td>
<td><p>Tile → PCIe (outbound traffic forwarded)</p></td>
</tr>
</tbody>
</table>
<p>*Note: These are <code class="docutils literal notranslate"><span class="pre">tlm_utils::simple_initiator_socket&lt;64&gt;</span></code> types that forward outbound transactions to the external interconnect. In the testbench, <code class="docutils literal notranslate"><span class="pre">scml2::testing::initiator_socket_proxy</span></code> instances receive these transactions into <code class="docutils literal notranslate"><span class="pre">sparse_backing_memory</span></code> for cross-socket data verification.</p>
<p><strong>TLM Protocol:</strong></p>
<ul class="simple">
<li><p><strong>Transport:</strong> Blocking transport (<code class="docutils literal notranslate"><span class="pre">b_transport</span></code>)</p></li>
<li><p><strong>Address:</strong> 64-bit byte addressing</p></li>
<li><p><strong>Data:</strong> Variable length (1, 2, 4, 8 bytes typical)</p></li>
<li><p><strong>Response:</strong> TLM_OK_RESPONSE or TLM_ADDRESS_ERROR_RESPONSE</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="control-input-signals">
<h3>5.2 Control Input Signals<a class="headerlink" href="#control-input-signals" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Cold reset (active low)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Warm reset (active low)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Isolation request (clears enables)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hv</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>CII header valid</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_type</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>5</p></td>
<td><p>CII header type (0x04=config write)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_cii_hdr_addr</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>12</p></td>
<td><p>CII header address [11:0]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>PCIe core clock</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>PCIe controller reset (active low)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_flr_request</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Function-level reset request</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_hot_reset</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Hot reset indication</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_ras_error</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>RAS error indication</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_dma_completion</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>DMA completion indication</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_misc_int</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>Miscellaneous interrupt</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axi_clk</span></code></p></td>
<td><p>sc_in</p></td>
<td><p>1</p></td>
<td><p>AXI clock</p></td>
</tr>
</tbody>
</table>
<p><strong>Signal Propagation:</strong></p>
<ul class="simple">
<li><p>All signals require <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> to propagate changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal_update_process()</span></code> sensitive to all control inputs</p></li>
<li><p>Updates internal state and output signals each delta cycle</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="output-signals">
<h3>5.3 Output Signals<a class="headerlink" href="#output-signals" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_bus_num</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>8</p></td>
<td><p>Application bus number (from SII)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_app_dev_num</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>8</p></td>
<td><p>Application device number (from SII)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_device_type</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>Device type: 0=EP, 1=RP (from SII)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_sys_int</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>System interrupt (from SII, always 0)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">function_level_reset</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>FLR forwarded from PCIe controller</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hot_reset_requested</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>Hot reset forwarded from PCIe controller</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>Config update interrupt (from SII CII)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ras_error</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>RAS error forwarded from PCIe controller</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dma_completion</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>DMA completion forwarded from PCIe controller</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controller_misc_int</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>1</p></td>
<td><p>Misc interrupt forwarded from PCIe controller</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noc_timeout</span></code></p></td>
<td><p>sc_out</p></td>
<td><p>3</p></td>
<td><p>NOC timeout status (reserved)</p></td>
</tr>
</tbody>
</table>
<p><strong>Output Update:</strong></p>
<ul class="simple">
<li><p>All outputs driven by <code class="docutils literal notranslate"><span class="pre">signal_update_process()</span></code></p></li>
<li><p>Updated on every delta cycle when inputs change</p></li>
<li><p>Initialized to default values in <code class="docutils literal notranslate"><span class="pre">end_of_elaboration()</span></code></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="internal-signals">
<h3>5.4 Internal Signals<a class="headerlink" href="#internal-signals" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Signal Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Width</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">system_ready_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>Master enable for tile (affects NOC-PCIE routing)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_outbound_app_enable_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>Enable outbound application traffic</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_inbound_app_enable_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>Enable inbound application traffic</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">msix_enable_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>MSI-X global enable (not externally accessible)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">msix_mask_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>MSI-X global mask (not externally accessible)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">setip_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>16</p></td>
<td><p>Set interrupt pending (reserved)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_clock_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>Internal PCIe clock</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ref_clock_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>Reference clock</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_sii_reset_ctrl_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>SII reset control</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_reset_ctrl_</span></code></p></td>
<td><p>sc_signal</p></td>
<td><p>1</p></td>
<td><p>PCIe reset control</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="address-map">
<h2>6. Address Map<a class="headerlink" href="#address-map" title="Permalink to this heading"></a></h2>
<section id="inbound-address-map-pcie-noc-smn">
<h3>6.1 Inbound Address Map (PCIe → NOC/SMN)<a class="headerlink" href="#inbound-address-map-pcie-noc-smn" title="Permalink to this heading"></a></h3>
<p><strong>Route Decode (bits [63:60]):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Route</p></th>
<th class="head"><p>Address Range</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0</p></td>
<td><p>0x0xxxxxxxxxxxxxxx</p></td>
<td><p>TLB App In0 [0]</p></td>
<td><p>16MB pages, index [29:24]</p></td>
</tr>
<tr class="row-odd"><td><p>0x1</p></td>
<td><p>0x1xxxxxxxxxxxxxxx</p></td>
<td><p>TLB App In1</p></td>
<td><p>8GB pages, index [38:33]</p></td>
</tr>
<tr class="row-even"><td><p>0x4</p></td>
<td><p>0x4xxxxxxxxxxxxxxx</p></td>
<td><p>TLB Sys In0</p></td>
<td><p>16KB pages, index [19:14]</p></td>
</tr>
<tr class="row-odd"><td><p>0x8</p></td>
<td><p>0x8xxxxxxxxxxxxxxx</p></td>
<td><p>Bypass App (NOC-IO)</p></td>
<td><p>No translation</p></td>
</tr>
<tr class="row-even"><td><p>0x9</p></td>
<td><p>0x9xxxxxxxxxxxxxxx</p></td>
<td><p>Bypass Sys (SMN-IO)</p></td>
<td><p>No translation</p></td>
</tr>
<tr class="row-odd"><td><p>0xE</p></td>
<td><p>0xExxxxxxxxxxxxxxx</p></td>
<td><p>Status Register (RO)</p></td>
<td><p>Read-only, 32-bit status</p></td>
</tr>
<tr class="row-even"><td><p>0xF</p></td>
<td><p>0xFxxxxxxxxxxxxxxx</p></td>
<td><p>Status Register (RO)</p></td>
<td><p>Same as 0xE</p></td>
</tr>
<tr class="row-odd"><td><p>Other</p></td>
<td><p>-</p></td>
<td><p>DECERR</p></td>
<td><p>TLM_ADDRESS_ERROR_RESPONSE</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configuration-address-map-smn">
<h3>6.2 Configuration Address Map (SMN)<a class="headerlink" href="#configuration-address-map-smn" title="Permalink to this heading"></a></h3>
<p><strong>SMN-IO Switch Routes (base = 0x18000000):</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Base Address</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Module</p></th>
<th class="head"><p>Registers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x18040000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys Out0 Config</p></td>
<td><p>TLB entry config (16 entries × 64B)</p></td>
</tr>
<tr class="row-odd"><td><p>0x18041000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out0 Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18042000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App Out1 Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18043000</p></td>
<td><p>4KB</p></td>
<td><p>TLB Sys In0 Config</p></td>
<td><p>TLB entry config (64 entries × 64B)</p></td>
</tr>
<tr class="row-even"><td><p>0x18044000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [0] Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18045000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [1] Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18046000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [2] Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18047000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In0 [3] Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-even"><td><p>0x18048000</p></td>
<td><p>4KB</p></td>
<td><p>TLB App In1 Config</p></td>
<td><p>TLB entry config</p></td>
</tr>
<tr class="row-odd"><td><p>0x18000000</p></td>
<td><p>256KB</p></td>
<td><p>MSI Relay Config</p></td>
<td><p>MSI-X table, PBA, mask control</p></td>
</tr>
<tr class="row-even"><td><p>0x18100000</p></td>
<td><p>1MB</p></td>
<td><p>SII Config (APB)</p></td>
<td><p>CORE_CONTROL, CFG_MODIFIED, BUS_DEV</p></td>
</tr>
</tbody>
</table>
<p><strong>Address Passthrough Issue:</strong></p>
<ul class="simple">
<li><p>SMN-IO switch passes <strong>full address</strong> to config callbacks</p></li>
<li><p>Callbacks expect <strong>offset</strong> within 4KB range</p></li>
<li><p>Example: Write to 0x18800000 passes offset=0x18800000 (not 0x0000)</p></li>
<li><p>Impact: Most config writes are rejected or routed incorrectly</p></li>
</ul>
</section>
<section id="msi-relay-address-map-0x18800000">
<h3>6.3 MSI Relay Address Map (0x18800000)<a class="headerlink" href="#msi-relay-address-map-0x18800000" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Offset Range</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0000-0x000F</p></td>
<td><p>16B</p></td>
<td><p>MSI-X Table Entry 0</p></td>
</tr>
<tr class="row-odd"><td><p>0x0010-0x001F</p></td>
<td><p>16B</p></td>
<td><p>MSI-X Table Entry 1</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>0x00F0-0x00FF</p></td>
<td><p>16B</p></td>
<td><p>MSI-X Table Entry 15</p></td>
</tr>
<tr class="row-even"><td><p>0x0100-0x0103</p></td>
<td><p>4B</p></td>
<td><p>Pending Bit Array (PBA) - read-only</p></td>
</tr>
<tr class="row-odd"><td><p>0x0104-0x0FFF</p></td>
<td><p>-</p></td>
<td><p>Reserved</p></td>
</tr>
</tbody>
</table>
<p><strong>MSI-X Table Entry Format (16 bytes):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>   <span class="n">Message</span> <span class="n">Address</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span>
<span class="p">[</span><span class="mi">95</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>  <span class="n">Message</span> <span class="n">Data</span> <span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span>
<span class="p">[</span><span class="mi">96</span><span class="p">]</span>     <span class="n">Per</span><span class="o">-</span><span class="n">Vector</span> <span class="n">Mask</span> <span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
<span class="p">[</span><span class="mi">127</span><span class="p">:</span><span class="mi">97</span><span class="p">]</span> <span class="n">Reserved</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-flow">
<h2>7. Data Flow<a class="headerlink" href="#data-flow" title="Permalink to this heading"></a></h2>
<section id="inbound-data-flow-pcie-noc">
<h3>7.1 Inbound Data Flow (PCIe → NOC)<a class="headerlink" href="#inbound-data-flow-pcie-noc" title="Permalink to this heading"></a></h3>
<p><strong>Scenario:</strong> PCIe controller initiates memory write to NOC memory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Step 1: PCIe Controller → pcie_controller_target socket
        trans.address = 0x1000000000001000  // Route=0x1 (TLB App In1)
        trans.command = TLM_WRITE_COMMAND
        trans.data    = {payload}

Step 2: KeraunosPcieTile::pcie_controller_target_b_transport()
        → noc_pcie_switch_-&gt;route_from_pcie(trans, delay)

Step 3: NocPcieSwitch::route_from_pcie()
        - Check: isolate_req || !pcie_inbound_enable → BLOCKED if true
        - Extract route_bits = (addr &gt;&gt; 60) &amp; 0xF = 0x1
        - Route decision: case 0x1 → TLB_APP_1

Step 4: NocPcieSwitch calls tlb_app_inbound1_ callback
        → TLBAppIn1::process_inbound_traffic(trans, delay)

Step 5: TLBAppIn1::process_inbound_traffic()
        - index = (0x1000000000001000 &gt;&gt; 33) &amp; 0x3F = 0
        - Check entries[0].valid → TRUE (default)
        - translated_addr = (entries[0].addr &lt;&lt; 12) | (0x1000000000001000 &amp; page_mask)
        - trans.set_address(translated_addr)
        - trans.set_response_status(TLM_OK_RESPONSE)
        - Return to switch

Step 6: NocPcieSwitch forwards to noc_io_ callback
        → NocIoSwitch::route_from_inbound_tlb(trans, delay)

Step 7: NocIoSwitch routes to noc_n_output_ callback
        → KeraunosPcieTile::set_noc_n_output()
        → Forwards via noc_n_initiator.b_transport(trans, delay)
        → In testbench: sparse_backing_memory stores data at translated address

Step 8: Response propagates back to PCIe controller
        trans.get_response_status() = TLM_OK_RESPONSE
</pre></div>
</div>
</section>
<section id="outbound-data-flow-noc-pcie">
<h3>7.2 Outbound Data Flow (NOC → PCIe)<a class="headerlink" href="#outbound-data-flow-noc-pcie" title="Permalink to this heading"></a></h3>
<p><strong>Scenario:</strong> NOC initiates memory read from PCIe device memory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Step 1: NOC → noc_n_target socket
        trans.address = 0x10001000000000  // Outbound traffic
        trans.command = TLM_READ_COMMAND

Step 2: KeraunosPcieTile::noc_n_target_b_transport()
        → noc_io_switch_-&gt;route_from_noc(trans, delay)

Step 3: NocIoSwitch::route_from_noc()
        - Check address range
        - Route to TLB App Out0 callback

Step 4: TLBAppOut0::process_outbound_traffic(trans, delay)
        - index = (addr &gt;&gt; 24) &amp; 0x3F
        - Lookup entry, translate address
        - Set translated address in trans

Step 5: Route to NOC-PCIE switch
        → noc_pcie_switch_-&gt;route_to_pcie(trans, delay)

Step 6: NocPcieSwitch calls pcie_controller_output_ callback
        → KeraunosPcieTile::set_pcie_controller_output()
        → Forwards via pcie_controller_initiator.b_transport(trans, delay)
        → In testbench: sparse_backing_memory stores/returns data

Step 7: Response propagates back to NOC
</pre></div>
</div>
</section>
<section id="configuration-access-flow-smn-config-registers">
<h3>7.3 Configuration Access Flow (SMN → Config Registers)<a class="headerlink" href="#configuration-access-flow-smn-config-registers" title="Permalink to this heading"></a></h3>
<p><strong>Scenario:</strong> Software writes to SII CFG_MODIFIED register via SMN.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Step 1: SMN → smn_n_target socket
        trans.address = 0x18101004  // SII CFG_MODIFIED register
        trans.command = TLM_WRITE_COMMAND
        trans.data    = {0x00000010}  // RW1C clear bit 4

Step 2: KeraunosPcieTile::smn_n_target_b_transport()
        → smn_io_switch_-&gt;route_from_smn(trans, delay)

Step 3: SmnIoSwitch::route_from_smn()
        - Check addr == 0x18101004
        - Route to SII config callback
        - Call: sii_block_-&gt;process_apb_access(trans, delay)

Step 4: SiiBlock::process_apb_access()
        - ISSUE: Receives addr = 0x18101004 (full address)
        - Expects offset = 0x0004 (relative to 0x18101000 base)
        - Offset check fails: 0x18101004 &gt; 64KB SCML2 memory range
        - Returns: TLM_ADDRESS_ERROR_RESPONSE

Step 5: Response: Write rejected due to address passthrough

Result: Config write blocked by address passthrough limitation.
</pre></div>
</div>
</section>
<section id="msi-generation-flow-noc-pcie-via-msi-relay">
<h3>7.4 MSI Generation Flow (NOC → PCIe via MSI Relay)<a class="headerlink" href="#msi-generation-flow-noc-pcie-via-msi-relay" title="Permalink to this heading"></a></h3>
<p><strong>Scenario:</strong> Software triggers MSI by writing to MSI input address.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Step 1: NOC → noc_n_target socket
        trans.address = 0x18800000  // MSI input address
        trans.command = TLM_WRITE_COMMAND
        trans.data    = {0x00000003}  // Vector 3

Step 2: NocIoSwitch::route_from_noc()
        - Detects addr &amp; 0x18800000
        - Routes to MSI relay input callback
        - Call: msi_relay_-&gt;process_msi_input(trans, delay)

Step 3: MsiRelayUnit::process_msi_input()
        - ISSUE: Receives offset = 0x18800000 (expects 0x0000)
        - Offset check: if (offset != 0) → skip PBA bit set
        - PBA bit NOT set due to mismatch
        - Check: msix_enable &amp;&amp; !global_mask &amp;&amp; !vector_mask
        - If all true: generate MSI transaction

Step 4: MSI Relay generates TLM transaction
        - trans.address = msix_table[vector].address
        - trans.data    = msix_table[vector].data
        - Forwards to noc_pcie_switch_-&gt;route_to_pcie()

Step 5: NOC-PCIE switch forwards to PCIe controller
        - PCIe controller processes MSI

Result: MSI successfully delivered, but PBA not updated due to address issue.
</pre></div>
</div>
</section>
<section id="cii-interrupt-flow-pcie-config-write-config-update">
<h3>7.5 CII Interrupt Flow (PCIe Config Write → config_update)<a class="headerlink" href="#cii-interrupt-flow-pcie-config-write-config-update" title="Permalink to this heading"></a></h3>
<p><strong>Scenario:</strong> PCIe host writes to device config space, SII detects and asserts interrupt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Step 1: PCIe Controller signals CII inputs
        pcie_cii_hv.write(true)
        pcie_cii_hdr_type.write(0x04)     // Config write
        pcie_cii_hdr_addr.write(0x010)    // Config offset 0x10

Step 2: signal_update_process() triggered (sensitive to CII inputs)
        - Reads CII input signals
        - Calls: sii_block_-&gt;set_cii_hv(true)
        - Calls: sii_block_-&gt;set_cii_hdr_type(0x04)
        - Calls: sii_block_-&gt;set_cii_hdr_addr(0x010)

Step 3: signal_update_process() calls sii_block_-&gt;update()

Step 4: SiiBlock::update() - CII Tracking Phase
        - Check: cii_hv == true → YES
        - Check: cii_hdr_type == 0x04 → YES
        - Check: cii_hdr_addr &lt; 0x080 → YES (0x010 &lt; 0x080)
        - reg_index = 0x010 &gt;&gt; 2 = 4
        - cii_new_bits = (1 &lt;&lt; 4) = 0x00000010

Step 5: SiiBlock::update() - cfg_modified Update Phase
        - cfg_modified = (cfg_modified &amp; ~cii_clear) | cii_new_bits
        - cfg_modified |= 0x00000010 (bit 4 now set)

Step 6: SiiBlock::update() - Interrupt Generation Phase
        - config_int_ = (cfg_modified != 0) → TRUE

Step 7: signal_update_process() reads SII outputs
        - bool cfg_upd = sii_block_-&gt;get_config_int() → TRUE
        - config_update.write(true)

Step 8: config_update signal propagates to system
        - External interrupt controller sees config_update assertion
        - Software can read CFG_MODIFIED via SII APB (if not blocked by passthrough)

Step 9: Interrupt Clear (via PCIe controller reset)
        pcie_controller_reset_n.write(false)  // Assert reset
        wait(SC_ZERO_TIME)
        pcie_controller_reset_n.write(true)   // Deassert reset
        - SiiBlock::update() sees !reset_n_ → clears cfg_modified
        - config_update deasserts

Result: config_update interrupt lifecycle complete.
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="clock-and-reset-strategy">
<h2>8. Clock and Reset Strategy<a class="headerlink" href="#clock-and-reset-strategy" title="Permalink to this heading"></a></h2>
<section id="clock-domains">
<h3>8.1 Clock Domains<a class="headerlink" href="#clock-domains" title="Permalink to this heading"></a></h3>
<p>The tile operates across multiple clock domains:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Clock Domain</p></th>
<th class="head"><p>Source Signal</p></th>
<th class="head"><p>Modules Affected</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PCIe Core</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pcie_core_clk</span></code></p></td>
<td><p>SII (CII tracking), PCIe PHY, NOC-PCIE switch</p></td>
</tr>
<tr class="row-odd"><td><p>AXI</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">axi_clk</span></code></p></td>
<td><p>NOC-IO switch, SMN-IO switch, TLBs</p></td>
</tr>
<tr class="row-even"><td><p>Internal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pcie_clock_</span></code></p></td>
<td><p>PLL/CGM, clock distribution</p></td>
</tr>
<tr class="row-odd"><td><p>Reference</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ref_clock_</span></code></p></td>
<td><p>PLL input</p></td>
</tr>
</tbody>
</table>
<p><strong>Clock Domain Crossing (CDC):</strong></p>
<ul class="simple">
<li><p><strong>SII CII → APB:</strong> <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code> bitmask synchronized from PCIe clock to APB clock domain</p></li>
<li><p><strong>Method:</strong> Double-flop synchronizer (implicit in <code class="docutils literal notranslate"><span class="pre">SiiBlock::update()</span></code> CDC phase)</p></li>
</ul>
</section>
<section id="reset-strategy">
<h3>8.2 Reset Strategy<a class="headerlink" href="#reset-strategy" title="Permalink to this heading"></a></h3>
<p><strong>Reset Hierarchy:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cold_reset_n (top-level)
    ├─► ClockResetControl::pcie_sii_reset_ctrl_
    └─► ClockResetControl::pcie_reset_ctrl_

pcie_controller_reset_n (PCIe-specific)
    └─► SiiBlock::reset_n_ (clears cfg_modified)

isolate_req (isolation, not true reset)
    ├─► ConfigRegBlock::system_ready = false
    ├─► ConfigRegBlock::pcie_inbound_app_enable = false
    └─► ConfigRegBlock::pcie_outbound_app_enable = false
</pre></div>
</div>
<p><strong>Reset Effects:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reset Signal</p></th>
<th class="head"><p>Affects</p></th>
<th class="head"><p>Preserves</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cold_reset_n</span></code></p></td>
<td><p>Clock/Reset control registers</p></td>
<td><p>Config registers, TLBs, enables, <code class="docutils literal notranslate"><span class="pre">system_ready</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warm_reset_n</span></code></p></td>
<td><p>Same as cold reset</p></td>
<td><p>Same as cold reset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pcie_controller_reset_n</span></code></p></td>
<td><p>SII <code class="docutils literal notranslate"><span class="pre">cfg_modified</span></code>, <code class="docutils literal notranslate"><span class="pre">config_update</span></code></p></td>
<td><p>All other state</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code></p></td>
<td><p>Clears all enable flags</p></td>
<td><p>TLB config, register values</p></td>
</tr>
</tbody>
</table>
<p><strong>Reset Sequence (Cold Reset):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Assert</span> <span class="n">cold_reset_n</span> <span class="o">=</span> <span class="n">false</span>
<span class="mf">2.</span> <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>  <span class="o">//</span> <span class="n">Allow</span> <span class="n">reset</span> <span class="n">to</span> <span class="n">propagate</span>
<span class="mf">3.</span> <span class="n">All</span> <span class="n">clock</span><span class="o">/</span><span class="n">reset</span> <span class="n">control</span> <span class="n">state</span> <span class="n">cleared</span>
<span class="mf">4.</span> <span class="n">Deassert</span> <span class="n">cold_reset_n</span> <span class="o">=</span> <span class="n">true</span>
<span class="mf">5.</span> <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>  <span class="o">//</span> <span class="n">Allow</span> <span class="n">deassert</span> <span class="n">to</span> <span class="n">propagate</span>
<span class="mf">6.</span> <span class="n">System</span> <span class="n">operational</span> <span class="p">(</span><span class="k">with</span> <span class="n">preserved</span> <span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Isolation vs. Reset:</strong></p>
<ul class="simple">
<li><p><strong>Isolation:</strong> Disables traffic flow, preserves config (but cannot be undone)</p></li>
<li><p><strong>Reset:</strong> Clears control state, preserves config and enables</p></li>
<li><p><strong>Neither:</strong> Clears TLB entries or configuration registers</p></li>
</ul>
</section>
<section id="power-on-initialization">
<h3>8.3 Power-On Initialization<a class="headerlink" href="#power-on-initialization" title="Permalink to this heading"></a></h3>
<p><strong>Constructor Initialization:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">system_ready_</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">pcie_outbound_app_enable_</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">pcie_inbound_app_enable_</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">TLB</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">valid</span> <span class="o">=</span> <span class="n">true</span> <span class="p">(</span><span class="nb">all</span> <span class="n">TLBs</span><span class="p">)</span>
<span class="n">TLB</span> <span class="n">entries</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">63</span><span class="p">]</span><span class="o">.</span><span class="n">valid</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<p><strong>end_of_elaboration():</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">All</span> <span class="n">output</span> <span class="n">signals</span> <span class="n">initialized</span> <span class="n">to</span> <span class="mi">0</span><span class="o">/</span><span class="n">false</span>
<span class="n">pcie_app_bus_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pcie_app_dev_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pcie_device_type</span> <span class="o">=</span> <span class="n">false</span> <span class="p">(</span><span class="n">EP</span> <span class="n">mode</span><span class="p">)</span>
<span class="n">config_update</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="configuration-and-control">
<h2>9. Configuration and Control<a class="headerlink" href="#configuration-and-control" title="Permalink to this heading"></a></h2>
<section id="tile-initialization-sequence">
<h3>9.1 Tile Initialization Sequence<a class="headerlink" href="#tile-initialization-sequence" title="Permalink to this heading"></a></h3>
<p><strong>Recommended Startup Flow:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Step</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Assert</span> <span class="n">cold_reset_n</span>
        <span class="n">cold_reset_n</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">false</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>

<span class="n">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Configure</span> <span class="n">TLB</span> <span class="n">entries</span> <span class="p">(</span><span class="n">via</span> <span class="n">SMN</span><span class="p">)</span>
        <span class="n">For</span> <span class="n">each</span> <span class="n">TLB</span> <span class="n">instance</span><span class="p">:</span>
            <span class="n">Write</span> <span class="n">to</span> <span class="n">SMN</span> <span class="n">address</span> <span class="mh">0x18200000</span><span class="o">-</span><span class="mh">0x18280000</span>
            <span class="o">-</span> <span class="n">Entry</span> <span class="n">valid</span> <span class="n">bit</span>
            <span class="o">-</span> <span class="n">Translated</span> <span class="n">address</span> <span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
            <span class="o">-</span> <span class="n">AxUSER</span> <span class="n">attributes</span>

<span class="n">Step</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Configure</span> <span class="n">MSI</span> <span class="n">Relay</span> <span class="p">(</span><span class="n">via</span> <span class="n">SMN</span><span class="p">)</span>
        <span class="n">Write</span> <span class="n">to</span> <span class="n">SMN</span> <span class="n">address</span> <span class="mh">0x18800000</span><span class="o">-</span><span class="mh">0x188000FF</span>
            <span class="o">-</span> <span class="n">MSI</span><span class="o">-</span><span class="n">X</span> <span class="n">table</span> <span class="n">entries</span> <span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="n">Step</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Configure</span> <span class="n">SII</span> <span class="p">(</span><span class="n">via</span> <span class="n">SMN</span><span class="p">)</span>
        <span class="n">Write</span> <span class="n">to</span> <span class="n">SMN</span> <span class="n">address</span> <span class="mh">0x18101000</span>
            <span class="o">-</span> <span class="n">CORE_CONTROL</span> <span class="p">(</span><span class="n">device</span> <span class="nb">type</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">BUS_DEV_NUM</span> <span class="p">(</span><span class="n">bus</span><span class="o">/</span><span class="n">device</span> <span class="n">numbers</span><span class="p">)</span>

<span class="n">Step</span> <span class="mi">5</span><span class="p">:</span> <span class="n">Deassert</span> <span class="n">cold_reset_n</span>
        <span class="n">cold_reset_n</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>

<span class="n">Step</span> <span class="mi">6</span><span class="p">:</span> <span class="n">Verify</span> <span class="n">system_ready</span>
        <span class="n">Read</span> <span class="n">status</span> <span class="n">register</span> <span class="n">via</span> <span class="n">PCIe</span> <span class="n">at</span> <span class="mh">0xE000000000000000</span>
        <span class="n">Check</span> <span class="n">bit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>

<span class="n">Step</span> <span class="mi">7</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">traffic</span> <span class="n">flow</span>
        <span class="n">Write</span> <span class="n">to</span> <span class="n">Config</span> <span class="n">Reg</span> <span class="n">Block</span> <span class="n">at</span> <span class="mh">0x18000000</span>
            <span class="o">-</span> <span class="n">Set</span> <span class="n">system_ready</span> <span class="o">=</span> <span class="n">true</span>
            <span class="o">-</span> <span class="n">Set</span> <span class="n">pcie_inbound_app_enable</span> <span class="o">=</span> <span class="n">true</span>
            <span class="o">-</span> <span class="n">Set</span> <span class="n">pcie_outbound_app_enable</span> <span class="o">=</span> <span class="n">true</span>

<span class="n">Step</span> <span class="mi">8</span><span class="p">:</span> <span class="n">System</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">traffic</span>
</pre></div>
</div>
<p><strong>Note:</strong> Due to address passthrough limitation, Steps 2-4 may not work as intended. Default configuration (entry 0 valid) allows basic traffic flow.</p>
</section>
<section id="runtime-control">
<h3>9.2 Runtime Control<a class="headerlink" href="#runtime-control" title="Permalink to this heading"></a></h3>
<p><strong>Enable/Disable Traffic:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="mh">0x18000000</span> <span class="p">(</span><span class="n">Config</span> <span class="n">Reg</span> <span class="n">Block</span><span class="p">):</span>
<span class="o">-</span> <span class="n">Offset</span> <span class="mh">0x0000</span><span class="p">:</span> <span class="n">system_ready</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">-</span> <span class="n">Offset</span> <span class="mh">0x0004</span><span class="p">:</span> <span class="n">pcie_outbound_app_enable</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pcie_inbound_app_enable</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Isolation Mode:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="mh">0x18000008</span> <span class="p">(</span><span class="n">Config</span> <span class="n">Reg</span> <span class="n">Block</span><span class="p">):</span>
<span class="o">-</span> <span class="n">Offset</span> <span class="mh">0x0008</span><span class="p">:</span> <span class="n">isolate_req</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Effect</span><span class="p">:</span>
<span class="o">-</span> <span class="n">All</span> <span class="n">enables</span> <span class="n">cleared</span>
<span class="o">-</span> <span class="n">Traffic</span> <span class="n">blocked</span> <span class="n">at</span> <span class="n">NOC</span><span class="o">-</span><span class="n">PCIE</span> <span class="n">switch</span>
<span class="o">-</span> <span class="n">CANNOT</span> <span class="n">BE</span> <span class="n">UNDONE</span> <span class="p">(</span><span class="n">no</span> <span class="n">recovery</span> <span class="n">mechanism</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>TLB Reconfiguration:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="n">TLB</span> <span class="n">config</span> <span class="n">address</span> <span class="p">(</span><span class="mh">0x18200000</span><span class="o">-</span><span class="mh">0x18280000</span><span class="p">):</span>
<span class="o">-</span> <span class="n">Entry</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">entry_index</span> <span class="o">*</span> <span class="mi">16</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>     <span class="n">valid</span> <span class="n">bit</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>   <span class="n">translated</span> <span class="n">address</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">95</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>   <span class="n">AxUSER</span> <span class="n">attributes</span>
</pre></div>
</div>
<p><strong>MSI-X Configuration:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Write</span> <span class="n">to</span> <span class="n">MSI</span><span class="o">-</span><span class="n">X</span> <span class="n">table</span> <span class="p">(</span><span class="mh">0x18800000</span><span class="o">-</span><span class="mh">0x188000FF</span><span class="p">):</span>
<span class="o">-</span> <span class="n">Entry</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">vector</span> <span class="o">*</span> <span class="mi">16</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">63</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>    <span class="n">Message</span> <span class="n">Address</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">95</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>   <span class="n">Message</span> <span class="n">Data</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">96</span><span class="p">]</span>      <span class="n">Per</span><span class="o">-</span><span class="n">Vector</span> <span class="n">Mask</span> <span class="p">(</span><span class="mi">0</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="mi">1</span><span class="o">=</span><span class="n">masked</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>CII Interrupt Clear:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Method</span> <span class="mi">1</span> <span class="p">(</span><span class="n">Blocked</span> <span class="n">by</span> <span class="n">passthrough</span><span class="p">):</span>
    <span class="n">Write</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">clear</span> <span class="n">to</span> <span class="mh">0x18101004</span> <span class="p">(</span><span class="n">SII</span> <span class="n">CFG_MODIFIED</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">Each</span> <span class="n">bit</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">1</span> <span class="n">clears</span> <span class="n">corresponding</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">cfg_modified</span>

<span class="n">Method</span> <span class="mi">2</span> <span class="p">(</span><span class="n">Functional</span><span class="p">):</span>
    <span class="n">Pulse</span> <span class="n">pcie_controller_reset_n</span><span class="p">:</span>
        <span class="n">pcie_controller_reset_n</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">false</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>
        <span class="n">pcie_controller_reset_n</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
        <span class="n">wait</span><span class="p">(</span><span class="n">SC_ZERO_TIME</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">Clears</span> <span class="nb">all</span> <span class="n">cfg_modified</span> <span class="n">bits</span>
    <span class="o">-</span> <span class="n">Deasserts</span> <span class="n">config_update</span>
</pre></div>
</div>
</section>
<section id="status-monitoring">
<h3>9.3 Status Monitoring<a class="headerlink" href="#status-monitoring" title="Permalink to this heading"></a></h3>
<p><strong>System Status Register (Route 0xE/0xF, Read-Only):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="kn">from</span> <span class="nn">PCIe</span><span class="p">:</span> <span class="mh">0xE000000000000000</span> <span class="ow">or</span> <span class="mh">0xF000000000000000</span>

<span class="n">Response</span> <span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">bit</span><span class="p">):</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="n">system_ready</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="n">pcie_outbound_app_enable</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">]</span>    <span class="n">pcie_inbound_app_enable</span>
    <span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="n">Reserved</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>MSI Relay Status:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">PBA</span> <span class="p">(</span><span class="n">Pending</span> <span class="n">Bit</span> <span class="n">Array</span><span class="p">):</span>
    <span class="n">SMN</span> <span class="n">read</span> <span class="kn">from</span> <span class="mh">0x18800100</span><span class="o">-</span><span class="mh">0x18800103</span>
    <span class="o">-</span> <span class="mi">16</span> <span class="n">bits</span><span class="p">,</span> <span class="n">one</span> <span class="n">per</span> <span class="n">MSI</span><span class="o">-</span><span class="n">X</span> <span class="n">vector</span>
    <span class="o">-</span> <span class="n">Bit</span> <span class="nb">set</span> <span class="o">=</span> <span class="n">MSI</span> <span class="n">pending</span> <span class="k">for</span> <span class="n">that</span> <span class="n">vector</span>
    <span class="o">-</span> <span class="n">Note</span><span class="p">:</span> <span class="n">May</span> <span class="n">always</span> <span class="n">read</span> <span class="mi">0</span> <span class="n">due</span> <span class="n">to</span> <span class="n">address</span> <span class="n">passthrough</span>

<span class="n">Read</span> <span class="n">Outstanding</span> <span class="n">Counter</span><span class="p">:</span>
    <span class="n">Internal</span> <span class="n">counter</span><span class="p">,</span> <span class="ow">not</span> <span class="n">externally</span> <span class="n">accessible</span>
</pre></div>
</div>
<p><strong>SII Status:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Read</span> <span class="n">CFG_MODIFIED</span><span class="p">:</span>
    <span class="n">SMN</span> <span class="n">read</span> <span class="kn">from</span> <span class="mh">0x18101004</span>
    <span class="o">-</span> <span class="mi">32</span> <span class="n">bits</span><span class="p">,</span> <span class="n">one</span> <span class="n">per</span> <span class="mi">4</span><span class="o">-</span><span class="n">byte</span> <span class="n">register</span> <span class="ow">in</span> <span class="n">first</span> <span class="mi">128</span><span class="n">B</span> <span class="n">of</span> <span class="n">config</span> <span class="n">space</span>
    <span class="o">-</span> <span class="n">Bit</span> <span class="nb">set</span> <span class="o">=</span> <span class="n">config</span> <span class="n">register</span> <span class="n">modified</span> <span class="n">since</span> <span class="n">last</span> <span class="n">clear</span>

<span class="n">Read</span> <span class="n">Device</span> <span class="n">Type</span><span class="p">:</span>
    <span class="n">SMN</span> <span class="n">read</span> <span class="kn">from</span> <span class="mh">0x18101000</span> <span class="n">bits</span> <span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
    <span class="o">-</span> <span class="mh">0x4</span> <span class="o">=</span> <span class="n">Root</span> <span class="n">Port</span>
    <span class="o">-</span> <span class="n">Other</span> <span class="o">=</span> <span class="n">Endpoint</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="references">
<h2>10. References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<section id="related-documents">
<h3>10.1 Related Documents<a class="headerlink" href="#related-documents" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Keraunos PCIe Tile Test Plan:</strong> <code class="docutils literal notranslate"><span class="pre">/localdev/pdroy/keraunos_pcie_workspace/doc/Keraunos_PCIE_Tile_Testplan.md</span></code></p></li>
<li><p><strong>Test Implementation:</strong> <code class="docutils literal notranslate"><span class="pre">/localdev/pdroy/keraunos_pcie_workspace/Keraunos_PCIe_tile/Tests/Unittests/Keranous_pcie_tileTest.cc</span></code></p></li>
<li><p><strong>Test Guide:</strong> <code class="docutils literal notranslate"><span class="pre">/localdev/pdroy/keraunos_pcie_workspace/KERAUNOS_PCIE_TEST_GUIDE.md</span></code></p></li>
</ul>
</section>
<section id="source-code-organization">
<h3>10.2 Source Code Organization<a class="headerlink" href="#source-code-organization" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Keraunos_PCIe_tile/
├── SystemC/
│   ├── include/
│   │   ├── keraunos_pcie_tile.h             (Top-level tile)
│   │   ├── keraunos_pcie_noc_pcie_switch.h  (NOC-PCIE switch)
│   │   ├── keraunos_pcie_noc_io_switch.h    (NOC-IO switch)
│   │   ├── keraunos_pcie_smn_io_switch.h    (SMN-IO switch)
│   │   ├── keraunos_pcie_inbound_tlb.h      (5 inbound TLB classes)
│   │   ├── keraunos_pcie_outbound_tlb.h     (3 outbound TLB classes)
│   │   ├── keraunos_pcie_msi_relay.h        (MSI relay unit)
│   │   ├── keraunos_pcie_sii.h              (SII block)
│   │   ├── keraunos_pcie_config_reg.h       (Config register block)
│   │   ├── keraunos_pcie_clock_reset.h      (Clock/reset control)
│   │   ├── keraunos_pcie_pll_cgm.h          (PLL/CGM)
│   │   └── keraunos_pcie_phy.h              (PCIe PHY model)
│   └── src/
│       └── (corresponding .cpp files)
├── Tests/
│   └── Unittests/
│       ├── Keranous_pcie_tileTest.cc        (81 test cases)
│       └── Keranous_pcie_tileTestHarness.h  (Test harness)
└── doc/
    ├── Keraunos_PCIE_Tile_Testplan.md       (Test plan)
    └── Keraunos_PCIe_Tile_HLD.md            (This document)
</pre></div>
</div>
</section>
<section id="key-design-decisions">
<h3>10.3 Key Design Decisions<a class="headerlink" href="#key-design-decisions" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>C++ Classes vs. SystemC Modules:</strong></p>
<ul class="simple">
<li><p>Internal components are C++ classes, not <code class="docutils literal notranslate"><span class="pre">sc_module</span></code></p></li>
<li><p>Rationale: Simplified wiring, better performance, no FastBuild instrumentation of internals</p></li>
</ul>
</li>
<li><p><strong>Function Callbacks vs. TLM Sockets:</strong></p>
<ul class="simple">
<li><p>Internal communication uses <code class="docutils literal notranslate"><span class="pre">std::function</span></code> callbacks</p></li>
<li><p>Rationale: No socket binding overhead, direct function calls, easier debugging</p></li>
</ul>
</li>
<li><p><strong>Address Handling in Switches:</strong></p>
<ul class="simple">
<li><p>SMN-IO switch correctly strips base address for TLB config callbacks</p></li>
<li><p>MSI Relay and SII callbacks still receive full addresses (known limitation)</p></li>
<li><p>TLB configuration via SMN works correctly for all entries</p></li>
</ul>
</li>
<li><p><strong>Isolation without Recovery:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">isolate_req</span></code> permanently clears enables</p></li>
<li><p>Consequence: De-asserting isolation does not restore traffic</p></li>
<li><p>Workaround: Avoid isolation in test environment, or accept single-use isolation</p></li>
</ul>
</li>
<li><p><strong>CII Tracking as Synchronous Update:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SiiBlock::update()</span></code> combines 3 separate processes into one method</p></li>
<li><p>Called by <code class="docutils literal notranslate"><span class="pre">signal_update_process()</span></code> each delta cycle</p></li>
<li><p>Rationale: Simplified CDC, deterministic behavior in TLM environment</p></li>
</ul>
</li>
<li><p><strong>TLB Entry 0 Default Valid:</strong></p>
<ul class="simple">
<li><p>All TLBs initialize entry 0 as valid</p></li>
<li><p>Rationale: Allows basic traffic flow without configuration</p></li>
<li><p>Consequence: Address translation not accurate without config, but system stable</p></li>
</ul>
</li>
</ol>
</section>
<section id="known-limitations-and-findings">
<h3>10.4 Known Limitations and Findings<a class="headerlink" href="#known-limitations-and-findings" title="Permalink to this heading"></a></h3>
<p><strong>Documented in Test Plan (Section 1.5 - Known Findings):</strong></p>
<ol class="arabic simple">
<li><p><strong>Address Passthrough:</strong> SMN-IO/NOC-IO switches pass full addresses to callbacks instead of relative offsets → config writes largely non-functional</p></li>
<li><p><strong>TLB Configuration Blocked:</strong> TLB config writes via SMN routed to data paths instead of config callbacks</p></li>
<li><p><strong>MSI Relay Configuration Limited:</strong> MSI-X enable/mask are internal signals, not exposed; config writes blocked by passthrough</p></li>
<li><p><strong>Signal Propagation (RESOLVED):</strong> <code class="docutils literal notranslate"><span class="pre">sc_core::wait(SC_ZERO_TIME)</span></code> required for signal changes to propagate</p></li>
<li><p><strong>Isolation Recovery Impossible:</strong> <code class="docutils literal notranslate"><span class="pre">isolate_req=false</span></code> does not restore enables</p></li>
<li><p><strong>CII Processing (RESOLVED):</strong> Restored via <code class="docutils literal notranslate"><span class="pre">SiiBlock::update()</span></code> method</p></li>
<li><p><strong>MSI PBA Not Verifiable:</strong> PBA bit set requires offset=0, but receives 0x18800000</p></li>
</ol>
<p><strong>Test Coverage:</strong></p>
<ul class="simple">
<li><p><strong>81 test cases</strong> (41 E2E, 40 directed)</p></li>
<li><p><strong>251 assertions</strong> (0 failures)</p></li>
<li><p><strong>100% functional coverage</strong> of testable paths</p></li>
<li><p><strong>Partial coverage</strong> of blocked features (documented as limitations)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="appendix-a-signal-timing-diagrams">
<h2>Appendix A: Signal Timing Diagrams<a class="headerlink" href="#appendix-a-signal-timing-diagrams" title="Permalink to this heading"></a></h2>
<section id="a-1-cii-interrupt-timing">
<h3>A.1 CII Interrupt Timing<a class="headerlink" href="#a-1-cii-interrupt-timing" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pcie_cii_hv         _____/‾‾‾‾‾‾‾\_____
pcie_cii_hdr_type   _____(0x04)_______
pcie_cii_hdr_addr   _____(0x010)______

wait(SC_ZERO_TIME)  ────────►
                    (inputs propagate)

SiiBlock::update()  ────────────────►
                    (CII tracking, cfg_modified[4]=1)

wait(SC_ZERO_TIME)  ────────────────────►
                    (outputs propagate)

config_update       ___________/‾‾‾‾‾‾‾‾‾‾‾‾‾ (asserted)
</pre></div>
</div>
</section>
<section id="a-2-isolation-sequence">
<h3>A.2 Isolation Sequence<a class="headerlink" href="#a-2-isolation-sequence" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>isolate_req         _____/‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾\_____
wait(SC_ZERO_TIME)  ───────►

ConfigRegBlock
  system_ready      ‾‾‾‾‾\_____________________  (cleared)
  inbound_enable    ‾‾‾‾‾\_____________________  (cleared)
  outbound_enable   ‾‾‾‾‾\_____________________  (cleared)

isolate_req         _______________________\_____  (deassert)
wait(SC_ZERO_TIME)  ───────────────────────────►

ConfigRegBlock
  system_ready      ___________________________  (NOT restored)
  inbound_enable    ___________________________  (NOT restored)
  outbound_enable   ___________________________  (NOT restored)
</pre></div>
</div>
</section>
<section id="a-3-cold-reset-cycle">
<h3>A.3 Cold Reset Cycle<a class="headerlink" href="#a-3-cold-reset-cycle" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cold_reset_n        ‾‾‾‾‾\_____/‾‾‾‾‾‾‾‾‾‾‾‾‾
wait(SC_ZERO_TIME)  ───────►      ───────────►

ClockResetControl
  pcie_sii_reset_   ‾‾‾‾‾\_____/‾‾‾‾‾‾‾‾‾‾‾‾‾
  pcie_reset_ctrl_  ‾‾‾‾‾\_____/‾‾‾‾‾‾‾‾‾‾‾‾‾

Config Registers    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾  (preserved)
TLB Entries         ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾  (preserved)
system_ready        ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾  (preserved)
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="appendix-b-address-decode-examples">
<h2>Appendix B: Address Decode Examples<a class="headerlink" href="#appendix-b-address-decode-examples" title="Permalink to this heading"></a></h2>
<section id="b-1-inbound-tlb-translation-tlb-sys-in0">
<h3>B.1 Inbound TLB Translation (TLB Sys In0)<a class="headerlink" href="#b-1-inbound-tlb-translation-tlb-sys-in0" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Input Address:  0x4000000000003ABC
Route bits:     0x4 [63:60]           → TLB Sys In0
Index bits:     0b000000 [19:14]     → Entry 0
Offset bits:    0x3ABC [13:0]        → 14-bit page offset

Entry 0 Lookup:
    valid = true
    addr  = 0x000000FEED00000  (52 bits, [63:12])

Translation:
    translated_addr = (0x000000FEED00000 &lt;&lt; 12) | 0x3ABC
                    = 0x000000FEED003ABC
</pre></div>
</div>
</section>
<section id="b-2-status-register-access">
<h3>B.2 Status Register Access<a class="headerlink" href="#b-2-status-register-access" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Input Address:  0xE000000000000000
Route bits:     0xE [63:60]

Route check:
    is_status_register_access(0xE000000000000000, is_read=true)
    → route_bits == 0xE &amp;&amp; is_read &amp;&amp; system_ready_ → TRUE

Action:
    Return 32-bit status value:
        status[0] = system_ready (1)
        status[1] = pcie_outbound_app_enable (1)
        status[2] = pcie_inbound_app_enable (1)
        status[31:3] = 0

    Response = 0x00000007
</pre></div>
</div>
</section>
<section id="b-3-smn-config-write-address-passthrough-issue">
<h3>B.3 SMN Config Write (Address Passthrough Issue)<a class="headerlink" href="#b-3-smn-config-write-address-passthrough-issue" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Input Address:  0x18800000 (MSI Relay Config base)
Expected:       Offset 0x0000 (relative to base)
Actual:         Offset 0x18800000 (full address passed)

SMN-IO Switch:
    Detects addr == 0x18800000
    Routes to msi_relay_-&gt;process_csr_access(trans, delay)

MSI Relay:
    Receives trans.get_address() = 0x18800000
    Expects offset &lt; 4096 (4KB config space)
    Check: 0x18800000 &gt;= 4096 → FAIL
    Result: TLM_ADDRESS_ERROR_RESPONSE

Consequence: Config write rejected
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="appendix-c-test-coverage-summary">
<h2>Appendix C: Test Coverage Summary<a class="headerlink" href="#appendix-c-test-coverage-summary" title="Permalink to this heading"></a></h2>
<p><strong>Test Suite:</strong> 81 test cases (41 E2E + 40 directed), cross-socket data verification enabled</p>
<p><strong>E2E Tests (41):</strong></p>
<ul class="simple">
<li><p>Inbound TLB paths (10 tests)</p></li>
<li><p>Outbound TLB paths (9 tests)</p></li>
<li><p>Bypass paths (2 tests)</p></li>
<li><p>MSI relay (8 tests)</p></li>
<li><p>SII tracking (4 tests)</p></li>
<li><p>Switch routing (4 tests)</p></li>
<li><p>Power/isolation (2 tests)</p></li>
<li><p>Integration (2 tests)</p></li>
</ul>
<p><strong>Directed Tests (35):</strong></p>
<ul class="simple">
<li><p>TLB unit tests (8 tests)</p></li>
<li><p>MSI relay unit tests (5 tests)</p></li>
<li><p>Switch routing unit tests (7 tests)</p></li>
<li><p>Config register unit tests (3 tests)</p></li>
<li><p>SII unit tests (6 tests)</p></li>
<li><p>Signal propagation tests (3 tests)</p></li>
<li><p>Reset sequence tests (2 tests)</p></li>
<li><p>Integration stress test (1 test)</p></li>
</ul>
<p><strong>Coverage Metrics:</strong></p>
<ul class="simple">
<li><p><strong>Functional Coverage:</strong> 100% of testable features</p></li>
<li><p><strong>Route Coverage:</strong> All 16 route values exercised (0x0-0xF)</p></li>
<li><p><strong>TLB Boundary Coverage:</strong> Entry 0, 1, 63 tested</p></li>
<li><p><strong>Error Path Coverage:</strong> DECERR, isolation blocking, invalid TLB entries</p></li>
<li><p><strong>Signal Coverage:</strong> All input/output signals exercised except 3 (covered by new tests)</p></li>
</ul>
<hr class="docutils" />
<p><strong>Document Control:</strong></p>
<ul class="simple">
<li><p><strong>Version:</strong> 2.0</p></li>
<li><p><strong>Date:</strong> February 10, 2026</p></li>
<li><p><strong>Status:</strong> Updated - Reflects DUT initiator socket architecture and cross-socket verification</p></li>
<li><p><strong>Next Review:</strong> Upon DUT architecture changes or test plan updates</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Keraunos_System_Architecture.html" class="btn btn-neutral float-left" title="Keraunos System Architecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Keraunos_PCIE_Tile_SystemC_Design_Document.html" class="btn btn-neutral float-right" title="Keraunos PCIE Tile SystemC/TLM2.0 Design Document" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, SystemC Modeling Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>